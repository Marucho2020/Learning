<html><head><title>Lession 46  Marshalling & Unmarshalling  (marshal : sáº¯p xáº¿p thÃ nh hÃ ng ) //</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px; white-space: pre-wrap; transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 3em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 2em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lession 46  Marshalling & Unmarshalling  (marshal : sáº¯p xáº¿p thÃ nh hÃ ng ) //</h1><pre>
# KhÃ¡i niá»‡m  	
	Marshalling vÃ  Unmarshalling lÃ  hai quÃ¡ trÃ¬nh quan trá»ng trong Java RMI, giÃºp truyá»n Ä‘á»‘i tÆ°á»£ng tá»« Client Ä‘áº¿n server vÃ  ngÆ°á»£c láº¡i 
		Marshalling : Chuyá»ƒn Ä‘á»•i Object thÃ nh byte-stream Ä‘á»ƒ gá»­i qua máº¡ng. 
		Unmarshalling : Chuyá»ƒn Ä‘á»•i byte-stream thÃ nh Object trÃªn mÃ¡y nháº­n . 
		
# ğŸ“Œ CÃ¡c Java RMI sá»­ dá»¥ng Marshalling vÃ  Unmarshalling  
	
	## Java RMI sá»­ dá»¥ng Stub (Client Proxy) & Skeleton (Server Proxy) Ä‘á»ƒ thá»±c hiá»‡n Marshalling & Unmarshalling: 
		Stub (Client Proxy): ÄÃ³ng vai trÃ² nhÆ° má»™t proxy trÃªn Client, giÃºp gá»­i dá»¯ liá»‡u Ä‘áº¿n Server.
		
		Skeleton (Server Proxy): TrÃªn Server, nháº­n dá»¯ liá»‡u, giáº£i mÃ£ vÃ  gá»i phÆ°Æ¡ng thá»©c thá»±c táº¿. (Java 5 trá»Ÿ Ä‘i khÃ´ng cÃ²n Skeleton, thay vÃ o Ä‘Ã³ dÃ¹ng RemoteObject trá»±c tiáº¿p).
	
	
	## CÃ¡c thÃ nh pháº§n quan trá»ng 
		ThÃ nh pháº§n									Vai trÃ²
		ObjectOutputStream					Marshalling (Chuyá»ƒn Object thÃ nh byte-stream).
		ObjectInputStream					Unmarshalling (Giáº£i byte-stream thÃ nh Object).
		Remote Interface					Äá»‹nh nghÄ©a API tá»« xa.
		Stub								Proxy giÃºp gá»­i yÃªu cáº§u tá»« Client Ä‘áº¿n Server.
		Skeleton (trÆ°á»›c Java 5)				Nháº­n yÃªu cáº§u trÃªn Server.
		RMIRegistry							ÄÄƒng kÃ½ vÃ  tÃ¬m kiáº¿m Object tá»« xa.
	
# 	ğŸ“Œ VÃ­ dá»¥ cÆ¡ báº£n : Marshalling & Unmarshalling trong Java RMI 

	## BÆ°á»›c 1 : Táº¡o Remote Interface
		
		import java.rmi.Remote;
		import java.rmi.RemoteException;
		
		// Remote Interface
		public interface AIService extends Remote {
			String analyzeText(String text) throws RemoteException;
		}

		### ğŸ“Œ Giáº£i thÃ­ch:
			âœ… extends Remote â†’ ÄÃ¡nh dáº¥u Interface lÃ  má»™t dá»‹ch vá»¥ tá»« xa.
			âœ… throws RemoteException â†’ Báº¯t buá»™c Ä‘á»ƒ xá»­ lÃ½ lá»—i máº¡ng.



	
	
	## BÆ°á»›c 2: Implement Remote Object (Server)
	
			import java.rmi.server.UnicastRemoteObject;
			import java.rmi.RemoteException;
			
			public class AIServiceImpl extends UnicastRemoteObject implements AIService {
				protected AIServiceImpl() throws RemoteException {
					super();
				}
			
				@Override
				public String analyzeText(String text) {
					return "AI Analysis Result for: " + text.toUpperCase();
				}
			}
	
		
	
			### ğŸ“Œ Marshalling & Unmarshalling xáº£y ra á»Ÿ Ä‘Ã¢y:
			âœ… Khi Client gá»i analyzeText(), dá»¯ liá»‡u Ä‘Æ°á»£c marshal thÃ nh byte-stream.
			âœ… TrÃªn Server, dá»¯ liá»‡u unmarshal vá» Object, xá»­ lÃ½ xong tráº£ káº¿t quáº£ vá».	
	
	
	
	
	## BÆ°á»›c 3 : ÄÄƒng kÃ½ Object vá»›i RMI Registry 
	
				import java.rmi.registry.LocateRegistry;
				import java.rmi.registry.Registry;
				
				public class Server {
					public static void main(String[] args) {
						try {
							AIService service = new AIServiceImpl();
							Registry registry = LocateRegistry.createRegistry(1099);
							registry.rebind("AIService", service);
				
							System.out.println("Server is running...");
						} catch (Exception e) {
							e.printStackTrace();
						}
					}
				}

		### ğŸ“Œ Giáº£i thÃ­ch:
			âœ… LocateRegistry.createRegistry(1099) â†’ Má»Ÿ cá»•ng Ä‘á»ƒ Client káº¿t ná»‘i.
			âœ… registry.rebind("AIService", service) â†’ ÄÄƒng kÃ½ dá»‹ch vá»¥ AIService.


	
	
	## BÆ°á»›c 4: Gá»i Remote Object tá»« Client 
		import java.rmi.registry.LocateRegistry;
		import java.rmi.registry.Registry;
		
		public class Client {
			public static void main(String[] args) {
				try {
					Registry registry = LocateRegistry.getRegistry("localhost", 1099);
					AIService service = (AIService) registry.lookup("AIService");
		
					String result = service.analyzeText("hello world");
					System.out.println("Server Response: " + result);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		}

		### ğŸ“Œ Marshalling & Unmarshalling trong Client:
			âœ… Client gá»­i analyzeText("hello world") â†’ Marshalling thÃ nh byte-stream.
			âœ… Server nháº­n byte-stream, Unmarshalling â†’ Chuyá»ƒn thÃ nh Object vÃ  xá»­ lÃ½.
			âœ… Káº¿t quáº£ Ä‘Æ°á»£c gá»­i vá» Client qua quÃ¡ trÃ¬nh Marshalling/Unmarshalling ngÆ°á»£c láº¡i.
	
	
	
	
	
# 	ğŸ“Œ VÃ­ dá»¥ NÃ¢ng Cao: Truyá»n Object Qua RMI (Custom Object) 

		NgoÃ i kiá»ƒu dá»¯ liá»‡u cÆ¡ báº£n, ta cÃ³ thá»ƒ gá»­i Object tá»± Ä‘á»‹nh nghÄ©a qua RMI.
		!!! Báº¥t ká»³ trÆ°á»ng há»£p nÃ o cÅ©ng tháº¿, khi xá»­ lÃ½ chuyá»ƒn object thÃ nh stream thÃ¬ pháº£i implement Serializable 
		
		
	
		## BÆ°á»›c 1: Äá»‹nh nghÄ©a Object truyá»n qua máº¡ng 
		
				import java.io.Serializable;
			
				public class AIModel implements Serializable {
					private static final long serialVersionUID = 1L;
					private String name;
					private double accuracy;
				
					public AIModel(String name, double accuracy) {
						this.name = name;
						this.accuracy = accuracy;
					}
				
					@Override
					public String toString() {
						return "AIModel{name='" + name + "', accuracy=" + accuracy + "}";
					}
				}
					
	
	
			## ğŸ“Œ LÆ°u Ã½:
				âœ… implements Serializable â†’ Báº¯t buá»™c Ä‘á»ƒ Marshalling/Unmarshalling Object.
				âœ… serialVersionUID â†’ Äáº£m báº£o tÆ°Æ¡ng thÃ­ch giá»¯a cÃ¡c phiÃªn báº£n class.
	
	
	
		## BÆ°á»›c 2: Truyá»n Object qua RMI 
			
		ğŸ“ŒCáº­p nháº­t Remote Interface
	
			public interface AIService extends Remote {
				AIModel getModelInfo() throws RemoteException;
			}

	
		ğŸ“ŒCáº­p nháº­t Server 
		
			public class AIServiceImpl extends UnicastRemoteObject implements AIService {
				protected AIServiceImpl() throws RemoteException {
					super();
				}
			
				@Override
				public AIModel getModelInfo() {
					return new AIModel("GPT-4", 99.5);
				}
			}

	
	
		ğŸ“Œ Client Nháº­n Object 
			public class Client {
				public static void main(String[] args) {
					try {
						Registry registry = LocateRegistry.getRegistry("localhost", 1099);
						AIService service = (AIService) registry.lookup("AIService");
			
						AIModel model = service.getModelInfo();
						System.out.println("Received Model: " + model);
					} catch (Exception e) {
						e.printStackTrace();
					}
				}
			}

		
		
		###ğŸ“Œ QuÃ¡ trÃ¬nh Marshalling & Unmarshalling:
			âœ… Object AIModel Ä‘Æ°á»£c serialize (Marshalling) trÃªn Server.
			âœ… Client nháº­n dá»¯ liá»‡u, Unmarshalling thÃ nh Object AIModel.
				
	
</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';document.body.className = mode; localStorage.setItem('theme', mode);syncTheme();}function applyTheme() {let savedTheme = localStorage.getItem('theme') || 'dark-mode';document.body.className = savedTheme;syncTheme();}function syncTheme() {let preElement = document.querySelector('pre');if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {let contentHeight = document.body.scrollHeight;let windowHeight = window.innerHeight;if (contentHeight > windowHeight * 1.2) {document.getElementById('backBottom').style.display = 'block';} else {document.getElementById('backBottom').style.display = 'none';}}</script></body></html>