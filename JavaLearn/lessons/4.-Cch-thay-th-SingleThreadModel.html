<html><head><title>4. CÃ¡ch thay tháº¿ SingleThreadModel</title></head><body><h1>4. CÃ¡ch thay tháº¿ SingleThreadModel</h1><pre>				
			
	## ğŸ”¹ CÃ¡ch 1: DÃ¹ng synchronized (KhÃ´ng khuyáº¿n khÃ­ch) 
		Äáº·t synchronized vÃ o doGet() hoáº·c doPost(), nhÆ°ng lÃ m giáº£m hiá»‡u suáº¥t.
				@WebServlet("/sync")
				public class SyncServlet extends HttpServlet {
					private int counter = 0;
				
					protected synchronized void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
						counter++;
						resp.getWriter().println("Counter: " + counter);
					}
				}

					âš  NhÆ°á»£c Ä‘iá»ƒm:
		
					Táº¥t cáº£ request pháº£i chá» nhau, giáº£m tá»‘c Ä‘á»™ xá»­ lÃ½.
			
			
			
			
	## 	ğŸ”¹ CÃ¡ch 2: DÃ¹ng ThreadLocal Ä‘á»ƒ táº¡o biáº¿n riÃªng cho tá»«ng request	
	
	
			@WebServlet("/threadlocal")
			public class ThreadLocalServlet extends HttpServlet {
				private ThreadLocal<Integer> counter = ThreadLocal.withInitial(() -> 0);
			
				protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
					counter.set(counter.get() + 1);
					resp.getWriter().println("Counter: " + counter.get());
				}
			}
	
			ğŸš€ Æ¯u Ä‘iá»ƒm:
			KhÃ´ng cáº§n Ä‘á»“ng bá»™ hÃ³a.
			Má»—i request cÃ³ má»™t biáº¿n riÃªng, trÃ¡nh lá»—i race condition.	ğŸš€ Æ¯u Ä‘iá»ƒm:
			
			KhÃ´ng cáº§n Ä‘á»“ng bá»™ hÃ³a.
			Má»—i request cÃ³ má»™t biáº¿n riÃªng, trÃ¡nh lá»—i race condition.
			
			
			
	## 	ğŸ”¹ CÃ¡ch 3: DÃ¹ng Stateless Servlet (CÃ¡ch tá»‘t nháº¥t)
			
			KhÃ´ng dÃ¹ng biáº¿n instance Ä‘á»ƒ trÃ¡nh váº¥n Ä‘á» Ä‘á»“ng bá»™ hÃ³a.
			ğŸ“Œ VÃ­ dá»¥: Servlet Stateless
			
			@WebServlet("/stateless")
			public class StatelessServlet extends HttpServlet {
				protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {
					int counter = Integer.parseInt(req.getParameter("count")); // KhÃ´ng dÃ¹ng biáº¿n instance
					resp.getWriter().println("Counter: " + (counter + 1));
				}
			}

			âœ… Lá»£i Ã­ch:

Servlet khÃ´ng giá»¯ tráº¡ng thÃ¡i, má»i request Ä‘á»™c láº­p vá»›i nhau.
KhÃ´ng lo láº¯ng vá» Ä‘á»“ng bá»™ hÃ³a hay bá»™ nhá»›.
			


//==========Lession 53 == ThreadLocal & Stateless Servlet ==========//

</pre></body></html>