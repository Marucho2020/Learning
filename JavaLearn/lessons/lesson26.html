<html><head><title>Lession 26  Delay Queue //</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px; white-space: pre-wrap; transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 3em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 2em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lession 26  Delay Queue //</h1><pre># Kh√°i ni·ªám  
	DelayQueue l√† m·ªôt BlockingQueue ƒë·∫∑c bi·ªát trong Java, n·ªõi c√°c ph·∫ßn t·ª≠ ch·ªâ c√≥ th·ªÉ ƒë∆∞·ª£c l·∫•y ra sau m·ªôt kho·∫£ng th·ªùi gian tr·ªÖ nh·∫•t ƒë·ªãnh. N√≥ r·∫•t h·ªØu √≠ch cho c√°c t√°c v·ª• c·∫ßn ƒë∆∞·ª£c tr√¨ ho√£n nh∆∞ l·∫≠p l·ªãch c√¥ng vi·ªác, timeout request, ho·∫∑c qu·∫£n l√Ω th·ªùi gian h·∫øt h·∫°n c·ªßa ƒë·ªëi t∆∞·ª£ng 
	
# ƒê·∫∑c ƒëi·ªÉm ch√≠nh 
	- C√°c ph·∫ßn t·ª≠ trong DelayQueue ph·∫£i implements interface Delayed, trong ƒë√≥ ƒë·ªãnh nghƒ©a th·ªùi gian m√† ph·∫ßn t·ª≠ c√≥ th·ªÉ ƒë∆∞·ª£c l·∫•y ra 
	
	- Khi g·ªçi take() ho·∫∑c poll(), ch·ªâ ƒë·ª£i nh·ªØng ph·∫ßn t·ª≠ ƒë√£ h·∫øt th·ªùi gian tr·ªÖ m·ªõi c√≥ th·ªÉ l·∫•y ra kh·ªèi h√†ng ƒë·ª£i 
	- N·∫øu kh√¥ng c√≥ ph·∫ßn t·ª≠ n√†o h·∫øt th·ªùi gian, ph∆∞∆°ng th·ª©c take() s·∫Ω ch·∫∑n(blocking) lu·ªìng g·ªçi n√≥ 
	- DelayQueue kh√¥ng ch·∫•p nh·∫≠n gi√° tr·ªã null 
	- Kh√¥ng gi·ªõi h·∫°n v·ªÅ k√≠ch th∆∞·ªõc(unbounded queue)
	
	
# C√°ch ho·∫°t ƒë·ªông c·ªßa DelayQueue 
	## C·∫•u tr√∫c d·ªØ li·ªáu 
		- DelayQueue s·ª≠ d·ª•ng min-heap(binary heap) ƒë·ªÉ s·∫Øp x·∫øp c√°c ph·∫ßn t·ª≠ theo th·ªùi gian tr·ªÖ c√≤n l·∫°i 
		- Ph·∫ßn t·ª≠ c√≥ th·ªùi gian h·∫øt h·∫°n g·∫ßn nh·∫•t s·∫Ω n·∫±m ·ªü ƒë·∫ßu h√†ng ƒë·ª£i 
		- Khi g·ªçi take(), n·∫øu ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n ch∆∞a h·∫øt th·ªùi gian, lu·ªìng s·∫Ω ch·ªù cho ƒë·∫øn khi ph·∫ßn t·ª≠ ƒë√≥ s·∫µn s√†ng 
		
	## Constructor 
		// T·∫°o m·ªôt DelayQueue r·ªóng 
		DelayQueue() 
		
		// T·∫°o m·ªôt DelayQueue ch·ª©a c√°c ph·∫ßn t·ª≠ t·ª´ m·ªôt Collection c√≥ s·∫µn  
		DelayQueue(Collection<? extends E>)c
		
# C√°ch s·ª≠ d·ª•ng DelayQueue 
	
	## B∆∞·ªõc 1 : t·∫°o m·ªôt l·ªõp tri·ªÉn khai implements l·∫°i interface Delayed 
		- M·ªçi ph·∫ßn t·ª≠ ƒë∆∞·ª£c th√™m v√†o DelayQueue ph·∫£i tri·ªÉn khai giao di·ªán Delayed v√† ghi ƒë√® hai ph∆∞∆°ng th·ª©c 
		
			getDelay(TimeUnit unit) : Tr·∫£ v·ªÅ kho·∫£ng th·ªùi gian c√≤n l·∫°i tr∆∞·ªõc khi ph·∫ßn t·ª≠ n√†y s·∫µn s√†ng 
			
			compareTo(Delayed o) : H√†m ƒë·ªÉ so s√°nh x√°c ƒë·ªãnh th·ª© t·ª± trong queue(th∆∞·ªùng d·ª±a tr√™n th·ªùi gian tr·ªÖ )
			
			
			
	## V√≠ d·ª• t·∫°o m·ªôt DelayedTask 
		
					import java.util.concurrent.Delayed;
					import java.util.concurrent.TimeUnit;
					
					class DelayedTask implements Delayed {
						private final long startTime;
						private final String taskName;
					
						public DelayedTask(String taskName, long delayInSeconds) {
							this.taskName = taskName;
							this.startTime = System.currentTimeMillis() + TimeUnit.SECONDS.toMillis(delayInSeconds);
						}
					
						@Override
						public long getDelay(TimeUnit unit) {
							long remainingTime = startTime - System.currentTimeMillis();
							return unit.convert(remainingTime, TimeUnit.MILLISECONDS);
						}
					
						@Override
						public int compareTo(Delayed o) {
							return Long.compare(this.getDelay(TimeUnit.MILLISECONDS), o.getDelay(TimeUnit.MILLISECONDS));
						}
					
						@Override
						public String toString() {
							return "Task: " + taskName + ", Scheduled in: " + getDelay(TimeUnit.SECONDS) + " seconds";
						}
					}
							



	##	B∆∞·ªõc 2: Th√™m c√°c ph·∫ßn t·ª≠ v√†o DelayQueue v√† x·ª≠ l√Ω ch√∫ng 
		
		
				import java.util.concurrent.DelayQueue;
				public class DelayQueueExample {
					public static void main(String[] args) throws InterruptedException {
						DelayQueue<DelayedTask> queue = new DelayQueue<>();
				
						// Th√™m c√°c c√¥ng vi·ªác v√†o h√†ng ƒë·ª£i v·ªõi th·ªùi gian tr·ªÖ kh√°c nhau
						queue.put(new DelayedTask("Task 1", 5));  // Sau 5 gi√¢y m·ªõi l·∫•y ƒë∆∞·ª£c
						queue.put(new DelayedTask("Task 2", 10)); // Sau 10 gi√¢y m·ªõi l·∫•y ƒë∆∞·ª£c
						queue.put(new DelayedTask("Task 3", 3));  // Sau 3 gi√¢y m·ªõi l·∫•y ƒë∆∞·ª£c
				
						while (!queue.isEmpty()) {
							DelayedTask task = queue.take(); // Ch·ªù ƒë·∫øn khi ph·∫ßn t·ª≠ s·∫µn s√†ng
							System.out.println("Processing: " + task);
						}
					}
				}
	
	
# C√°ch th·ª©c ho·∫°t ƒë·ªông c·ªßa DelayQueue
		
	## C√°ch getDelay(Time unit) ho·∫°t ƒë·ªông : 
		getDelay() s·∫Ω tr·∫£ v·ªÅ s·ªë th·ªùi gian c√≤n l·∫°i tr∆∞·ªõc khi ph·∫ßn t·ª≠ c√≥ th·ªÉ ƒë∆∞·ª£c l·∫•y ra 
		n·∫øu gi√° tr·ªã tr·∫£ v·ªÅ <=0, ph·∫ßn t·ª≠ c√≥ th·ªÉ ƒë∆∞·ª£c l·∫•y ra kh·ªèi h√†ng ƒë·ª£i 
		
	## C√°ch compareTo(Delayed o) ho·∫°t ƒë·ªông: 
		X√°c ƒë·ªãnh th·ª© t·ª± trong DelayQueue, ph·∫ßn t·ª≠ n√†o c√≥ th·ªùi gian tr·ªÖ ng·∫Øn h∆°n s·∫Ω ƒë∆∞·ª£c ∆∞u ti√™n 
		N·∫øu hai ph·∫ßn t·ª≠ c√≥ c√πng th·ªùi gian tr·ªÖ, ch√∫ng s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω theo th·ª© t·ª± ch√®n v√†o 
		
		
	
	
	
# C√°c ph∆∞∆°ng th·ª©c quan tr·ªçng trong DelayQueue 
	
	add(E e)  : Th√™m ph·∫ßn t·ª≠ v√†o Queue 
	put(E e)  : Th√™m ph·∫ßn t·ª≠ v√†o queue(V√¨ DelayQueue )
	poll()    : L·∫•y v√† x√≥a ph·∫ßn t·ª≠ c√≥ th·ªùi gian tr·ªÖ ƒë√£ h·∫øt, n·∫øu kh√¥ng c√≥ th√¨ tr·∫£ v·ªÅ null 
	take()    : L·∫•y v√† x√≥a ph·∫ßn t·ª≠ c√≥ th·ªùi gian tr·ªÖ ƒë√£ h·∫øt, n·∫øu kh√¥ng c√≥ th√¨ ch·∫∑n lu·ªìng cho ƒë·∫øn khi c√≥ ph·∫ßn t·ª≠ h·ª£p l·ªá 
	peek()    : L·∫•y ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n m√† kh√¥ng x√≥a, n·∫øu ch∆∞a h·∫øt th·ªùi gian tr·ªÖ th√¨ tr·∫£ v·ªÅ null 
	size()    : Tr·∫£ v·ªÅ s·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ trong queue 
	
	
# 6. ·ª®ng d·ª•ng th·ª±c t·∫ø c·ªßa DelayQueue
		‚úÖ L·∫≠p l·ªãch th·ª±c thi c√¥ng vi·ªác (Task Scheduler)
		DelayQueue c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ qu·∫£n l√Ω c√¥ng vi·ªác theo th·ªùi gian m√† kh√¥ng c·∫ßn v√≤ng l·∫∑p ki·ªÉm tra li√™n t·ª•c.
		‚úÖ Timeout cho request ho·∫∑c cache
		D√πng trong h·ªá th·ªëng x·ª≠ l√Ω request c√≥ timeout (v√≠ d·ª•: h·ªßy b·ªè request n·∫øu qu√° th·ªùi gian cho ph√©p).
		Qu·∫£n l√Ω cache b·∫±ng c√°ch t·ª± ƒë·ªông x√≥a c√°c entry sau m·ªôt kho·∫£ng th·ªùi gian.
		‚úÖ H·ªá th·ªëng ƒë·∫•u gi√° tr·ª±c tuy·∫øn
		Gi·ªØ th√¥ng tin v·ªÅ th·ªùi gian h·∫øt h·∫°n c·ªßa c√°c phi√™n ƒë·∫•u gi√° v√† t·ª± ƒë·ªông x·ª≠ l√Ω khi h·∫øt th·ªùi gian.	
	
	
# 7. So s√°nh DelayQueue v·ªõi c√°c h√†ng ƒë·ª£i kh√°c


		Queue										ƒê·∫∑c ƒëi·ªÉm ch√≠nh
		ArrayBlockingQueue							H√†ng ƒë·ª£i c√≥ k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh, ch·∫∑n khi ƒë·∫ßy ho·∫∑c r·ªóng.
		LinkedBlockingQueue							H√†ng ƒë·ª£i kh√¥ng gi·ªõi h·∫°n ho·∫∑c c√≥ th·ªÉ gi·ªõi h·∫°n k√≠ch th∆∞·ªõc.
		PriorityBlockingQueue						H√†ng ƒë·ª£i ∆∞u ti√™n, nh∆∞ng kh√¥ng h·ªó tr·ª£ blocking khi l·∫•y ph·∫ßn t·ª≠.
		SynchronousQueue							Kh√¥ng l∆∞u tr·ªØ ph·∫ßn t·ª≠, m·ªói thao t√°c put() ph·∫£i c√≥ take() ngay l·∫≠p t·ª©c.
		DelayQueue									H√†ng ƒë·ª£i tr√¨ ho√£n, ch·ªâ cho ph√©p l·∫•y ph·∫ßn t·ª≠ sau khi h·∫øt th·ªùi gian tr·ªÖ.	
	
	
	
# L∆∞u √Ω khi thi Java Certification
		Hi·ªÉu r√µ Delayed interface v√† c√°ch getDelay(TimeUnit unit) ho·∫°t ƒë·ªông.
		Bi·∫øt s·ª± kh√°c bi·ªát gi·ªØa take(), poll() v√† peek().
		Hi·ªÉu c√°ch DelayQueue s·∫Øp x·∫øp c√°c ph·∫ßn t·ª≠ b·∫±ng min-heap.
		Nh·ªõ r·∫±ng DelayQueue kh√¥ng c√≥ gi·ªõi h·∫°n k√≠ch th∆∞·ªõc v√† kh√¥ng ch·∫•p nh·∫≠n null.	
	
</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';document.body.className = mode; localStorage.setItem('theme', mode);syncTheme();}function applyTheme() {let savedTheme = localStorage.getItem('theme') || 'dark-mode';document.body.className = savedTheme;syncTheme();}function syncTheme() {let preElement = document.querySelector('pre');if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {let contentHeight = document.body.scrollHeight;let windowHeight = window.innerHeight;if (contentHeight > windowHeight * 1.2) {document.getElementById('backBottom').style.display = 'block';} else {document.getElementById('backBottom').style.display = 'none';}}</script></body></html>