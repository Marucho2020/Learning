<html><head><title>Lession 27  SynchronousQueue //</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px; white-space: pre-wrap; transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lession 27  SynchronousQueue //</h1><pre># Kh√°i ni·ªám  
	SynchonousQueue l√† m·ªôt lo·∫°i BlockingQueue ƒë·∫∑c bi·ªát trong Java kh√¥ng c√≥ b·ªô nh·ªõ ƒë·ªám. N√≥ ho·∫°t ƒë·ªông nh∆∞ m·ªôt ƒëi·ªÉm trao ƒë·ªïi(rendezvous point) gi·ªØa m·ªôt lu·ªìng s·∫£n xu·∫•t(producer) v√† m·ªôt lu·ªìng ti√™u th·ª•(consumer)
	
	## ƒê·∫∑c ƒëi·ªÉm ch√≠nh c·ªßa SynchronousQueue 
		- Kh√¥ng l∆∞u tr·ªØ ph·∫ßn t·ª≠- M·ªói l·∫ßn put() c·∫ßn c√≥ take() ngay l·∫≠p t·ª©c ƒë·ªÉ ho√†n th√†nh giao d·ªãch 
		- C·∫ßn c√≥ s·ª± gh√©p c·∫∑p(pairing)  -  m·ªôt lu·ªìng ƒë∆∞a v√†o(put()) ph·∫£i ƒë·ª£i m·ªôt lu·ªìng l·∫•y ra(take()) v√† ng∆∞·ª£c l·∫°i 
		- Ho·∫°t ƒë·ªông theo m√¥ h√¨nh trao ƒë·ªïi tr·ª±c ti·∫øp(hand-off) 
		- C√≥ hai ch·∫ø ƒë·ªô ho·∫°t ƒë·ªông
			+> FIFO (ch·∫ø ƒë·ªô m·∫∑c ƒë·ªãnh) : d√πng m·ªôt h√†ng ƒë·ª£i ƒë·ªÉ ch·ªù gh√©p c·∫∑p 
			+> LIFO (fairness = false) : D√πng m·ªôt stack ƒë·ªÉ ch·ªù gh√©p c·∫∑p 
		- Th∆∞·ªùng ƒë∆∞·ª£c d√πng trong l·∫≠p tr√¨nh ƒëa lu·ªìng ƒë·ªÉ t·ªëi ∆∞u hi·ªáu su·∫•t v√† gi·∫£m ƒë·ªô tr·ªÖ 
		- T·ª©c l√† trung gian ch·ªâ c·∫ßm m·ªôt ph·∫ßn t·ª≠ t·∫°i m·ªôt th·ªùi ƒëi·ªÉm, kh√¥ng c√≥ buffer -> kh√¥ng c√≥ ph·∫ßn t·ª≠ n√†o ƒë∆∞·ª£c l∆∞u tr·ªØ 
	
# Constructor c·ªßa SynchronoursQueue 
		
	## C√≥ hai c√°ch kh·ªüi t·∫°o SynchronoursQueue : 
	
		//T·∫°o m·ªôt SynchonousQueue v·ªõi ch·∫ø ƒë·ªô FIFO(m·∫∑c ƒë·ªãnh)
		SynchonousQueue<E> queue = new SynchronoursQueue<>(); 
		
		// T·∫°o m·ªôt SynchonousQueue v·ªõi t√πy ch·ªçn fairness
		SynchonousQueue<E> queue = new SynchonousQueue<>(true)  	// FIFO(fair)
		SynchonousQueue<E> queue  = new SynchonousQueue<>(false)	// LIFO (unfair)


		- true (Fair Mode - C√¥ng b·∫±ng) : FIFO -  c√°c lu·ªìng ch·ªù theo th·ª© t·ª± ƒë·∫øn tr∆∞·ªõc ph·ª•c v·ª• tr∆∞·ªõc 
		- false (Unfair Mode -  Kh√¥ng c√¥ng b·∫±ng ): LIFO - Lu·ªìng n√†o ƒë·∫øn sau c√≥ th·ªÉ ƒë∆∞·ª£c ph·ª• v·ª• tr∆∞·ªõc 
		
# C√°ch ho·∫°t ƒë·ªông c·ªßa SynchonousQueue 
	
	## C∆° ch·∫ø Hand-off(chuy·ªÉn giao tr·ª±c ti·∫øp)
		- Khi m·ªôt lu·ªìng Producer g·ªçi put(E e), n√≥ s·∫Ω b·ªã ch·∫∑n cho ƒë·∫øn khi m·ªôt lu·ªìng Consumer g·ªçi take() 
		- Khi m·ªôt lu·ªìng Consumer g·ªçi take() , n√≥ s·∫Ω b·ªã ch·∫∑n cho ƒë·∫øn khi c√≥ m·ªôt ph·∫ßn t·ª≠ ƒë∆∞·ª£c put(). 
		
	## V√≠ d·ª• tr·ª±c quan 
		Th·ªùi ƒëi·ªÉm			Lu·ªìng				H√†nh ƒë·ªông				Tr·∫°ng th√°i Queue
		T0					Producer			put("A")				Ch·ªù Consumer
		T1					Consumer			take()					Gh√©p c·∫∑p ho√†n t·∫•t ‚úÖ
		T2					Producer			put("B")				Ch·ªù Consumer
		T3					Consumer			take()					Gh√©p c·∫∑p ho√†n t·∫•t ‚úÖ



# C√°c ph∆∞∆°ng th·ª©c quan tr·ªçng c·ªßa SynchronousQueue 
	
	Ph∆∞∆°ng th·ª©c											M√¥ t·∫£																						Ch·∫∑n kh√¥ng?
	put(E e)											Th√™m ph·∫ßn t·ª≠ v√†o queue, ch·ªù ƒë·∫øn khi c√≥ consumer l·∫•y ra										‚úÖ C√≥
	offer(E e)											Th√™m ph·∫ßn t·ª≠ v√†o queue, tr·∫£ v·ªÅ false n·∫øu kh√¥ng c√≥ consumer s·∫µn s√†ng							‚ùå Kh√¥ng
	offer(E e, long timeout,TimeUnit unit)				Th√™m ph·∫ßn t·ª≠ v√†o queue trong th·ªùi gian gi·ªõi h·∫°n, tr·∫£ v·ªÅ false n·∫øu timeout					‚è≥ C√≥
	take()												L·∫•y ph·∫ßn t·ª≠ t·ª´ queue, ch·ªù n·∫øu ch∆∞a c√≥ producer ƒë·∫∑t v√†o										‚úÖ C√≥
	poll()												L·∫•y ph·∫ßn t·ª≠ t·ª´ queue, tr·∫£ v·ªÅ null n·∫øu kh√¥ng c√≥ ph·∫ßn t·ª≠ n√†o									‚ùå Kh√¥ng
	poll(long timeout, TimeUnit unit)					L·∫•y ph·∫ßn t·ª≠ t·ª´ queue, ch·ªù trong kho·∫£ng th·ªùi gian timeout tr∆∞·ªõc khi tr·∫£ v·ªÅ null				‚è≥ C√≥
	isEmpty()											Lu√¥n tr·∫£ v·ªÅ true v√¨ queue kh√¥ng c√≥ buffer													‚úÖ ƒê√∫ng
	size()												Lu√¥n tr·∫£ v·ªÅ 0 v√¨ queue kh√¥ng l∆∞u ph·∫ßn t·ª≠													‚úÖ ƒê√∫ng
	


# 5 V√≠ d·ª• s·ª≠ d·ª•ng SynchonousQueue trong ƒëa lu·ªìng 

	# V√≠ d·ª• 1 : Producer-Consumer ƒë∆°n gi·∫£n 
			import java.util.concurrent.SynchronousQueue;
		
			public class SynchronousQueueExample {
				public static void main(String[] args) {
					SynchronousQueue<String> queue = new SynchronousQueue<>();
			
					// Producer Thread
					Thread producer = new Thread(() -> {
						try {
							System.out.println("Producer: ƒêang ƒë·∫∑t ph·∫ßn t·ª≠ v√†o queue...");
							queue.put("Data 1"); // Ch·ªù cho ƒë·∫øn khi consumer l·∫•y d·ªØ li·ªáu
							System.out.println("Producer: ƒê√£ ƒë·∫∑t ph·∫ßn t·ª≠ th√†nh c√¥ng!");
						} catch (InterruptedException e) {
							e.printStackTrace();
						}
					});
			
					// Consumer Thread
					Thread consumer = new Thread(() -> {
						try {
							Thread.sleep(2000); // Gi·∫£ l·∫≠p th·ªùi gian x·ª≠ l√Ω
							System.out.println("Consumer: ƒêang l·∫•y d·ªØ li·ªáu...");
							String data = queue.take();
							System.out.println("Consumer: Nh·∫≠n ƒë∆∞·ª£c " + data);
						} catch (InterruptedException e) {
							e.printStackTrace();
						}
					});
			
					producer.start();
					consumer.start();
				}
			}
			
			K·∫øt qu·∫£ (c√≥ ƒë·ªô tr·ªÖ 2 gi√¢y tr∆∞·ªõc khi producer ti·∫øp t·ª•c):
			
			Producer: ƒêang ƒë·∫∑t ph·∫ßn t·ª≠ v√†o queue...
			(ƒê·ª£i 2 gi√¢y...)
			Consumer: ƒêang l·∫•y d·ªØ li·ªáu...
			Consumer: Nh·∫≠n ƒë∆∞·ª£c Data 1
			Producer: ƒê√£ ƒë·∫∑t ph·∫ßn t·ª≠ th√†nh c√¥ng!


# ·ª®ng d·ª•ng  
	
		‚úÖ Giao ti·∫øp gi·ªØa c√°c lu·ªìng m√† kh√¥ng c·∫ßn b·ªô nh·ªõ ƒë·ªám
			M·ªôt thread s·∫£n xu·∫•t d·ªØ li·ªáu, thread kh√°c ti√™u th·ª• ngay l·∫≠p t·ª©c.
			Th√≠ch h·ª£p cho c√°c h·ªá th·ªëng x·ª≠ l√Ω real-time y√™u c·∫ßu kh√¥ng c√≥ ƒë·ªô tr·ªÖ l∆∞u tr·ªØ.
		
		‚úÖ Thread Pool trong Executors.newCachedThreadPool()
			CachedThreadPool trong Java d√πng SynchronousQueue ƒë·ªÉ chuy·ªÉn giao nhi·ªám v·ª• gi·ªØa c√°c worker thread m·ªôt c√°ch hi·ªáu qu·∫£.
			ExecutorService executor = Executors.newCachedThreadPool();
		
		
		‚úÖ H·ªá th·ªëng th√¥ng ƒëi·ªáp kh√¥ng b·ªô nh·ªõ ƒë·ªám (Zero-buffer messaging)
			D√πng trong h·ªá th·ªëng ƒëi·ªÅu ph·ªëi c√¥ng vi·ªác, n∆°i producer ch·ªâ g·ª≠i c√¥ng vi·ªác khi c√≥ worker s·∫µn s√†ng.
			
		‚úÖ Pipeline x·ª≠ l√Ω d·ªØ li·ªáu t·ª©c th√¨
			D√πng ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu gi·ªØa c√°c b∆∞·ªõc x·ª≠ l√Ω m√† kh√¥ng l∆∞u tr·ªØ trung gian.
	
	
# So s√°nh SynchronoursQueue v·ªõi c√°c Blocking Queue 
		Queue							ƒê·∫∑c ƒëi·ªÉm
		ArrayBlockingQueue				C√≥ k√≠ch th∆∞·ªõc c·ªë ƒë·ªãnh, ch·∫∑n khi ƒë·∫ßy ho·∫∑c r·ªóng
		LinkedBlockingQueue				H√†ng ƒë·ª£i kh√¥ng gi·ªõi h·∫°n ho·∫∑c c√≥ th·ªÉ gi·ªõi h·∫°n k√≠ch th∆∞·ªõc
		PriorityBlockingQueue			H√†ng ƒë·ª£i ∆∞u ti√™n, kh√¥ng h·ªó tr·ª£ blocking khi l·∫•y ph·∫ßn t·ª≠
		SynchronousQueue				Kh√¥ng l∆∞u tr·ªØ ph·∫ßn t·ª≠, c·∫ßn put() v√† take() ƒë·ªìng th·ªùi
		DelayQueue						Ch·ªâ cho ph√©p l·∫•y ph·∫ßn t·ª≠ sau khi h·∫øt th·ªùi gian tr·ªÖ


# C√°c L∆∞u √Ω khi thi Java Certification

		Kh√¥ng c√≥ buffer ‚Üí size() lu√¥n l√† 0, isEmpty() lu√¥n true
		put() v√† take() ch·∫∑n lu·ªìng ‚Üí c·∫ßn thread kh√°c x·ª≠ l√Ω song song
		offer() v√† poll() kh√¥ng ch·∫∑n ‚Üí Tr·∫£ v·ªÅ false ho·∫∑c null ngay n·∫øu kh√¥ng c√≥ ph·∫ßn t·ª≠
		D√πng trong Executors.newCachedThreadPool()
		üöÄ T√≥m l·∫°i: SynchronousQueue c·ª±c k·ª≥ quan tr·ªçng trong l·∫≠p tr√¨nh ƒëa lu·ªìng! N·∫øu b·∫°n mu·ªën hi·ªÉu s√¢u v·ªÅ h·ªá th·ªëng x·ª≠ l√Ω concurrency, h√£y th·ª±c h√†nh nhi·ªÅu b√†i t·∫≠p v·ªõi n√≥! üî•


</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';document.body.className = mode; localStorage.setItem('theme', mode);syncTheme();}function applyTheme() {let savedTheme = localStorage.getItem('theme') || 'dark-mode';document.body.className = savedTheme;syncTheme();}function syncTheme() {let preElement = document.querySelector('pre');if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {let contentHeight = document.body.scrollHeight;let windowHeight = window.innerHeight;if (contentHeight > windowHeight * 1.2) {document.getElementById('backBottom').style.display = 'block';} else {document.getElementById('backBottom').style.display = 'none';}}</script></body></html>