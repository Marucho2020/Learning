<html><head><title>Lesson 11 == Thuáº­t toÃ¡n Random Forest ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../AI-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 11 -- Thuáº­t toÃ¡n Random Forest -//</h1><pre>
# Giá»›i thiá»‡u 
	Random Forest lÃ  má»™t thuáº­t toÃ¡n há»c mÃ¡y thuá»™c nhÃ³m há»c cÃ³ giÃ¡m sÃ¡t(supervised learning ) vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n trong cÃ¡c bÃ i toÃ¡n phÃ¢n loáº¡i (classification) vÃ  há»“i quy(regression). Thuáº­t toÃ¡n nÃ y lÃ  má»™t dáº¡ng cá»§a táº­p há»£p há»c(enmsemble learning), nÆ¡i mÃ  nhiá»u mÃ´ hÃ¬nh yáº¿u (weak learners), cá»¥ thá»ƒ lÃ  cÃ¡c cÃ¢y quyáº¿t Ä‘á»‹nh(decision trees), Ä‘Æ°á»£c káº¿t há»£p láº¡i Ä‘á»ƒ táº¡o thÃ nh má»™t mÃ´ hÃ¬nh máº¡nh máº½ hÆ¡n. 
		https://aicandy.vn/wp-content/uploads/2024/09/aicandy_randomforest_1.png
		
	## Táº¡i sao láº¡i lÃ  Random ?
		Thuáº­t ngá»¯ Random trong Random Forest xuáº¥t phÃ¡t tá»« hai yáº¿u tá»‘ chÃ­nh : 
		
		### 1. Ngáº«u nhiÃªn trong chá»n máº«u 
			Thay vÃ¬ sá»­ dá»¥ng toÃ n bá»™ dá»¯ liá»‡u huáº¥n luyá»‡n Ä‘á»ƒ xÃ¢y dá»±ng tá»«ng cÃ¢y quyáº¿t Ä‘á»‹nh, thuáº­t toÃ¡n Random Forest chá»n má»™t máº«u ngáº«u nhiÃªn tá»« táº­p dá»¯ liá»‡u(vá»›i hoÃ n láº¡i) Ä‘á»ƒ xÃ¢y dá»±ng má»—i cÃ¢y. Ká»¹ thuáº­t nÃ y Ä‘Æ°á»£c gá»i lÃ  Bagging (Bootstrap Aggregating). Bagging giÃºp giáº£m thiá»ƒu phÆ°Æ¡ng sai cá»§a mÃ´ hÃ¬nh, cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c tá»•ng thá»ƒ.
			
		### 2. Ngáº«u nhiÃªn trong chá»n Ä‘áº·c trÆ°ng 
			Khi táº¡o cÃ¡c nÃºt trong má»—i cÃ¢y, chá»‰ má»™t táº­p con ngáº«u nhiÃªn cá»§a táº¥t cáº£ cÃ¡c Ä‘áº·c trÆ°ng Ä‘Æ°á»£c xem xÃ©t Ä‘á»ƒ chá»n Ä‘áº·c trÆ°ng tá»‘t nháº¥t táº¡i má»—i bÆ°á»›c. Äiá»u nÃ y giÃºp cÃ¢y quyáº¿t Ä‘á»‹nh Ä‘a dáº¡ng hÆ¡n, giáº£m thiá»ƒu hiá»‡n tÆ°á»£ng overfitting vÃ  Ä‘áº£m báº£o ráº±ng cÃ¡c cÃ¢y khÃ´ng phá»¥ thuá»™c quÃ¡ má»©c vÃ o má»™t Ä‘áº·c trÆ°ng cá»¥ thá»ƒ nÃ o Ä‘Ã³. 
			
# CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng 

	## Giá»›i thiá»‡u 
		Random Forest bao gá»“m nhiá»u cÃ¢y quyáº¿t Ä‘á»‹nh (Decision Trees). Má»—i cÃ¢y quyáº¿t Ä‘á»‹nh lÃ  má»™t mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n Ä‘á»™c láº­p vÃ  Ä‘Æ°a ra má»™t dá»± Ä‘oÃ¡n. Äá»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i, Random Forest sáº½ láº¥y káº¿t quáº£ dá»± Ä‘oÃ¡n cá»§a tá»«ng cÃ¢y vÃ  chá»n káº¿t quáº£ nÃ o xuáº¥t hiá»‡n nhiá»u nháº¥t(majority vote). Äá»‘i vá»›i bÃ i toÃ¡n há»“i quy, káº¿t quáº£ cuá»‘i cÃ¹ng lÃ  giÃ¡ trá»‹ trung bÃ¬nh cá»§a cÃ¡c dá»± Ä‘oÃ¡n tá»« táº¥t cáº£ cÃ¡c cÃ¢y. 
		
		VÃ­ dá»¥, giáº£ sá»­ chÃºng ta cÃ³ 100 cÃ¢y quyáº¿t Ä‘á»‹nh. Äá»‘i vá»›i má»™t máº«u má»›i, náº¿u 60 cÃ¢y dá»± Ä‘oÃ¡n ráº±ng máº«u Ä‘Ã³ thuá»™c lá»›p A< vÃ  40 cÃ¢y dá»± Ä‘oÃ¡n ráº±ng máº«u Ä‘Ã³ thuá»™c lá»›p B, thÃ¬ Random Forest sáº½ dá»± Ä‘oÃ¡n ráº±ng máº«u Ä‘Ã³ thuá»™c lá»›p A(vÃ¬ nÃ³ nháº­n Ä‘Æ°á»£c sá»‘ phiáº¿u cao hÆ¡n)
		
	## CÃ´ng thá»©c tá»•ng quÃ¡t 
		Má»™t cÃ¢y quyáº¿t Ä‘á»‹nh trong Random Forest thá»±c hiá»‡n phÃ¢n loáº¡i hoáº·c há»“i quy báº±ng cÃ¡ch chia nhá» khÃ´ng gian Ä‘áº·c trÆ°ng thÃ nh cÃ¡c vÃ¹ng con. CÃ¡c phÃ¢n vÃ¹ng nÃ y Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh dá»±a trÃªn cÃ¡c Ä‘iá»u kiá»‡n phÃ¢n tÃ¡ch táº¡i má»—i nÃºt trong cÃ¢y. Giáº£ sá»­ cÃ³ má»™t Ä‘áº·c trÆ°ng X vÃ  má»™t ngÆ°á»¡ng phÃ¢n tÃ¡ch t trong viá»‡c phÃ¢n tÃ¡ch táº¡i má»™t nÃºt cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n báº±ng cÃ¡ch chá»n má»™t hÃ m chá»‰ thá»‹ I, trong Ä‘Ã³ 
					I(X \leq t) \text{ vÃ  } I(X > t)
					
		Náº¿u Ä‘áº·c trÆ°ng X táº¡i máº«u Ä‘Ã³ nhá» hÆ¡n hoáº·c báº±ng t, máº«u sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n nhÃ¡nh trÃ¡i. ngÆ°á»£c láº¡i, nÃ³ sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n nhÃ¡nh pháº£i. QuÃ¡ trÃ¬nh nÃ y tiáº¿p tá»¥c cho Ä‘áº¿n khi Ä‘áº¡t Ä‘áº¿n má»™t nÃºt lÃ¡, nÆ¡i giÃ¡ trá»‹ Ä‘áº§u ra cá»§a nÃºt Ä‘Ã³ Ä‘Æ°á»£c sá»­ dá»¥ng lÃ m dá»± Ä‘oÃ¡n. 
					
# HÃ m máº¥t mÃ¡t vÃ  Ä‘á»™ khÃ´ng thuáº§n khiáº¿t 

	QuÃ¡ trÃ¬nh xÃ¢y dá»±ng cÃ¢y quyáº¿t Ä‘á»‹nh trong Random Forest liÃªn quan Ä‘áº¿n viá»‡c tá»‘i Æ°u hÃ³a má»™t hÃ m máº¥t mÃ¡t, thÆ°á»ng lÃ  giáº£m thiá»ƒu Ä‘á»™ khÃ´ng thuáº§n khiáº¿t(impurity) cá»§a cÃ¡c nÃºt. Äá»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i, Ä‘á»™ khÃ´ng thuáº§n khiáº¿t thÆ°á»ng Ä‘Æ°á»£c Ä‘o báº±ng chá»‰ sá»‘ Gini hoáº·c entropy 
	
	## Chá»‰ sá»‘ Gini  
			Chá»‰ sá»‘ Gini lÃ  má»™t cÃ¡ch Ä‘o lÆ°á»ng Ä‘á»™ khÃ´ng thuáº§n khiáº¿t cá»§a má»™t nÃºt. CÃ´ng thá»©c tÃ­nh chá»‰ sá»‘ Gini cho má»™t nÃºt t lÃ  : 
							Gini(t) = 1 â€“ \sum_{i=1}^{C} p_i^2
							
			Trong Ä‘Ã³, p_i lÃ  xÃ¡c suáº¥t cá»§a viá»‡c má»™t máº«u thuá»™c lá»›p i táº¡i nÃºt t, vÃ  C lÃ  tá»•ng sá»‘ lá»›p. Má»™t nÃºt thuáº§n khiáº¿t(tá»©c lÃ  táº¥t cáº£ cÃ¡c máº«u Ä‘á»u thuá»™c má»™t lá»›p) sáº½ cÃ³ chá»‰ sá»‘ Gini báº±ng 0 . 
			
	## Entropy 
		Entropy lÃ  má»™t thÆ°á»›c Ä‘o khÃ¡c vá» Ä‘á»™ khÃ´ng thuáº§n khiáº¿t, vÃ  nÃ³ Ä‘Æ°á»£c sá»­ dá»¥ng trong viá»‡c xÃ¢y dá»±ng cÃ¢y quyáº¿t Ä‘á»‹nh theo phÆ°Æ¡ng phÃ¡p ID3 hoáº·c C4.5 . CÃ´ng thá»©c tÃ­nh entropy táº¡i má»™t nÃºt t lÃ  : 
		
					Entropy(t) = â€“ \sum_{i=1}^{C} p_i \log_2(p_i)
		
		TÆ°Æ¡ng tá»± nhÆ° chá»‰ sá»‘ Gini , entropy Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t khi nÃºt hoÃ n toÃ n thuáº§n khiáº¿t. 
		
		
# Giáº£m Ä‘á»™ khÃ´ng thuáº§n khiáº¿t (Information Gain)

	Khi má»™t Ä‘áº·c trÆ°ng Ä‘Æ°á»£c chá»n Ä‘á»ƒ phÃ¢n tÃ¡ch táº¡i má»™t nÃºt, má»¥c tiÃªu lÃ  lÃ m giáº£m Ä‘á»™ khÃ´ng thuáº§n khiáº¿t cá»§a cÃ¡c nÃºt con so vá»›i nÃºt cha. Sá»± giáº£m nÃ y, Ä‘Æ°á»£c gá»i lÃ  Information Gain(Äá»‘i vá»›i entropy) hoáº·c Gini Gain(Ä‘á»‘i vá»›i chá»‰ sá»‘ Gini ), Ä‘Æ°á»£c tÃ­nh nhÆ° sau : 
				\text{Information Gain} = \text{Impurity}(t) â€“ \sum_{k \in \{left, right\}} \frac{N_k}{N} \text{Impurity}(t_k)
				
	Trong Ä‘Ã³ : 
		- \text{Impurity}(t)   :  lÃ  Ä‘á»™ khÃ´ng thuáº§n khiáº¿t táº¡i nÃºt cha 
		- \text{Impurity}(t_k) :  LÃ  Ä‘á»™ khÃ´ng thuáº§n khiáº¿t táº¡i cÃ¡c nÃºt con sau khi phÃ¢n tÃ¡ch.
		- N lÃ  sá»‘ lÆ°á»£ng ngáº«u nhiÃªn táº¡i nÃºt cha, vÃ  Nk lÃ  sá»‘ lÆ°á»£ng máº«u táº¡i nÃºt con k . 
		
# Bagging vÃ  ngáº«u nhiÃªn hÃ³a 
	Trong Random Forest, hai khÃ­a cáº¡nh quan trá»ng cá»§a tÃ­nh ngáº«u nhiÃªn giÃºp tÄƒng cÆ°á»ng kháº£ nÄƒng tá»•ng quÃ¡t hÃ³a cá»§a mÃ´ hÃ¬nh : 
	
	## Bagging 
		Thuáº­t toÃ¡n Random Forest sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Bagging( Bootstrap Aggregating) Ä‘á»ƒ xÃ¢y dá»±ng má»—i cÃ¢y quyáº¿t Ä‘á»‹nh. Thay vÃ¬ sá»­ dá»¥ng toÃ n bá»™ táº­p dá»¯ liá»‡u huáº¥n luyá»‡n, má»—i cÃ¢y Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn má»™t máº«u ngáº«u nhiÃªn tá»« táº­p dá»¯ liá»‡u, vá»›i viá»‡c láº¥y máº«u cÃ³ hoÃ n láº¡i(tá»©c lÃ  má»™t máº«u cÃ³ thá»ƒ Ä‘Æ°á»£c chá»n nhiá»u láº§n )
			https://aicandy.vn/wp-content/uploads/2024/09/aicandy_random_forest.png
			
	## Ngáº«u nhiÃªn hÃ³a Ä‘áº·c trÆ°ng 
		Táº¡i má»—i bÆ°á»›c chia tÃ¡ch trong cÃ¢y, má»™t táº­p con ngáº«u nhiÃªn cá»§a cÃ¡c Ä‘áº·c trÆ°ng Ä‘Æ°á»£c xem xÃ©t Ä‘á»ƒ tÃ¬m Ä‘áº·c trÆ°ng tá»‘t nháº¥t. Äiá»u nÃ y lÃ m cho má»—i cÃ¢y khÃ¡c biá»‡t hÆ¡n vÃ  giáº£m thiá»ƒu sá»± phá»¥ thuá»™c vÃ o má»™t sá»‘ Ä‘áº·c trÆ°ng cá»¥ thá»ƒ, tá»« Ä‘Ã³ giáº£m nguy cÆ¡ overfitting. 
		
	## CÃ´ng thá»©c Bagging  
		Giáº£ sá»­ cÃ³ B cÃ¢y quyáº¿t Ä‘á»‹nh vÃ  Ä‘Æ°á»£c xÃ¢y dá»±ng tá»« cÃ¡c bá»™ dá»¯ liá»‡u bootstrap khÃ¡c nhau. Dá»± Ä‘oÃ¡n cá»§a Random Forest Ä‘á»‘i vá»›i má»™t máº«u má»›i x lÃ  : 
		
			### Äá»‘i vá»›i bÃ i toÃ¡n phÃ¢n loáº¡i  
					\hat{y} = \text{majority_vote}\left(\hat{y}^{(1)}, \hat{y}^{(2)}, \dots, \hat{y}^{(B)}\right)
					
			### Äá»‘i vá»›i bÃ i toÃ¡n há»“i quy  
					\hat{y} = \frac{1}{B} \sum_{b=1}^{B} \hat{y}^{(b)}
		

			Trong Ä‘Ã³  : 
				\hat{y}^{(b)} : lÃ  dá»± Ä‘oÃ¡n cá»§a cÃ¢y quyáº¿t Ä‘á»‹nh thá»© b cho máº«u x 
				
				B lÃ  tá»•ng sá»‘ cÃ¢y 
				


# ÄÃ¡nh giÃ¡ má»©c Ä‘á»™ quan trá»ng cá»§a Ä‘áº·c trÆ°ng 
	Trong Random Forest, má»©c Ä‘á»™ quan trá»ng cá»§a cÃ¡c Ä‘áº·c trÆ°ng Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ dá»±a trÃªn má»©c giáº£m Ä‘á»™ khÃ´ng thuáº§n khiáº¿t (impurity) mÃ  Ä‘áº·c trÆ°ng Ä‘Ã³ Ä‘Ã³ng gÃ³p khi Ä‘Æ°á»£c chá»n lÃ m Ä‘áº·c trÆ°ng phÃ¢n tÃ¡ch. Äá»‘i vá»›i má»—i cÃ¢y, tá»•ng má»©c giáº£m impurity trÃªn toÃ n bá»™ cÃ¢y Ä‘Æ°á»£c tÃ­nh cho má»—i Ä‘áº·c trÆ°ng, vÃ  sau Ä‘Ã³ Ä‘Æ°á»£c trung bÃ¬nh hÃ³a qua táº¥t cáº£ cÃ¡c cÃ¢y trong rá»«ng.

	Má»™t cÃ¡ch khÃ¡c Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ táº§m quan trá»ng cá»§a Ä‘áº·c trÆ°ng lÃ  sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Permuted Feature Importance, trong Ä‘Ã³ cÃ¡c giÃ¡ trá»‹ cá»§a má»™t Ä‘áº·c trÆ°ng cá»¥ thá»ƒ Ä‘Æ°á»£c xÃ¡o trá»™n ngáº«u nhiÃªn vÃ  má»©c giáº£m trong Ä‘á»™ chÃ­nh xÃ¡c cá»§a mÃ´ hÃ¬nh Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ quan trá»ng cá»§a Ä‘áº·c trÆ°ng Ä‘Ã³.

	TÃ³m láº¡i, má»©c Ä‘á»™ quan trá»ng cá»§a má»™t Ä‘áº·c trÆ°ng 
	cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ­nh báº±ng cÃ´ng thá»©c:
		\text{Feature Importance}(X_j) = \frac{1}{B} \sum_{b=1}^{B} \sum_{t \in \text{nodes}} \Delta I(t)
		
		Trong Ä‘Ã³:
		\Delta I(t) : lÃ  má»©c giáº£m impurity táº¡i nÃºt t khi sá»­ dá»¥ng Ä‘áº·c trÆ°ng X_j
		B0			: lÃ  tá»•ng sá»‘ cÃ¢y trong rá»«ng.
		\text{nodes}:  lÃ  táº­p há»£p cÃ¡c nÃºt trong cÃ¢y b nÆ¡i X_j Ä‘Æ°á»£c sá»­ dá»¥ng.
		
# 	Out-of-Bag Error
	Má»™t Ä‘áº·c Ä‘iá»ƒm ná»•i báº­t cá»§a Random Forest lÃ  kháº£ nÄƒng Æ°á»›c tÃ­nh lá»—i dá»± Ä‘oÃ¡n mÃ  khÃ´ng cáº§n tÃ¡ch riÃªng má»™t táº­p dá»¯ liá»‡u kiá»ƒm tra, thÃ´ng qua khÃ¡i niá»‡m lá»—i Out-of-Bag (OOB). Trong quÃ¡ trÃ¬nh huáº¥n luyá»‡n, khoáº£ng má»™t pháº§n ba máº«u trong má»—i bootstrap khÃ´ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n cÃ¢y vÃ  do Ä‘Ã³, cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° má»™t táº­p kiá»ƒm tra tá»± nhiÃªn.
	
		\text{OOB Error} = \frac{1}{N} \sum_{i=1}^{N} I(\hat{y}_{OOB}(i) \neq y_i)

	Trong Ä‘Ã³: 
		
	\hat{y}_{OOB}(i)	: lÃ  dá»± Ä‘oÃ¡n cá»§a mÃ´ hÃ¬nh cho máº«u i khi máº«u nÃ y lÃ  out-of-bag cho cÃ¢y mÃ  dá»± Ä‘oÃ¡n nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n.
	 y_i				:  lÃ  giÃ¡ trá»‹ thá»±c táº¿ cá»§a máº«u i 
	 N 					: lÃ  tá»•ng sá»‘ máº«u trong táº­p dá»¯ liá»‡u.
	 I(.)				: lÃ  hÃ m chá»‰ thá»‹, nháº­n giÃ¡ trá»‹ 1 náº¿u Ä‘iá»u kiá»‡n trong ngoáº·c Ä‘Æ¡n lÃ  Ä‘Ãºng vÃ  0 náº¿u Ä‘iá»u kiá»‡n lÃ  sai. 
		
		
	VÃ­ dá»¥ sá»­ dá»¥ng python Ä‘á»ƒ tÃ­nh toÃ¡n OOB:
				from sklearn.ensemble import RandomForestClassifier
				from sklearn.datasets import make_classification
				from sklearn.model_selection import train_test_split
				from sklearn.metrics import accuracy_score
				
				# Táº¡o dá»¯ liá»‡u giáº£ láº­p
				X, y = make_classification(n_samples=1000, n_features=20, n_informative=10, n_classes=2, random_state=42)
				X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
				
				# XÃ¢y dá»±ng mÃ´ hÃ¬nh Random Forest vá»›i lá»—i OOB
				model = RandomForestClassifier(n_estimators=100, oob_score=True, random_state=42)
				model.fit(X_train, y_train)
				
				# TÃ­nh toÃ¡n Ä‘á»™ chÃ­nh xÃ¡c OOB
				oob_error = 1 - model.oob_score_
				print(f'OOB Error: {oob_error:.4f}')
				
				
# 	 á»¨ng dá»¥ng 		

	Random Forest Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong nhiá»u lÄ©nh vá»±c khÃ¡c nhau nhá» vÃ o tÃ­nh chÃ­nh xÃ¡c vÃ  kháº£ nÄƒng tá»•ng quÃ¡t hÃ³a tá»‘t. DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ á»©ng dá»¥ng tiÃªu biá»ƒu:

	##  PhÃ¢n loáº¡i vÃ  phÃ¡t hiá»‡n gian láº­n (Fraud Detection) 
		Trong lÄ©nh vá»±c tÃ i chÃ­nh, Random Forest Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¡t hiá»‡n cÃ¡c giao dá»‹ch gian láº­n. VÃ­ dá»¥, cÃ¡c giao dá»‹ch tháº» tÃ­n dá»¥ng cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n loáº¡i dá»±a trÃªn cÃ¡c Ä‘áº·c trÆ°ng nhÆ° sá»‘ tiá»n giao dá»‹ch, táº§n suáº¥t giao dá»‹ch, Ä‘á»‹a Ä‘iá»ƒm giao dá»‹ch, vÃ  lá»‹ch sá»­ giao dá»‹ch trÆ°á»›c Ä‘Ã³. Random Forest cÃ³ kháº£ nÄƒng phÃ¡t hiá»‡n nhá»¯ng giao dá»‹ch báº¥t thÆ°á»ng vÃ  Ä‘Æ°a ra cáº£nh bÃ¡o vá» kháº£ nÄƒng gian láº­n.
				
	## 	Y táº¿ vÃ  chuáº©n Ä‘oÃ¡n bá»‡nh
		Trong y há»c, Random Forest há»— trá»£ chuáº©n Ä‘oÃ¡n bá»‡nh báº±ng cÃ¡ch phÃ¢n loáº¡i cÃ¡c bá»‡nh nhÃ¢n dá»±a trÃªn cÃ¡c triá»‡u chá»©ng vÃ  káº¿t quáº£ xÃ©t nghiá»‡m. VÃ­ dá»¥, Ä‘á»‘i vá»›i bá»‡nh ung thÆ°, Random Forest cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c Ä‘áº·c trÆ°ng nhÆ° kÃ­ch thÆ°á»›c khá»‘i u, máº­t Ä‘á»™ táº¿ bÃ o, vÃ  cÃ¡c yáº¿u tá»‘ di truyá»n Ä‘á»ƒ dá»± Ä‘oÃ¡n liá»‡u má»™t khá»‘i u cÃ³ Ã¡c tÃ­nh hay khÃ´ng.

		VÃ­ dá»¥ khÃ¡c, trong dá»± Ä‘oÃ¡n bá»‡nh tiá»ƒu Ä‘Æ°á»ng, Random Forest cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c chá»‰ sá»‘ nhÆ° má»©c Ä‘Æ°á»ng huyáº¿t lÃºc Ä‘Ã³i, chá»‰ sá»‘ khá»‘i cÆ¡ thá»ƒ (BMI), vÃ  tiá»n sá»­ gia Ä‘Ã¬nh Ä‘á»ƒ dá»± Ä‘oÃ¡n kháº£ nÄƒng máº¯c bá»‡nh.		
				
				
	## 	Dá»± Ä‘oÃ¡n thá»‹ trÆ°á»ng chá»©ng khoÃ¡n 
			
		Random Forest Ä‘Æ°á»£c á»©ng dá»¥ng trong phÃ¢n tÃ­ch vÃ  dá»± Ä‘oÃ¡n xu hÆ°á»›ng thá»‹ trÆ°á»ng chá»©ng khoÃ¡n. Báº±ng cÃ¡ch xá»­ lÃ½ cÃ¡c dá»¯ liá»‡u lá»‹ch sá»­ giÃ¡ cá»• phiáº¿u, thÃ´ng tin kinh táº¿, vÃ  cÃ¡c chá»‰ sá»‘ ká»¹ thuáº­t, Random Forest cÃ³ thá»ƒ dá»± Ä‘oÃ¡n xu hÆ°á»›ng tÄƒng giáº£m cá»§a cá»• phiáº¿u hoáº·c chá»‰ sá»‘ thá»‹ trÆ°á»ng. Äiá»u nÃ y cÃ³ thá»ƒ giÃºp cÃ¡c nhÃ  Ä‘áº§u tÆ° Ä‘Æ°a ra cÃ¡c quyáº¿t Ä‘á»‹nh giao dá»‹ch dá»±a trÃªn cÃ¡c dá»± bÃ¡o Ä‘Ã¡ng tin cáº­y.


	## PhÃ¢n tÃ­ch hÃ¬nh áº£nh vÃ  nháº­n dáº¡ng khuÃ´n máº·t 
		Trong thá»‹ giÃ¡c mÃ¡y tÃ­nh, Random Forest Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n loáº¡i cÃ¡c Ä‘á»‘i tÆ°á»£ng trong hÃ¬nh áº£nh vÃ  nháº­n dáº¡ng khuÃ´n máº·t. Báº±ng cÃ¡ch phÃ¢n tÃ­ch cÃ¡c Ä‘áº·c trÆ°ng nhÆ° mÃ u sáº¯c, káº¿t cáº¥u, vÃ  cÃ¡c Ä‘iá»ƒm ná»•i báº­t, Random Forest cÃ³ thá»ƒ phÃ¢n loáº¡i cÃ¡c Ä‘á»‘i tÆ°á»£ng trong hÃ¬nh áº£nh vá»›i Ä‘á»™ chÃ­nh xÃ¡c cao. Trong nháº­n dáº¡ng khuÃ´n máº·t, thuáº­t toÃ¡n cÃ³ thá»ƒ xÃ¡c Ä‘á»‹nh danh tÃ­nh cá»§a má»™t ngÆ°á»i dá»±a trÃªn cÃ¡c Ä‘áº·c Ä‘iá»ƒm khuÃ´n máº·t, ngay cáº£ trong cÃ¡c Ä‘iá»u kiá»‡n Ã¡nh sÃ¡ng vÃ  gÃ³c Ä‘á»™ khÃ¡c nhau.
		
		
	## Dá»± bÃ¡o thá»i tiáº¿t vÃ  khÃ­ háº­u
		Random Forest cÅ©ng Ä‘Æ°á»£c sá»­ dá»¥ng trong cÃ¡c mÃ´ hÃ¬nh dá»± bÃ¡o thá»i tiáº¿t vÃ  khÃ­ háº­u. Thuáº­t toÃ¡n nÃ y giÃºp dá»± Ä‘oÃ¡n nhiá»‡t Ä‘á»™, lÆ°á»£ng mÆ°a, vÃ  cÃ¡c hiá»‡n tÆ°á»£ng thá»i tiáº¿t khÃ¡c dá»±a trÃªn dá»¯ liá»‡u thu tháº­p tá»« nhiá»u nguá»“n khÃ¡c nhau. Random Forest cÃ³ kháº£ nÄƒng xá»­ lÃ½ tá»‘t dá»¯ liá»‡u khÃ´ng Ä‘á»“ng nháº¥t vÃ  phá»©c táº¡p, cháº³ng háº¡n nhÆ° dá»¯ liá»‡u vá»‡ tinh vÃ  dá»¯ liá»‡u cáº£m biáº¿n tá»« cÃ¡c tráº¡m khÃ­ tÆ°á»£ng.
		
	
# Æ¯u Ä‘iá»ƒm vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a Random Forest 
	
	## Æ¯u Ä‘iá»ƒm
		### Kháº£ nÄƒng xá»­ lÃ½ dá»¯ liá»‡u lá»›n
			Random Forest cÃ³ thá»ƒ xá»­ lÃ½ má»™t lÆ°á»£ng lá»›n dá»¯ liá»‡u vá»›i Ä‘á»™ chÃ­nh xÃ¡c cao, ngay cáº£ khi dá»¯ liá»‡u chá»©a nhiá»u nhiá»…u hoáº·c cÃ³ sá»± phÃ¢n bá»‘ khÃ´ng Ä‘á»“ng Ä‘á»u.
			
		### Giáº£m thiá»ƒu overfitting
			Báº±ng cÃ¡ch káº¿t há»£p nhiá»u cÃ¢y quyáº¿t Ä‘á»‹nh, Random Forest giÃºp giáº£m thiá»ƒu hiá»‡n tÆ°á»£ng overfitting, Ä‘áº·c biá»‡t lÃ  khi cÃ¡c cÃ¢y quyáº¿t Ä‘á»‹nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn cÃ¡c máº«u ngáº«u nhiÃªn khÃ¡c nhau.
			
		### Kháº£ nÄƒng xá»­ lÃ½ dá»¯ liá»‡u máº¥t mÃ¡t
			Thuáº­t toÃ¡n cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng tá»‘t ngay cáº£ khi má»™t pháº§n dá»¯ liá»‡u bá»‹ thiáº¿u, vÃ¬ má»—i cÃ¢y chá»‰ sá»­ dá»¥ng má»™t pháº§n dá»¯ liá»‡u vÃ  cÃ¡c Ä‘áº·c trÆ°ng khÃ¡c nhau.
			
		### Dá»… dÃ ng Ä‘iá»u chá»‰nh vÃ  má»Ÿ rá»™ng
			Sá»‘ lÆ°á»£ng cÃ¢y trong Random Forest cÃ³ thá»ƒ dá»… dÃ ng Ä‘iá»u chá»‰nh Ä‘á»ƒ cÃ¢n báº±ng giá»¯a Ä‘á»™ chÃ­nh xÃ¡c vÃ  hiá»‡u suáº¥t tÃ­nh toÃ¡n. NgoÃ i ra, thuáº­t toÃ¡n nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c má»Ÿ rá»™ng Ä‘á»ƒ xá»­ lÃ½ cÃ¡c bÃ i toÃ¡n phÃ¢n loáº¡i nhiá»u lá»›p hoáº·c há»“i quy Ä‘a Ä‘áº§u ra.
	
	## NhÆ°á»£c Ä‘iá»ƒm 
		### TÃ­nh toÃ¡n phá»©c táº¡p 
			Random Forest yÃªu cáº§u nhiá»u tÃ i nguyÃªn tÃ­nh toÃ¡n hÆ¡n so vá»›i má»™t sá»‘ thuáº­t toÃ¡n khÃ¡c do sá»‘ lÆ°á»£ng cÃ¢y lá»›n vÃ  quÃ¡ trÃ¬nh huáº¥n luyá»‡n phá»©c táº¡p.

		### KhÃ³ tá»‘i Æ°u hÃ³a cÃ¡c siÃªu tham sá»‘ 
			Viá»‡c tÃ¬m kiáº¿m vÃ  tá»‘i Æ°u hÃ³a cÃ¡c siÃªu tham sá»‘ cá»§a Random Forest, cháº³ng háº¡n nhÆ° sá»‘ lÆ°á»£ng cÃ¢y, Ä‘á»™ sÃ¢u tá»‘i Ä‘a cá»§a cÃ¢y, vÃ  sá»‘ lÆ°á»£ng Ä‘áº·c trÆ°ng Ä‘á»ƒ phÃ¢n tÃ¡ch táº¡i má»—i nÃºt, cÃ³ thá»ƒ lÃ  má»™t quÃ¡ trÃ¬nh tá»‘n thá»i gian vÃ  phá»©c táº¡p. Viá»‡c lá»±a chá»n cÃ¡c siÃªu tham sá»‘ tá»‘t nháº¥t thÆ°á»ng yÃªu cáº§u thá»­ nghiá»‡m vÃ  Ä‘iá»u chá»‰nh nhiá»u láº§n.
			
		### KÃ­ch thÆ°á»›c mÃ´ hÃ¬nh lá»›n 
			Khi sá»‘ lÆ°á»£ng cÃ¢y lá»›n, kÃ­ch thÆ°á»›c cá»§a mÃ´ hÃ¬nh Random Forest cÃ³ thá»ƒ trá»Ÿ nÃªn ráº¥t lá»›n, Ä‘Ã²i há»i nhiá»u bá»™ nhá»› Ä‘á»ƒ lÆ°u trá»¯ vÃ  quáº£n lÃ½.
			
# á»¨ng dá»¥ng vá»›i PyTorch 
	DÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ vá» cÃ¡ch xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh Random Forest Ä‘Æ¡n giáº£n Ä‘á»ƒ phÃ¢n loáº¡i dá»¯ liá»‡u sá»­ dá»¥ng PyTorch vÃ  scikit-learn. Máº·c dÃ¹ PyTorch khÃ´ng cÃ³ triá»ƒn khai Random Forest, chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng scikit-learn Ä‘á»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh vÃ  sau Ä‘Ã³ chuyá»ƒn dá»¯ liá»‡u vÃ o PyTorch

	## Táº¡o dá»¯ liá»‡u giáº£ láº­p 
			import torch
			from sklearn.datasets import make_classification
			from sklearn.model_selection import train_test_split
			
			# Táº¡o dá»¯ liá»‡u giáº£ láº­p
			X, y = make_classification(n_samples=1000, n_features=20, n_informative=10, n_classes=2, random_state=42)
			X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
			
			# Chuyá»ƒn Ä‘á»•i sang tensor
			X_train = torch.tensor(X_train, dtype=torch.float32)
			y_train = torch.tensor(y_train, dtype=torch.long)
			X_test = torch.tensor(X_test, dtype=torch.float32)
			y_test = torch.tensor(y_test, dtype=torch.long)
			
		á» bÆ°á»›c nÃ y chÃºng ta táº¡o ra má»™t bá»™ dá»¯ liá»‡u giáº£ láº­p vá»›i 1000 máº«u, má»—i máº«u cÃ³ 20 Ä‘áº·c trÆ°ng, trong Ä‘Ã³ cÃ³ 10 Ä‘áº·c trÆ°ng mang thÃ´ng tin quan trá»ng chon viá»‡c phÃ¢n loáº¡i. Dá»¯ liá»‡u sau Ä‘Ã³ Ä‘Æ°á»£c chia thÃ nh táº­p huáº¥n luyá»‡n vÃ  táº­p kiá»ƒm tra vá»›i tá»· lá»‡ 80-20

	## XÃ¢y dá»±ng mÃ´ hÃ¬nh 
		Random Forest khÃ´ng Ä‘Æ°á»£c tÃ­ch há»£p sáºµn trong PyTorch, nhÆ°ng ta cÃ³ thá»ƒ sá»­ dá»¥ng thÆ° viá»‡n scikit-lean Ä‘á»ƒ xÃ¢y dá»±ng mÃ´ hÃ¬nh vÃ  sau Ä‘Ã³ chuyá»ƒn dá»¯ liá»‡u vÃ o PyTorch Ä‘á»ƒ huáº¥n luyá»‡n  
		
		from sklearn.ensemble import RandomForestClassifier
		from sklearn.metrics import accuracy_score
		
		# XÃ¢y dá»±ng mÃ´ hÃ¬nh Random Forest
		model = RandomForestClassifier(n_estimators=100, random_state=42)
		model.fit(X_train.numpy(), y_train.numpy())
		
		# Dá»± Ä‘oÃ¡n trÃªn táº­p kiá»ƒm tra
		y_pred = model.predict(X_test.numpy())
		
		# ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh
		accuracy = accuracy_score(y_test.numpy(), y_pred)
		print(f'Accuracy: {accuracy:.4f}')
						
		
		Trong vÃ­ dá»¥ nÃ y, chÃºng ta Ä‘Ã£ xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh Random Forest vá»›i 100 cÃ¢y quyáº¿t Ä‘á»‹nh(n_estimators=100). MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n trÃªn táº­p dá»¯ liá»‡u huáº¥n luyá»‡n vÃ  sau Ä‘Ã³ Ä‘Æ°á»£c kiá»ƒm tra trÃªn táº­p dá»¯ liá»‡u kiá»ƒm tra. Cuá»‘i cÃ¹ng , Ä‘á»™ chÃ­nh xÃ¡c cá»§a mÃ´ hÃ¬nh Ä‘Æ°á»£c tÃ­nh toÃ¡n vÃ  in ra káº¿t quáº£. 
		
	## Tinh chá»‰nh mÃ´ hÃ¬nh 
		ChÃºng ta cÃ³ thá»ƒ cáº£i thiá»‡n mÃ´ hÃ¬nh Random Forest báº±ng cÃ¡ch Ä‘iá»u chá»‰nh cÃ¡c tham sá»‘ nhÆ° sá»‘ lÆ°á»£ng cÃ¢y(n_estimators) , Ä‘á»™ sÃ¢u tá»‘i Ä‘a cá»§a má»—i cÃ¢y(max_depth ), vÃ  sá»‘ lÆ°á»£ng Ä‘áº·c trÆ°ng Ä‘Æ°á»£c xem xÃ©t khi chia tÃ¡ch(max_features). VÃ­ dá»¥, ta cÃ³ thá»ƒ thá»­ nghiá»‡m vá»›i cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau cá»§a max_depth Ä‘á»ƒ tÃ¬m ra Ä‘á»™ sÃ¢u tá»‘i Æ°u cho mÃ´ hÃ¬nh . 
		
			# Tinh chá»‰nh mÃ´ hÃ¬nh vá»›i Ä‘á»™ sÃ¢u tá»‘i Ä‘a lÃ  10
			model = RandomForestClassifier(n_estimators=100, max_depth=10, random_state=42)
			model.fit(X_train.numpy(), y_train.numpy())
			
			# ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh
			y_pred = model.predict(X_test.numpy())
			accuracy = accuracy_score(y_test.numpy(), y_pred)
			print(f'Accuracy with max_depth=10: {accuracy:.4f}')
		
		á» Ä‘Ã¢y chÃºng ta Ä‘Ã£ giá»›i háº¡n Ä‘á»™ sÃ¢u cá»§a má»—i cÃ¢y trong rá»«ng á»Ÿ má»©c 10. Äiá»u nÃ y cÃ³ thá»ƒ giÃºp giáº£m thiá»ƒu hiá»‡n tÆ°á»£ng overfitting, Ä‘áº·c biá»‡t lÃ  khi dá»¯ liá»‡u cÃ³ nhiá»…u hoáº·c chá»©a cÃ¡c máº«u khÃ´ng Ä‘áº¡i diá»‡n. 
		
# Káº¿t luáº­n 
			
	Random Forest lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n há»c mÃ¡y máº¡nh máº½ vÃ  linh hoáº¡t, phÃ¹ há»£p vá»›i nhiá»u loáº¡i bÃ i toÃ¡n khÃ¡c nhau tá»« phÃ¢n loáº¡i, há»“i quy Ä‘áº¿n cÃ¡c bÃ i toÃ¡n phá»©c táº¡p hÆ¡n nhÆ° phÃ¡t hiá»‡n gian láº­n hay phÃ¢n tÃ­ch hÃ¬nh áº£nh. Máº·c dÃ¹ cÃ³ má»™t sá»‘ háº¡n cháº¿ vá» tÃ­nh phá»©c táº¡p vÃ  kháº£ nÄƒng giáº£i thÃ­ch, Random Forest váº«n Ä‘Æ°á»£c Æ°a chuá»™ng nhá» vÃ o kháº£ nÄƒng xá»­ lÃ½ dá»¯ liá»‡u lá»›n, giáº£m thiá»ƒu overfitting, vÃ  tÃ­nh dá»… dÃ ng trong viá»‡c tinh chá»‰nh mÃ´ hÃ¬nh 
	
</pre><a id='backBottom' href='../AI-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>