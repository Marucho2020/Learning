<html><head><title>Lesson 21 == React Portals ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../react-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 21 -- React Portals -//</h1><pre>
# 1. React Portals l√† g√¨? 

	React Portals cho ph√©p render n·ªôi dung React v√†o m·ªôt DOM node ngo√†i c√¢y DOM c·ªßa parent component (th∆∞·ªùng l√† document.body). ƒêi·ªÅu n√†y h·ªØu √≠ch cho c√°c UI nh∆∞ modal, tooltip, ho·∫∑c notification, c·∫ßn tho√°t kh·ªèi layout gi·ªõi h·∫°n c·ªßa parent (e.g., overflow: hidden, z-index).

	C√∫ ph√°p:
	import { createPortal } from 'react-dom';
	createPortal(children, domNode);

		children: N·ªôi dung React (element, string, fragment).
		domNode: DOM node ƒë√≠ch (th∆∞·ªùng l√† document.body ho·∫∑c m·ªôt container c·ª• th·ªÉ).




# 2. Ph√¢n t√≠ch v√≠ d·ª•

import { createRoot } from 'react-dom/client';
import { useState } from 'react';
import { createPortal } from 'react-dom';

function Modal({ isOpen, onClose, children }) {
  if (!isOpen) return null;
  return createPortal(
    <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0, 0, 0, 0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
      <div style={{ background: 'white', padding: '20px', borderRadius: '8px' }}>
        {children}
        <button onClick={onClose}>Close</button>
      </div>
    </div>,
    document.body
  );
}

function MyApp() {
  const [isOpen, setIsOpen] = useState(false);
  return (
    <div>
      <h1>My App</h1>
      <button onClick={() => setIsOpen(true)}>Open Modal</button>
      <Modal isOpen={isOpen} onClose={() => setIsOpen(false)}>
        <h2>Modal Content</h2>
        <p>This content is rendered outside the App component!</p>
      </Modal>
    </div>
  );
}

createRoot(document.getElementById('root')).render(<MyApp />);



	## State isOpen: 
		
		- useState(false) qu·∫£n l√Ω tr·∫°ng th√°i hi·ªÉn th·ªã modal.
		- setIsOpen(true/false) ƒëi·ªÅu khi·ªÉn m·ªü/ƒë√≥ng modal.

	## Modal Component: 
		- if (!isOpen) return null: Kh√¥ng render g√¨ n·∫øu modal ƒë√≥ng.
		- createPortal: Render modal v√†o document.body, tr√°nh b·ªã gi·ªõi h·∫°n b·ªüi CSS c·ªßa parent (e.g., overflow: hidden, z-index).
		- Inline styles t·∫°o overlay (n·ªÅn m·ªù) v√† modal (h·ªôp tr·∫Øng) v·ªõi v·ªã tr√≠ c·ªë ƒë·ªãnh, cƒÉn gi·ªØa.		


	## K·∫øt qu·∫£
		Nh·∫•n "Open Modal" hi·ªÉn th·ªã modal ·ªü ch√≠nh gi·ªØa m√†n h√¨nh, tho√°t kh·ªèi DOM hierarchy c·ªßa MyApp. Nh·∫•n "Close" ·∫©n modal.




# V√≠ d·ª• 2: Event Bubbling v·ªõi Portal

import { createRoot } from 'react-dom/client';
import { useState } from 'react';
import { createPortal } from 'react-dom';

function PortalButton({ onClick, children }) {
  return createPortal(
    <button style={{ position: 'fixed', bottom: '20px', right: '20px', padding: '10px', background: 'blue', color: 'white' }}>
      {children}
    </button>,
    document.body
  );
}

function App() {
  const [count1, setCount1] = useState(0);
  const [count2, setCount2] = useState(0);

  return (
    <div style={{ padding: '20px', border: '2px solid black', margin: '20px' }} onClick={() => setCount1(c => c + 1)}>
      <h2>Div Clicked: {count1}</h2>
      <h2>Button Clicked: {count2}</h2>
      <p>The floating button is rendered outside this box using a portal, but its clicks still bubble up to this parent div!</p>
      <PortalButton onClick={(e) => setCount2(c => c + 1)}>Floating Button</PortalButton>
    </div>
  );
}

createRoot(document.getElementById('root')).render(<App />);



	## PortalButton: 
		
		- Render n√∫t c·ªë ƒë·ªãnh ·ªü g√≥c d∆∞·ªõi-ph·∫£i m√†n h√¨nh (document.body) b·∫±ng createPortal.
		- M·∫∑c d√π n·∫±m ngo√†i DOM c·ªßa App, s·ª± ki·ªán onClick v·∫´n ho·∫°t ƒë·ªông trong React tree.

	## Event Bubbling:
		Khi nh·∫•n n√∫t, s·ª± ki·ªán ch·∫°y qua:	
			- onClick c·ªßa PortalButton (tƒÉng count2).
			- onClick c·ªßa parent <div> (tƒÉng count1), v√¨ React qu·∫£n l√Ω s·ª± ki·ªán theo component hierarchy, kh√¥ng ph·∫£i DOM hierarchy.

		ƒê√¢y l√† ƒë·∫∑c t√≠nh quan tr·ªçng: Portals gi·ªØ h√†nh vi React event bubbling d√π DOM t√°ch bi·ªát.

	## K·∫øt qu·∫£
		Nh·∫•n n√∫t tƒÉng c·∫£ count1 (parent div) v√† count2 (button), minh h·ªça bubbling qua React tree.



# 3. T·∫°i sao d√πng Portals?
	Tho√°t kh·ªèi layout parent: Modal, tooltip, notification c·∫ßn v∆∞·ª£t qua gi·ªõi h·∫°n CSS (overflow, z-index, position).
	
	T√°ch bi·ªát DOM: ƒê·∫£m b·∫£o UI kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi c·∫•u tr√∫c DOM c·ªßa parent.
	
	·ª®ng d·ª•ng:
		- Modal: Hi·ªÉn th·ªã h·ªôp tho·∫°i tr√™n to√†n m√†n h√¨nh.
		- Tooltip: Hi·ªÉn th·ªã n·ªôi dung n·ªïi b√™n ngo√†i container.
		- Notification: Hi·ªÉn th·ªã th√¥ng b√°o ·ªü g√≥c m√†n h√¨nh.	



# K·∫øt h·ª£p v·ªõi Forms

function ModalForm({ isOpen, onClose }) {
  const [inputs, setInputs] = useState({ name: '', fruit: 'banana' });
  const handleChange = (e) => setInputs({ ...inputs, [e.target.name]: e.target.value });

  const handleSubmit = (e) => {
    e.preventDefault();
    alert(`Submitted: ${inputs.name}, ${inputs.fruit}`);
    onClose();
  };

  if (!isOpen) return null;
  return createPortal(
    <div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0, 0, 0, 0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center' }}>
      <div style={{ background: 'white', padding: '20px', borderRadius: '8px' }}>
        <form onSubmit={handleSubmit}>
          <input type="text" name="name" value={inputs.name} onChange={handleChange} />
          <input type="radio" name="fruit" value="apple" checked={inputs.fruit === 'apple'} onChange={handleChange} /> Apple
          <input type="radio" name="fruit" value="banana" checked={inputs.fruit === 'banana'} onChange={handleChange} /> Banana
          <button type="submit">Submit</button>
          <button type="button" onClick={onClose}>Close</button>
        </form>
      </div>
    </div>,
    document.body
  );
}


# 5. L∆∞u √Ω k·ªπ thu·∫≠t (chuy√™n s√¢u)

	## DOM Destination: 
		- document.body l√† ph·ªï bi·∫øn, nh∆∞ng c√≥ th·ªÉ d√πng container kh√°c (e.g., document.getElementById('modal-root')) ƒë·ªÉ ki·ªÉm so√°t t·ªët h∆°n.
		- ƒê·∫£m b·∫£o domNode t·ªìn t·∫°i tr∆∞·ªõc khi render (d√πng document.createElement n·∫øu c·∫ßn).

	## Event Bubbling: 
		- Portals gi·ªØ React event system, cho ph√©p s·ª± ki·ªán (click, keypress) bubble qua component tree, kh√¥ng ph·ª• thu·ªôc DOM hierarchy.
		- C·∫©n th·∫≠n v·ªõi stopPropagation n·∫øu kh√¥ng mu·ªën bubbling ƒë·∫øn parent.		

	## Performance: 
		
		- Tr√°nh render portal qu√° nhi·ªÅu l·∫ßn (d√πng useMemo ho·∫∑c ƒëi·ªÅu ki·ªán nh∆∞ if (!isOpen) return null).
		- Modal l·ªõn n√™n t√°ch th√†nh component ri√™ng ƒë·ªÉ t·ªëi ∆∞u re-render.

	## Accessibility: 
		
		- Th√™m aria-modal, role="dialog", v√† focus management (e.g., useEffect ƒë·ªÉ focus v√†o modal khi m·ªü).
		- ƒê·∫£m b·∫£o modal c√≥ th·ªÉ ƒë√≥ng b·∫±ng ph√≠m (e.g., Esc key).


# 6. ·ª®ng d·ª•ng th·ª±c t·∫ø 
	
		- Modal: Form ƒëƒÉng nh·∫≠p/ƒëƒÉng k√Ω, x√°c nh·∫≠n h√†nh ƒë·ªông.
		- Tooltip/Notification: Hi·ªÉn th·ªã n·ªôi dung n·ªïi ·ªü v·ªã tr√≠ c·ªë ƒë·ªãnh.
		- Floating UI: Menu ho·∫∑c button c·ªë ƒë·ªãnh (e.g., "Back to top").
		- K·∫øt h·ª£p v·ªõi API (g·ª≠i form trong modal) v√† transitions ƒë·ªÉ tƒÉng UX.




https://www.w3schools.com/react/react_suspense.asp


</pre><a id='backBottom' href='../react-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>