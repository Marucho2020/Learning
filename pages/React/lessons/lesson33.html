<html><head><title>Lesson 33 == useContext ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../react-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 33 -- useContext -//</h1><pre>
#  Kh√°i ni·ªám 

	Context qu·∫£n l√Ω state to√†n c·ª•c, cho ph√©p component con access state m√† kh√¥ng truy·ªÅn props qua t·ª´ng l·ªõp. Useful khi state shared gi·ªØa nhi·ªÅu branches trong component tree.
	
	Insight chuy√™n gia: Context l√† provider-consumer pattern, kh√¥ng ph·∫£i pub-sub (kh√¥ng notify changes t·ª± ƒë·ªông nh∆∞ observables). State thay ƒë·ªïi ‚Üí Provider re-render ‚Üí t·∫•t c·∫£ consumers re-render (shallow). Optimize b·∫±ng React.memo cho consumers ho·∫∑c split Contexts (v√≠ d·ª•: separate UserContext v√† ThemeContext).
	

	Insight chuy√™n gia: Context l√Ω t∆∞·ªüng cho theming, authentication, ho·∫∑c user data (kh√¥ng thay ƒë·ªïi th∆∞·ªùng xuy√™n), nh∆∞ng kh√¥ng ph·∫£i state management full-featured ‚Äì n·∫øu state update th∆∞·ªùng, c√≥ th·ªÉ g√¢y re-renders th·ª´a (v√¨ Provider re-render lan t·ªèa). Trong React 18+, Context h·ªó tr·ª£ Concurrent Rendering t·ªët h∆°n. Nh∆∞·ª£c ƒëi·ªÉm: Overuse d·∫´n ƒë·∫øn "context hell" (nhi·ªÅu Providers nested); best practice: K·∫øt h·ª£p v·ªõi useReducer cho state complex, ho·∫∑c Zustand/MobX cho global store. Alternative: Prop drilling ·ªïn cho small apps; Context cho medium; Redux/Recoil cho large-scale. Trong SSR (Next.js), Context c·∫ßn hydrate c·∫©n th·∫≠n ƒë·ªÉ tr√°nh mismatch.




# 2. The Problem: Prop Drilling 

	State ·ªü parent cao nh·∫•t, nh∆∞ng n·∫øu component bottom c·∫ßn, ph·∫£i truy·ªÅn qua intermediates (prop drilling) ‚Äì l√†m code verbose, kh√≥ maintain, ƒë·∫∑c bi·ªát deep nesting.

import { useState } from 'react';  // Import useState
import { createRoot } from 'react-dom/client';  // Render root

function Component1() {
  const [user, setUser] = useState("Linus");  // State ·ªü parent

  return (
    <>
      <h1>{`Hello ${user}!`}</h1>
      <Component2 user={user} />  // Truy·ªÅn prop
    </>
  );
}

function Component2({ user }) {  // Intermediate kh√¥ng c·∫ßn user
  return (
    <>
      <h1>Component 2</h1>
      <Component3 user={user} />  // Ti·∫øp t·ª•c truy·ªÅn
    </>
  );
}

function Component3({ user }) {  // Consumer c·∫ßn user
  return (
    <>
      <h1>Component 3</h1>
      <h2>{`Hello ${user} again!`}</h2>  // S·ª≠ d·ª•ng
    </>
  );
}

createRoot(document.getElementById('root')).render(
  <Component1 />
);

	useState("Linus"): State ·ªü Component1.
	user={user}: Truy·ªÅn qua Component2 (kh√¥ng d√πng) ƒë·∫øn Component3.
	V·∫•n ƒë·ªÅ: N·∫øu th√™m layers, props chain d√†i; thay ƒë·ªïi type ‚Üí update t·∫•t c·∫£ intermediates.


	Insight chuy√™n gia: Prop drilling OK cho 2-3 levels, nh∆∞ng >5 levels ‚Üí refactor sang Context. Trong large apps, drilling g√¢y tight coupling; Context loose coupling h∆°n. Debug: S·ª≠ d·ª•ng React DevTools ƒë·ªÉ trace props flow.


# 3. The Solution: Create Context

	T·∫°o Context object v·ªõi createContext(), sau d√πng Provider ƒë·ªÉ wrap tree v√† provide value.
	
	import { useState, createContext, useContext } from 'react';  // Import c·∫ßn thi·∫øt
	import { createRoot } from 'react-dom/client';

	const UserContext = createContext();  // T·∫°o Context (default value optional)
	
	createContext(): Tr·∫£ v·ªÅ object v·ªõi Provider v√† Consumer. Default value (n·∫øu kh√¥ng Provider) c√≥ th·ªÉ truy·ªÅn: createContext(defaultValue).
	T√™n convention: PascalCase + "Context".
	
Insight chuy√™n gia: Default value useful cho testing ho·∫∑c optional Contexts. Trong TypeScript, khai b√°o types: createContext<UserType | undefined>(undefined) ƒë·ªÉ type-safe. Best practice: Export Context t·ª´ file ri√™ng (v√≠ d·ª•: contexts/UserContext.js) ƒë·ªÉ reuse.


# 4. Context Provider 	
	
	Wrap components c·∫ßn access v·ªõi <Context.Provider value={...}>, cung c·∫•p value (c√≥ th·ªÉ state, functions, objects).	
	
function Component1() {
  const [user, setUser] = useState("Linus");  // State

  return (
    <UserContext.Provider value={user}>  // Provide value
      <h1>{`Hello ${user}!`}</h1>
      <Component2 />  // Kh√¥ng c·∫ßn truy·ªÅn prop
    </UserContext.Provider>
  );
}
value={user}: Value c√≥ th·ªÉ dynamic (state, computed). Update value ‚Üí re-render consumers.
Wrap ch·ªâ tree c·∫ßn (kh√¥ng to√†n app ƒë·ªÉ tr√°nh unnecessary re-renders).
	
	Insight chuy√™n gia: Value l√† object ƒë·ªÉ pass multiple items: value={{ user, setUser }} (cho update t·ª´ con). Nh∆∞ng n·∫øu value thay ƒë·ªïi th∆∞·ªùng, memoize v·ªõi useMemo ƒë·ªÉ stable reference: const value = useMemo(() => ({ user, setUser }), [user]). Performance: Provider ·ªü root (nh∆∞ _app.js trong Next.js) cho global access.



# 5. Use the useContext Hook

	Trong component con, d√πng useContext(Context) ƒë·ªÉ access value.

import { useState, createContext, useContext } from "react";  // Import useContext

function Component3() {
  const user = useContext(UserContext);  // Access value

  return (
    <>
      <h1>Component 3</h1>
      <h2>{`Hello ${user} again!`}</h2>
    </>
  );
}


	useContext(UserContext): Tr·∫£ v·ªÅ current value t·ª´ Provider g·∫ßn nh·∫•t (ho·∫∑c default n·∫øu kh√¥ng).
	Useful trong deep components m√† kh√¥ng drilling.

	Insight chuy√™n gia: useContext l√† Hook, tu√¢n th·ªß rules (top level, functional components). N·∫øu Context undefined, error ‚Äì d√πng optional chaining ho·∫∑c check. Trong class components, d√πng <Context.Consumer>. Best practice: T·∫°o custom Hook ƒë·ªÉ encapsulate: function useUser() { return useContext(UserContext); } ‚Äì d·ªÖ test, reuse.



# 6. Full Example: V√≠ d·ª• ƒë·∫ßy ƒë·ªß

	K·∫øt h·ª£p t·∫•t c·∫£: Create Context, Provider ·ªü parent, useContext ·ªü con.	


import { useState, createContext, useContext } from 'react';  // Imports
import { createRoot } from 'react-dom/client';

const UserContext = createContext();  // Create

function Component1() {
  const [user, setUser] = useState("Linus");

  return (
    <UserContext.Provider value={user}>  // Provide
      <h1>{`Hello ${user}!`}</h1>
      <Component2 />
    </UserContext.Provider>
  );
}

function Component2() {
  return (
    <>
      <h1>Component 2</h1>
      <Component3 />
    </>
  );
}

function Component3() {
  const user = useContext(UserContext);  // Consume

  return (
    <>
      <h1>Component 3</h1>
      <h2>{`Hello ${user} again!`}</h2>
    </>
  );
}

createRoot(document.getElementById('root')).render(
  <Component1 />
);



	Kh√¥ng prop drilling: Component2 kh√¥ng ch·∫°m user.
	Update setUser ·ªü Component1 ‚Üí auto update Component3.

	## Insight chuy√™n gia: ƒê·ªÉ update t·ª´ con, pass setter trong value: value={{ user, setUser }}. V√≠ d·ª• m·ªü r·ªông v·ªõi reducer:

	const [state, dispatch] = useReducer(reducer, initialState);
	<UserContext.Provider value={{ state, dispatch }}>




https://www.w3schools.com/react/react_useref.asp












</pre><a id='backBottom' href='../react-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>