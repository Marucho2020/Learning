<html><head><title>Lesson 32 == assert ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../NodeJS-learning.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 32 -- assert -//</h1><pre>
# Assert Module l√† g√¨? D√πng ƒë·ªÉ l√†m g√¨?

	assert = ‚Äúkh·∫≥ng ƒë·ªãnh‚Äù, ‚Äúƒë·∫£m b·∫£o ƒëi·ªÅu n√†y ph·∫£i ƒë√∫ng‚Äù
	
	const assert = require('assert'); // ho·∫∑c require('node:assert')

	## 
	M·ª•c ƒë√≠ch duy nh·∫•t:

		B·∫Øt l·ªói ngay trong l√∫c ph√°t tri·ªÉn khi m·ªôt ƒëi·ªÅu g√¨ ƒë√≥ kh√¥ng ƒë√∫ng nh∆∞ k·ª≥ v·ªçng.
		‚Üí N·∫øu ƒëi·ªÅu ki·ªán sai ‚Üí n√©m l·ªói v√† d·ª´ng ch∆∞∆°ng tr√¨nh ngay l·∫≠p t·ª©c.


	##D√πng khi n√†o? 

		Vi·∫øt unit test (c√πng Jest, Mocha)
		Ki·ªÉm tra tham s·ªë ƒë·∫ßu v√†o c·ªßa h√†m
		Debug logic ph·ª©c t·∫°p
		ƒê·∫£m b·∫£o contract gi·ªØa c√°c module



# T·∫§T C·∫¢ C√ÅC H√ÄM QUAN TR·ªåNG NH·∫§T

	assert(value) ho·∫∑c assert.ok(value) : value ph·∫£i truthy
		assert(user);
	
	
	assert.strictEqual(a, b) 	: a === b (c√πng gi√° tr·ªã + ki·ªÉu)
		"assert.strictEqual(status, 200)"
	
	
	
	"assert.deepStrictEqual(a, b)" : So s√°nh s√¢u object/array
			"assert.deepStrictEqual(arr1, arr2)"
			
			
	assert.throws(fn) :fn ph·∫£i n√©m l·ªói
		assert.throws(() => divide(10,0))"
		
assert.fail(message),Ch·ªß ƒë·ªông b√°o l·ªói,assert.fail('Kh√¥ng ƒë∆∞·ª£c v√†o ƒë√¢y!')



# V√≠ d·ª•
const assert = require('assert');

// 1. C∆° b·∫£n
assert(1 + 1 === 2);        // OK
// assert(1 + 1 === 3);     // AssertionError

// 2. strictEqual (so s√°nh c·∫£ ki·ªÉu)
assert.strictEqual('5', 5); // AssertionError
assert.strictEqual(5, 5);   // OK

// 3. deepStrictEqual (so s√°nh object)
const obj1 = { name: 'Grok', age: 1 };
const obj2 = { name: 'Grok', age: 1 };
assert.deepStrictEqual(obj1, obj2); // OK

// 4. Ki·ªÉm tra h√†m n√©m l·ªói
function divide(a, b) {
  if (b === 0) throw new Error('Chia cho 0!');
  return a / b;
}

assert.throws(
  () => divide(10, 0),
  /Chia cho 0!/    // regex ki·ªÉm tra message
);


# SO S√ÅNH C√ÅC LO·∫†I

H√†m,So s√°nh ki·ªÉu d·ªØ li·ªáu?,So s√°nh s√¢u object?,D√πng khi n√†o?
assert(a == b),Kh√¥ng,Kh√¥ng,C·ª±c √≠t d√πng
"assert.strictEqual(a, b)",C√≥ (===),Kh√¥ng,"So s√°nh s·ªë, string, null"
"assert.deepStrictEqual(a, b)",C√≥,C√≥,"Object, array ‚Äì D√ôNG NHI·ªÄU NH·∫§T"



# Node.js 18+ c√≥ assert m·ªõi si√™u ngon (n√™n d√πng)

import assert from 'node:assert';

// D√πng v·ªõi async/await
await assert.rejects(
  async () => { throw new Error('L·ªói r·ªìi'); },
  /L·ªói r·ªìi/
);

// Match l·ªói ch√≠nh x√°c
assert.match('abc123', /^[a-z]+\d+$/);
assert.doesNotMatch('abc', /^\d+$/);



# ·ª®NG D·ª§NG TH·ª∞C T·∫æ KHI ƒêI L√ÄM

	## 1. Ki·ªÉm tra tham s·ªë ƒë·∫ßu v√†o (defensive programming)
function sendMoney(toUserId, amount) {
  assert.strictEqual(typeof toUserId, 'string', 'toUserId ph·∫£i l√† string');
  assert(amount > 0, 'S·ªë ti·ªÅn ph·∫£i > 0');
  assert(amount <= 1000000, 'Kh√¥ng chuy·ªÉn qu√° 1 tri·ªáu/l·∫ßn');

  // ... logic chuy·ªÉn ti·ªÅn
}




	##2. Vi·∫øt test nhanh kh√¥ng c·∫ßn Jest

// test-user.js
const assert = require('assert');
const { getUser, createUser } = require('./user');

const user = getUser(123);
assert(user.name === 'Grok');
assert(user.age > 0);

console.log('T·∫•t c·∫£ test passed!');




	## 3. Debug logic ph·ª©c t·∫°p

function processPayment(order) {
  // ... 100 d√≤ng code ph·ª©c t·∫°p

  // ƒê·∫£m b·∫£o t·ªïng ti·ªÅn lu√¥n ƒë√∫ng
  assert.strictEqual(
    order.total,
    order.items.reduce((sum, item) => sum + item.price * item.qty, 0)
  );

  // N·∫øu ch·∫°y ƒë·∫øn ƒë√¢y m√† l·ªói ‚Üí bi·∫øt ngay bug ·ªü ƒë√¢u
}



# Assert vs if + throw ‚Äì N√™n d√πng c√°i n√†o?


Tr∆∞·ªùng h·ª£p,D√πng assert,D√πng if + throw
L·ªói l·∫≠p tr√¨nh (developer sai),D√πng assert,Kh√¥ng
L·ªói ng∆∞·ªùi d√πng (input sai),Kh√¥ng,D√πng throw
Trong production,assert b·ªã t·∫Øt (NODE_ENV=production),Lu√¥n ch·∫°y


‚Üí assert ch·ªâ ƒë·ªÉ b·∫Øt l·ªói trong l√∫c code, kh√¥ng d√πng ƒë·ªÉ validate user input!




# T√ìM T·∫ÆT SI√äU NHANH ‚Äì CHEAT SHEET



B·∫°n mu·ªën ki·ªÉm tra g√¨?,D√πng l·ªánh n√†o?
Gi√° tr·ªã ph·∫£i truthy,assert(value)
Hai gi√° tr·ªã gi·ªëng nhau (c√πng ki·ªÉu),"assert.strictEqual(a, b)"
Hai object/array gi·ªëng nhau,"assert.deepStrictEqual(a, b)"
H√†m ph·∫£i n√©m l·ªói,assert.throws(fn)
Async function ph·∫£i reject,await assert.rejects(fn)
Ch·ªß ƒë·ªông b√°o l·ªói,assert.fail('L·ªói r·ªìi')



</pre><a id='backBottom' href='../NodeJS-learning.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>