<html><head><title>Lesson 18 == Dependencies ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../NodeJS-learning.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 18 -- Dependencies -//</h1><pre>	
	
# 	1. Dependency Management L√† G√¨? (What is Dependency Management?)
	
		ƒê·ªãnh nghƒ©a c∆° b·∫£n: ƒê√¢y l√† qu√° tr√¨nh theo d√µi, c√†i ƒë·∫∑t, c·∫≠p nh·∫≠t, v√† x√≥a c√°c packages b√™n ngo√†i m√† ·ª©ng d·ª•ng c·ªßa b·∫°n ph·ª• thu·ªôc. N√≥ ƒë·∫£m b·∫£o d·ª± √°n ·ªïn ƒë·ªãnh, an to√†n, v√† d·ªÖ b·∫£o tr√¨ theo th·ªùi gian. NPM l√† package manager m·∫∑c ƒë·ªãnh, nh∆∞ng Yarn (t·ª´ Facebook) v√† pnpm (nhanh h∆°n, ti·∫øt ki·ªám ƒëƒ©a) l√† l·ª±a ch·ªçn thay th·∫ø.
	
	C√°c th√†nh ph·∫ßn ch√≠nh
		package.json: File khai b√°o dependencies (nh∆∞ manifest c·ªßa d·ª± √°n).
		
		Lock files (package-lock.json ho·∫∑c yarn.lock): Kh√≥a phi√™n b·∫£n ch√≠nh x√°c ƒë·ªÉ tr√°nh thay ƒë·ªïi b·∫•t ng·ªù.
		
		Commands: Nh∆∞ npm install, update, remove.
	
		Security tools: Nh∆∞ npm audit ƒë·ªÉ ph√°t hi·ªán l·ªó h·ªïng.
	
		S√¢u s·∫Øc h∆°n: Trong th·ª±c t·∫ø, dependency management kh√¥ng ch·ªâ l√† c√†i ƒë·∫∑t m√† c√≤n l√† qu·∫£n l√Ω "dependency hell" ‚Äì t√¨nh tr·∫°ng xung ƒë·ªôt phi√™n b·∫£n gi·ªØa c√°c packages. V√≠ d·ª•, n·∫øu package A y√™u c·∫ßu lodash 4.x nh∆∞ng package B y√™u 3.x, c√≥ th·ªÉ g√¢y crash. Lock files gi·∫£i quy·∫øt b·∫±ng c√°ch ghi ch√≠nh x√°c tree dependencies. Trong d·ª± √°n l·ªõn (nh∆∞ microservices), b·∫°n c√≥ th·ªÉ d√πng monorepo tools nh∆∞ Lerna ho·∫∑c Nx ƒë·ªÉ qu·∫£n l√Ω dependencies chung. R·ªßi ro: Dependencies c≈© c√≥ th·ªÉ c√≥ CVE (Common Vulnerabilities and Exposures), d·∫´n ƒë·∫øn hack (v√≠ d·ª•: s·ª± c·ªë Log4j nƒÉm 2021, t∆∞∆°ng t·ª± c√≥ th·ªÉ x·∫£y ra v·ªõi Node.js packages).
	
	
	
# 2. Hi·ªÉu V·ªÅ Semantic Versioning (Understanding Semantic Versioning)

	C∆° b·∫£n: Packages theo SemVer: MAJOR.MINOR.PATCH (v√≠ d·ª•: 2.8.1).	
	
		MAJOR: Thay ƒë·ªïi l·ªõn, ph√° v·ª° backward compatibility (c·∫ßn refactor code).
		MINOR: Th√™m t√≠nh nƒÉng m·ªõi, v·∫´n t∆∞∆°ng th√≠ch c≈©.
		PATCH: S·ª≠a bug, kh√¥ng ·∫£nh h∆∞·ªüng l·ªõn.
	
	
	K√Ω t·ª± ƒë·∫∑c bi·ªát trong package.json (b·∫£ng t·ª´ b√†i):
	
Symbol,Example,Meaning
^,^2.8.1,"B·∫•t k·ª≥ 2.x.x (MAJOR c·ªë ƒë·ªãnh, t·ª´ 2.8.1 tr·ªü l√™n)"
~,~2.8.1,"B·∫•t k·ª≥ 2.8.x (MAJOR.MINOR c·ªë ƒë·ªãnh, t·ª´ 2.8.1 tr·ªü l√™n)"
*,*,B·∫•t k·ª≥ phi√™n b·∫£n (kh√¥ng khuy·∫øn kh√≠ch cho production)
>=,>=2.8.1,T·ª´ 2.8.1 tr·ªü l√™n
none,2.8.1,Ch√≠nh x√°c 2.8.1	
	
	// V√≠ d·ª• trong package.json: 
{
  "dependencies": {
    "express": "^4.18.2",  // An to√†n cho updates nh·ªè
    "lodash": "~4.17.21",  // Gi·ªõi h·∫°n updates patch
    "moment": "2.29.4",    // Kh√≥a ch√≠nh x√°c
    "axios": ">=1.2.0",    // Cho ph√©p updates l·ªõn
    "debug": "4.x"         // B·∫•t k·ª≥ 4.x
  }
}	
	
	Chuy√™n gia s√¢u: SemVer gi√∫p d·ª± ƒëo√°n r·ªßi ro khi update. Tuy nhi√™n, kh√¥ng ph·∫£i package n√†o c≈©ng tu√¢n th·ªß nghi√™m ng·∫∑t (v√≠ d·ª•: m·ªôt s·ªë MAJOR changes l√©n l√∫t trong MINOR). Trong production, d√πng ^ cho dependencies ·ªïn ƒë·ªãnh, nh∆∞ng kh√≥a exact cho critical ones. C√¥ng c·ª• nh∆∞ Dependabot (t·ª´ GitHub) t·ª± ƒë·ªông check v√† PR updates. L∆∞u √Ω: V·ªõi Node.js 18+, m·ªôt s·ªë packages c≈© c√≥ th·ªÉ kh√¥ng t∆∞∆°ng th√≠ch do ESM (ES Modules) defaults.	
	
	
	
# 	3. C√†i ƒê·∫∑t Dependencies (Installing Dependencies)
	
	C√°c c√°ch c∆° b·∫£n:
	
	
		npm install: C√†i t·∫•t c·∫£ t·ª´ package.json.
		npm install express: C√†i latest v√† th√™m v√†o dependencies.
		npm install express@4.17.1: C√†i phi√™n b·∫£n c·ª• th·ªÉ.
		npm install express --no-save: C√†i m√† kh√¥ng l∆∞u v√†o file.
		npm install -g nodemon: C√†i global (cho tools nh∆∞ CLI).

	M·∫πo chuy√™n s√¢u: Global installs h·ªØu √≠ch cho dev tools, nh∆∞ng tr√°nh cho dependencies app ƒë·ªÉ gi·ªØ t√≠nh portable. Trong container (Docker), lu√¥n c√†i local ƒë·ªÉ tr√°nh xung ƒë·ªôt. N·∫øu d·ª± √°n l·ªõn, d√πng npm ci thay npm install ƒë·ªÉ install ch√≠nh x√°c t·ª´ lock file (nhanh h∆°n, an to√†n cho CI/CD).


# 4. C√°c Lo·∫°i Dependencies (Types of Dependencies)
	
	- Regular (dependencies): C·∫ßn cho runtime, v√≠ d·ª•: npm install express (l∆∞u v√†o "dependencies").
	
	- Development (devDependencies): Ch·ªâ cho dev/test, v√≠ d·ª•: npm install jest --save-dev (l∆∞u v√†o "devDependencies").
	
	- Peer Dependencies: Kh√¥ng c√†i t·ª± ƒë·ªông, ch·ªâ ch·ªâ ƒë·ªãnh compatibility (v√≠ d·ª•: plugin y√™u c·∫ßu React c·ª• th·ªÉ).
	
	- Optional Dependencies: Kh√¥ng b·∫Øt bu·ªôc, v√≠ d·ª•: npm install sharp --save-optional cho image processing (n·∫øu kh√¥ng c√≥, app v·∫´n ch·∫°y).
	
	- S√¢u s·∫Øc: Trong bundling (Webpack/Parcel), devDeps kh√¥ng ƒëi v√†o production bundle, ti·∫øt ki·ªám k√≠ch th∆∞·ªõc. PeerDeps ph·ªï bi·∫øn trong libraries (nh∆∞ React plugins). Best practice: Gi·ªØ dependencies t·ªëi thi·ªÉu ƒë·ªÉ gi·∫£m attack surface.


# 5. Lock Files (Package Lock Files)

	package-lock.json (NPM): T·ª± generate, ghi exact versions v√† tree dependencies.
	V√≠ d·ª• snippet:
	
	yarn.lock (Yarn): T∆∞∆°ng t·ª± nh∆∞ng format kh√°c, hi·ªáu qu·∫£ h∆°n cho large projects	
	
	Chuy√™n gia: Lu√¥n commit lock file v√†o Git ƒë·ªÉ team c√≥ c√πng m√¥i tr∆∞·ªùng. N·∫øu kh√¥ng, c√≥ th·ªÉ g·∫∑p "works on my machine" syndrome. Trong 2025, v·ªõi NPM 9+, lockfileVersion cao h∆°n h·ªó tr·ª£ better integrity checks.


# 6. C·∫≠p Nh·∫≠t Dependencies (Updating Dependencies)

	- npm outdated: Check outdated.
	- npm update express: Update c·ª• th·ªÉ.
	- npm update: Update t·∫•t c·∫£.
	- npm install -g npm@latest: Update NPM.
	- S·ª≠ d·ª•ng npm-check-updates (ncu): Check v√† update package.json.
	- S√¢u: Update th∆∞·ªùng xuy√™n nh∆∞ng test k·ªπ (unit tests, integration). Tools nh∆∞ Renovate ho·∫∑c Snyk t·ª± ƒë·ªông h√≥a. R·ªßi ro: Breaking changes trong MAJOR updates.


# 7. B·∫£o M·∫≠t V√† Auditing (Security and Auditing)

	npm audit: Scan vulnerabilities.
	npm audit fix: Fix t·ª± ƒë·ªông.
	npm audit fix --force: Force fix (c·∫©n th·∫≠n, c√≥ th·ªÉ break).

	Chuy√™n s√¢u: NPM t√≠ch h·ª£p v·ªõi GitHub Security Alerts. Trong 2025, v·ªõi supply chain attacks tƒÉng (nh∆∞ SolarWinds), d√πng npm audit --production ƒë·ªÉ focus production deps. Alternatives: Snyk ho·∫∑c Dependabot cho scan s√¢u h∆°n.
	
	
# 8. Best Practices	
	
	
	- Pin exact versions cho production.
	- Update ƒë·ªãnh k·ª≥.
	- Audit th∆∞·ªùng xuy√™n.
	- Commit lock file.
	- Minimize deps.
	- Scoped packages (@org/package) cho internal.
	- Document: Th√™m comments trong package.json v·ªÅ l√Ω do d√πng package.
	- M·ªü r·ªông: S·ª≠ d·ª•ng npm shrinkwrap cho legacy. Trong enterprise, enforce policies v·ªõi .npmrc ho·∫∑c private registries (Verdaccio).	
	
	
# 9. Troubleshooting Common Issues	
	
	- npm cache clean --force: Clear cache.
	- X√≥a node_modules v√† reinstall.
	- npm ls: Check tree.
	- npm rebuild: Fix broken.
	- S√¢u: N·∫øu EPERM errors (permissions), d√πng NVM ƒë·ªÉ manage Node versions. V·ªõi Windows, d√πng WSL cho consistency.	
	
	
	
	
# 10. T√≥m T·∫Øt V√† L·ªùi Khuy√™n (Summary)	
	
	Qu·∫£n l√Ω dependencies l√† ch√¨a kh√≥a cho d·ª± √°n Node.js b·ªÅn v·ªØng. B·∫±ng c√°ch n·∫Øm SemVer, lock files, v√† security, b·∫°n tr√°nh ƒë∆∞·ª£c nhi·ªÅu v·∫•n ƒë·ªÅ. Trong th·ª±c t·∫ø, k·∫øt h·ª£p v·ªõi CI/CD (GitHub Actions) ƒë·ªÉ t·ª± ƒë·ªông test updates.	
	

	
	
</pre><a id='backBottom' href='../NodeJS-learning.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>