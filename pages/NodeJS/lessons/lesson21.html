<html><head><title>Lesson 21 == https ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../NodeJS-learning.html'>ðŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 21 -- https -//</h1><pre>
# 1. Introduction to the HTTPS Module
	Äá»‹nh nghÄ©a: HTTPS Module lÃ  built-in module cung cáº¥p HTTP over TLS/SSL â€“ nghÄ©a lÃ  HTTP an toÃ n vá»›i mÃ£ hÃ³a. NÃ³ giá»‘ng HTTP Module nhÆ°ng thÃªm encryption Ä‘á»ƒ báº£o vá»‡ data khá»i eavesdropping (nghe lÃ©n), tampering (thay Ä‘á»•i), vÃ  spoofing (giáº£ máº¡o server).


	## Táº¡i sao dÃ¹ng HTTPS? (Why Use HTTPS?)
	
		- Encrypts Data: Báº£o vá»‡ sensitive info (passwords, credit cards) â€“ vÃ­ dá»¥: MITM attack (Man-in-the-Middle) khÃ´ng Ä‘á»c Ä‘Æ°á»£c data.
		- Authenticates Servers: Certs xÃ¡c thá»±c server thá»±c sá»± (trÃ¡nh phishing).
		- Ensures Data Integrity: DÃ¹ng hashing Ä‘á»ƒ detect náº¿u data bá»‹ thay Ä‘á»•i.
		- Builds Trust: Browser hiá»ƒn thá»‹ padlock icon; khÃ´ng HTTPS thÃ¬ warning "Not Secure".
		- Improves SEO: Google Æ°u tiÃªn HTTPS sites (tá»« 2014, máº¡nh hÆ¡n nÄƒm 2025 vá»›i AI search).
		- Enables Modern Features: Geolocation, Web Push, Service Workers chá»‰ hoáº¡t Ä‘á»™ng trÃªn HTTPS.	
	
	SÃ¢u sáº¯c: NÄƒm 2025, 95%+ web traffic lÃ  HTTPS (theo Google Transparency Report). KhÃ´ng dÃ¹ng HTTPS = rá»§i ro legal (GDPR, CCPA yÃªu cáº§u data protection) vÃ  máº¥t users (browser block features).	
		
	
	
	## CÃ¡ch hoáº¡t Ä‘á»™ng (How HTTPS Works):
	
		- Client (browser) connect server.
		- Server gá»­i cert (public key).
		- Client verify cert vá»›i CA (Certificate Authority) nhÆ° Let's Encrypt.
		- Handshake: Asymmetric encryption (RSA/ECDSA) Ä‘á»ƒ trao Ä‘á»•i symmetric key (AES).
		- Data transfer: Symmetric encryption nhanh hÆ¡n.	
	
		Note: SSL deprecated tá»« lÃ¢u; dÃ¹ng TLS (1.2+). TLS 1.3 (2018) loáº¡i bá» weak ciphers, nhanh hÆ¡n.
	
	
	
# 	2. Getting Started with HTTPS

	## Import Module

const https = require('https');  // CommonJS
// hoáº·c import https from 'https';  // ESM (package.json: "type": "module")


	HTTPS vs HTTP API: Giá»‘ng nhau (createServer, request, etc.), nhÆ°ng HTTPS cáº§n options vá»›i certs. HTTP nhanh hÆ¡n nhÆ°ng khÃ´ng secure â€“ dÃ¹ng HTTP chá»‰ cho local dev.




# 3. SSL/TLS Certificates

	## Types:

		- Self-Signed: Dev/test only (browser warning).
		- DV (Domain Validated): XÃ¡c thá»±c domain ownership (nhanh, ráº»).
		- OV/EV: XÃ¡c thá»±c organization (EV hiá»ƒn thá»‹ company name á»Ÿ browser bar).
		- Wildcard: Báº£o vá»‡ *.domain.com.
		- SAN (Multi-Domain): Nhiá»u domains trong 1 cert.



	## Generating Self-Signed Certificates (dÃ¹ng OpenSSL): 
	
openssl genrsa -out key.pem 2048
openssl req -new -x509 -key key.pem -out cert.pem -days 365 -nodes	
	
	
	
	Vá»›i SAN (Subject Alternative Names) cho localhost/127.0.0.1:
		Táº¡o file san.cnf nhÆ° trong bÃ i, rá»“i:
		openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout key.pem -out cert.pem -config san.cnf -extensions 'v3_req'
		Security Note: Self-signed gÃ¢y warning â€“ dÃ¹ng cho dev. NÄƒm 2025, dÃ¹ng ECDSA keys (nhanh hÆ¡n RSA) vÃ  cert validity ngáº¯n (90 days nhÆ° Let's Encrypt).
	
	
	
	## Obtaining Trusted Certificates:
		- Free: Let's Encrypt (tá»± Ä‘á»™ng renew via Certbot), ZeroSSL.
		- Paid: DigiCert, Comodo.
		- ChuyÃªn gia: Sá»­ dá»¥ng ACME protocol Ä‘á»ƒ auto-renew. Trong cloud (AWS, GCP), dÃ¹ng managed certs miá»…n phÃ­.	
	
	
	
	
# 	4. Creating an HTTPS Server
	## Basic Example: 
	
const https = require('https');
const fs = require('fs');

const options = {
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem'),
  minVersion: 'TLSv1.2'  // Disable old versions
};

https.createServer(options, (req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.end('Secure Hello World!\n');
}).listen(3000, () => console.log('HTTPS server on 3000'));	const https = require('https');
const fs = require('fs');

const options = {
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem'),
  minVersion: 'TLSv1.2'  // Disable old versions
};

https.createServer(options, (req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.end('Secure Hello World!\n');
}).listen(3000, () => console.log('HTTPS server on 3000'));
	
	Cháº¡y: node server.js, truy cáº­p https://localhost:3000 (accept warning náº¿u self-signed).
	
	
	## Advanced Config (tá»« bÃ i, má»Ÿ rá»™ng):
		ThÃªm ca chain náº¿u cáº§n (intermediate certs).
		Ciphers: Chá»‰ dÃ¹ng strong ones (TLS_AES_256_GCM_SHA384, etc.).
		OCSP Stapling: Cáº£i thiá»‡n perf báº±ng cÃ¡ch server gá»­i OCSP response.
		Session Resumption: TÃ¡i sá»­ dá»¥ng sessions Ä‘á»ƒ giáº£m handshake time.	
	
		Máº¹o pro: Port 443 cáº§n root â€“ dÃ¹ng sudo hoáº·c reverse proxy. Handle errors: server.on('error', err => console.error(err));.
	

# 5. Making HTTPS Requests

	Basic:

https.get('https://example.com', (res) => {
  res.on('data', chunk => console.log(chunk.toString()));
}).on('error', err => console.error(err));


	- With Options: ThÃªm headers, method (POST), body. Sá»­ dá»¥ng rejectUnauthorized: false cho self-signed (dev only â€“ rá»§i ro MITM).
	- SÃ¢u: DÃ¹ng agent Ä‘á»ƒ keep-alive connections, cáº£i thiá»‡n perf cho multiple requests.




# 6. HTTPS with Express.js

	## Example:
	
const express = require('express');
const https = require('https');
const fs = require('fs');

const app = express();
app.get('/', (req, res) => res.send('Secure Express!'));

https.createServer({
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem')
}, app).listen(3000);



	- Best Practices: DÃ¹ng helmet cho security headers (npm i helmet).
	- Nginx Reverse Proxy (production):
	- Config Nginx nhÆ° bÃ i: listen 443 ssl, proxy_pass Ä‘áº¿n Node port 3000. Lá»£i Ã­ch: Offload TLS, load balancing.




# 7. HTTP/2 with Node.js

	Benefits: Multiplexing (parallel requests), header compression, server push â€“ nhanh gáº¥p 2-3x HTTP/1.1.

	## Example: 
	
const http2 = require('http2');
const fs = require('fs');

const server = http2.createSecureServer({
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem'),
  allowHTTP1: true
});

server.on('stream', (stream, headers) => {
  stream.respond({ ':status': 200 });
  stream.end('HTTP/2 Hello!');
});

server.listen(8443);

	Server Push: Push assets (CSS/JS) trÆ°á»›c khi client request.


	With Express: DÃ¹ng spdy hoáº·c native http2 (Node 18+).
	Testing: curl --http2 https://localhost:8443 â€“ check "h2" protocol.
	Cáº­p nháº­t 2025: Node há»— trá»£ HTTP/3 experimental (undici module). HTTP/2 váº«n dominant, nhÆ°ng migrate sang HTTP/3 cho mobile/low-latency.


# 8. Comparing HTTP and HTTPS
	Báº£ng tá»« bÃ i: HTTPS secure hÆ¡n, nhÆ°ng overhead (handshake ~100-200ms). Vá»›i HTTP/2+TLS 1.3, overhead giáº£m.



# 9. Summary and Best Practices

	- Key Takeaways: HTTPS mandatory cho security/perf. Quáº£n lÃ½ certs tá»‘t, dÃ¹ng HTTP/2/3.
	- Security Checklist: TLS 1.3, HSTS headers, secure ciphers, rate limiting.
	- Performance: Session resumption, OCSP, short cert chains.




# Máº¹o chuyÃªn gia:

	- Sá»­ dá»¥ng certbot cho auto-renew Let's Encrypt.
	- Audit vá»›i ssllabs.com/ssltest.
	- Trong production: Cloudflare/Nginx handle TLS, Node focus business logic.
	- Common pitfalls: QuÃªn renew certs (downtime), weak ciphers (vulnerable to attacks nhÆ° DROWN).


</pre><a id='backBottom' href='../NodeJS-learning.html' style='display:none;'>ðŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ðŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>