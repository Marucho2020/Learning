<html><head><title>Lesson 30 == Timer ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../NodeJS-learning.html'>ðŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 30 -- Timer -//</h1><pre>	Timers = CÃ¡c hÃ m giÃºp báº¡n lÃªn lá»‹ch cháº¡y code sau má»™t khoáº£ng thá»i gian hoáº·c láº·p láº¡i Ä‘á»‹nh ká»³.

	Node.js cÃ³ 4 hÃ m chÃ­nh giá»‘ng nhÆ° trong trÃ¬nh duyá»‡t:

HÃ m,DÃ¹ng Ä‘á»ƒ
setTimeout(),Cháº¡y 1 láº§n sau X giÃ¢y
setInterval(),Cháº¡y láº·p láº¡i má»—i X giÃ¢y
setImmediate(),Cháº¡y ngay sau vÃ²ng láº·p hiá»‡n táº¡i
clearTimeout() / clearInterval(),Há»§y timer




#	1. setTimeout(callback, delay) â€“ Cháº¡y sau X ms 

const timeoutId = setTimeout(() => {
  console.log('Hello sau 2 giÃ¢y!');
}, 2000);

// Há»§y náº¿u chÆ°a cháº¡y
// clearTimeout(timeoutId);

	## LÆ°u Ã½ quan trá»ng:
		delay lÃ  tá»‘i thiá»ƒu, khÃ´ng pháº£i chÃ­nh xÃ¡c.
		Náº¿u CPU báº­n, code cÃ³ thá»ƒ cháº¡y trá»… hÆ¡n.




# 2. setInterval(callback, delay) â€“ Láº·p láº¡i má»—i X ms


const intervalId = setInterval(() => {
  console.log('Tick:', new Date().toLocaleTimeString());
}, 1000);

// Dá»«ng sau 5 giÃ¢y
setTimeout(() => {
  clearInterval(intervalId);
  console.log('Dá»«ng Ä‘áº¿m giá»!');
}, 5000);


	## Khi nÃ o dÃ¹ng? 
	
Cáº­p nháº­t Ä‘á»“ng há»“
Kiá»ƒm tra API Ä‘á»‹nh ká»³
Gá»­i heartbeat



# 3. setImmediate(callback) â€“ Cháº¡y NGAY SAU vÃ²ng láº·p hiá»‡n táº¡i


console.log('Báº¯t Ä‘áº§u');

setImmediate(() => {
  console.log('setImmediate cháº¡y!');
});

console.log('Káº¿t thÃºc');

	Káº¿t quáº£:

Báº¯t Ä‘áº§u
Káº¿t thÃºc
setImmediate cháº¡y!

	So sÃ¡nh vá»›i setTimeout(0)?

HÃ m,Thá»© tá»± cháº¡y
"setTimeout(fn, 0)",Cháº¡y sau I/O callbacks
setImmediate(fn),Cháº¡y trÆ°á»›c I/O callbacks


setTimeout(() => console.log('Timeout'), 0);
setImmediate(() => console.log('Immediate'));

// Káº¿t quáº£: Immediate â†’ Timeout

	ChuyÃªn gia khuyÃªn: DÃ¹ng setImmediate khi muá»‘n cháº¡y ngay sau code Ä‘á»“ng bá»™, khÃ´ng cáº§n chá» I/O.



# 4. clearTimeout() / clearInterval() â€“ Há»§y timer

const id = setTimeout(() => {
  console.log('Sáº½ khÃ´ng in!');
}, 1000);

clearTimeout(id); // Há»§y thÃ nh cÃ´ng



# THá»°C Táº¾: Event Loop & Thá»© tá»± cháº¡y code
	Node.js dÃ¹ng Event Loop â†’ thá»© tá»± cháº¡y ráº¥t quan trá»ng!

console.log('1. Äá»“ng bá»™');

setTimeout(() => console.log('2. Timeout 0ms'), 0);

setImmediate(() => console.log('3. Immediate'));

process.nextTick(() => console.log('4. nextTick'));

console.log('5. Äá»“ng bá»™ cuá»‘i');



1. Äá»“ng bá»™
5. Äá»“ng bá»™ cuá»‘i
4. nextTick
3. Immediate
2. Timeout 0ms


	## Thá»© tá»± Æ°u tiÃªn trong Event Loop:

		process.nextTick() â†’ cháº¡y ngay láº­p tá»©c
		Promises (.then) â†’ microtasks
		setImmediate()
		setTimeout(0), setInterval
		

# process.nextTick() â€“ SIÃŠU QUAN TRá»ŒNG (khÃ´ng cÃ³ trong browser)

process.nextTick(() => {
  console.log('Cháº¡y ngay, trÆ°á»›c má»i thá»©!');
});



	DÃ¹ng khi nÃ o?
		TrÃ¡nh blocking Event Loop
		Cháº¡y code sau Ä‘á»“ng bá»™, trÆ°á»›c I/O


function apiCall(callback) {
  // Giáº£ láº­p I/O
  setTimeout(() => {
    callback(null, 'data');
  }, 100);

  process.nextTick(() => {
    console.log('Chuáº©n bá»‹ xá»­ lÃ½...'); // cháº¡y trÆ°á»›c khi I/O hoÃ n thÃ nh
  });
}



# TÃ“M Táº®T NHANH â€“ Báº¢NG CHEAT SHEET

HÃ m,Cháº¡y khi nÃ o?,DÃ¹ng Ä‘á»ƒ
"setTimeout(fn, delay)",Sau Ã­t nháº¥t delay ms,"Delay, schedule"
"setInterval(fn, delay)",Láº·p má»—i delay ms,"Clock, polling"
setImmediate(fn),Ngay sau vÃ²ng láº·p hiá»‡n táº¡i,Cháº¡y trÆ°á»›c I/O
process.nextTick(fn),Ngay láº­p tá»©c (microtask),TrÃ¡nh block
clearTimeout(id),Há»§y timeout,Dá»«ng thá»±c thi





</pre><a id='backBottom' href='../NodeJS-learning.html' style='display:none;'>ðŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ðŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>