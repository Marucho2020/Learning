<html><head><title>Lesson 32 == T√¨m hi·ªÉu m√¥ h√¨nh FaceNet cho b√†i to√°n nh·∫≠n di·ªán khu√¥n m·∫∑t ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../AI-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 32 -- T√¨m hi·ªÉu m√¥ h√¨nh FaceNet cho b√†i to√°n nh·∫≠n di·ªán khu√¥n m·∫∑t -//</h1><pre>
# 1. Gi·ªõi thi·ªáu
	## FaceNet v√† ƒë·∫∑c tr∆∞ng √°nh x·∫° kh√¥ng gian
		
		FaceNet l√† m·ªôt m√¥ h√¨nh h·ªçc s√¢u (Deep Learning) ƒë∆∞·ª£c ph√°t tri·ªÉn b·ªüi Google v√†o nƒÉm 2015. ƒêi·ªÉm n·ªïi b·∫≠t c·ªßa FaceNet l√† n√≥ kh√¥ng ch·ªâ ƒë∆°n gi·∫£n l√† nh·∫≠n di·ªán khu√¥n m·∫∑t m√† c√≤n √°nh x·∫° m·ªói khu√¥n m·∫∑t v√†o m·ªôt kh√¥ng gian ƒë·∫∑c tr∆∞ng (embedding space) sao cho kho·∫£ng c√°ch Euclidean gi·ªØa hai vector ƒë·∫∑c tr∆∞ng ƒë·∫°i di·ªán cho hai khu√¥n m·∫∑t t∆∞∆°ng t·ª± nhau s·∫Ω nh·ªè, trong khi kho·∫£ng c√°ch gi·ªØa hai vector ƒë·∫°i di·ªán cho hai khu√¥n m·∫∑t kh√°c nhau s·∫Ω l·ªõn.
		
		
	## 	M·∫°ng n∆°-ron t√≠ch ch·∫≠p v√† Triplet Loss trong FaceNet 
		FaceNet s·ª≠ d·ª•ng m·ªôt m·∫°ng n∆°-ron t√≠ch ch·∫≠p (Convolutional Neural Network ‚Äì CNN) ƒë·ªÉ h·ªçc c√°c ƒë·∫∑c tr∆∞ng c·ªßa khu√¥n m·∫∑t. Sau khi qua m·∫°ng, m·ªói khu√¥n m·∫∑t s·∫Ω ƒë∆∞·ª£c √°nh x·∫° th√†nh m·ªôt vector c√≥ ƒë·ªô d√†i c·ªë ƒë·ªãnh, th∆∞·ªùng l√† 128 chi·ªÅu, g·ªçi l√† face embedding. Vector n√†y c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng cho c√°c nhi·ªám v·ª• nh∆∞ x√°c th·ª±c khu√¥n m·∫∑t, t√¨m ki·∫øm khu√¥n m·∫∑t, v√† nh√≥m khu√¥n m·∫∑t.
		
		M·ªôt trong nh·ªØng ƒë·∫∑c ƒëi·ªÉm ch√≠nh c·ªßa FaceNet l√† kh·∫£ nƒÉng t·∫°o ra c√°c vector ƒë·∫∑c tr∆∞ng c√≥ t√≠nh ph√¢n bi·ªát cao. ƒêi·ªÅu n√†y ƒë·∫°t ƒë∆∞·ª£c nh·ªù vi·ªác s·ª≠ d·ª•ng m·ªôt h√†m m·∫•t m√°t ƒë·∫∑c bi·ªát g·ªçi l√† Triplet Loss, c√πng v·ªõi m·ªôt k·ªπ thu·∫≠t hu·∫•n luy·ªán tinh vi.
		
		
# 2. C·∫•u tr√∫c m·∫°ng FaceNet 		
		https://aicandy.vn/wp-content/uploads/2024/09/aicandy_facenet_arc.png
		M√¥ h√¨nh FaceNet c√≥ m·ªôt c·∫•u tr√∫c ph·ª©c t·∫°p v·ªõi nhi·ªÅu th√†nh ph·∫ßn kh√°c nhau, m·ªói ph·∫ßn ƒë√≥ng m·ªôt vai tr√≤ quan tr·ªçng trong vi·ªác tr√≠ch xu·∫•t v√† √°nh x·∫° ƒë·∫∑c tr∆∞ng khu√¥n m·∫∑t. C·∫•u tr√∫c ch√≠nh c·ªßa FaceNet bao g·ªìm c√°c ph·∫ßn sau:
		

	## 2.1. M·∫°ng n∆°-ron t√≠ch ch·∫≠p (CNN) ƒë·ªÉ tr√≠ch xu·∫•t ƒë·∫∑c tr∆∞ng
		Ph·∫ßn ƒë·∫ßu ti√™n c·ªßa FaceNet l√† m·ªôt m·∫°ng n∆°-ron t√≠ch ch·∫≠p (CNN) ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ tr√≠ch xu·∫•t c√°c ƒë·∫∑c tr∆∞ng t·ª´ h√¨nh ·∫£nh khu√¥n m·∫∑t. M·∫°ng n√†y bao g·ªìm nhi·ªÅu l·ªõp t√≠ch ch·∫≠p (convolutional layers) v√† l·ªõp g·ªôp (pooling layers) ƒë·ªÉ h·ªçc c√°c ƒë·∫∑c tr∆∞ng h√¨nh h·ªçc v√† phong c√°ch c·ªßa khu√¥n m·∫∑t.
		
	C·∫•u tr√∫c ƒëi·ªÉn h√¨nh c·ªßa m·∫°ng CNN trong FaceNet c√≥ th·ªÉ bao g·ªìm:
	
		L·ªõp t√≠ch ch·∫≠p (Convolutional Layer): C√°c l·ªõp n√†y gi√∫p ph√°t hi·ªán c√°c ƒë·∫∑c tr∆∞ng c∆° b·∫£n c·ªßa h√¨nh ·∫£nh, nh∆∞ c·∫°nh v√† k·∫øt c·∫•u. V√≠ d·ª•, l·ªõp t√≠ch ch·∫≠p ƒë·∫ßu ti√™n c√≥ th·ªÉ c√≥ 64 k√™nh ƒë·∫ßu ra v·ªõi k√≠ch th∆∞·ªõc kernel l√† 7√ó7.
		
		L·ªõp G·ªôp (Pooling Layer): C√°c l·ªõp n√†y gi·∫£m k√≠ch th∆∞·ªõc kh√¥ng gian c·ªßa h√¨nh ·∫£nh ƒë·∫ßu v√†o, gi√∫p gi·∫£m s·ªë l∆∞·ª£ng tham s·ªë v√† t√≠nh to√°n, ƒë·ªìng th·ªùi gi·ªØ l·∫°i c√°c ƒë·∫∑c tr∆∞ng quan tr·ªçng. L·ªõp g·ªôp th∆∞·ªùng s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p g·ªôp t·ªëi ƒëa (max pooling) v·ªõi k√≠ch th∆∞·ªõc kernel l√† 3√ó3.
	
		L·ªõp Batch Normalization: L·ªõp n√†y gi√∫p chu·∫©n h√≥a ƒë·∫ßu ra c·ªßa c√°c l·ªõp t√≠ch ch·∫≠p, gi·∫£m thi·ªÉu s·ª± thay ƒë·ªïi ph√¢n ph·ªëi trong qu√° tr√¨nh hu·∫•n luy·ªán.
		
		L·ªõp k√≠ch ho·∫°t (Activation Layer): L·ªõp ReLU (Rectified Linear Unit) th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ th√™m t√≠nh phi tuy·∫øn v√†o m√¥ h√¨nh, gi√∫p m√¥ h√¨nh h·ªçc c√°c ƒë·∫∑c tr∆∞ng ph·ª©c t·∫°p h∆°n.
		
		
		### V√≠ d·ª• v·ªÅ c·∫•u tr√∫c m·∫°ng CNN c√≥ th·ªÉ nh∆∞ sau: 
			\text{Input Image} \rightarrow \text{Conv1 (64 filters, 7√ó7)} \rightarrow \text{ReLU} \rightarrow \text{MaxPool (3√ó3)} \rightarrow \text{Conv2 (128 filters, 3√ó3)} \rightarrow \text{ReLU} \rightarrow \text{MaxPool (3√ó3)}
			
			

	## 2.2. L·ªõp Fully Connected (FC) ƒë·ªÉ √°nh x·∫° ƒë·∫∑c tr∆∞ng 
		Sau khi c√°c ƒë·∫∑c tr∆∞ng ƒë∆∞·ª£c tr√≠ch xu·∫•t b·ªüi c√°c l·ªõp CNN, ch√∫ng ƒë∆∞·ª£c ƒë∆∞a qua c√°c l·ªõp fully connected (FC) ƒë·ªÉ √°nh x·∫° c√°c ƒë·∫∑c tr∆∞ng n√†y th√†nh vector embedding c√≥ ƒë·ªô d√†i c·ªë ƒë·ªãnh. C√°c l·ªõp FC th∆∞·ªùng ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ gi·∫£m d·∫ßn s·ªë l∆∞·ª£ng k√≠ch th∆∞·ªõc ƒë·∫∑c tr∆∞ng t·ª´ c√°c l·ªõp t√≠ch ch·∫≠p xu·ªëng m·ªôt k√≠ch th∆∞·ªõc nh·ªè h∆°n, th∆∞·ªùng l√† 128 ho·∫∑c 512 chi·ªÅu cho vector embedding.
		
		C·∫•u tr√∫c c·ªßa c√°c l·ªõp FC c√≥ th·ªÉ nh∆∞ sau:
			\text{Flatten} \rightarrow \text{FC1 (1024 units)} \rightarrow \text{ReLU} \rightarrow \text{FC2 (Embedding Dim)}
			
			Trong ƒë√≥, Embedding Dim l√† k√≠ch th∆∞·ªõc c·ªßa vector ƒë·∫∑c tr∆∞ng, th∆∞·ªùng l√† 128.

	## 2.3. H√†m m·∫•t m√°t Triplet Loss 
		Triplet Loss l√† m·ªôt trong nh·ªØng h√†m m·∫•t m√°t quan tr·ªçng nh·∫•t trong m√¥ h√¨nh FaceNet. M·ª•c ti√™u c·ªßa Triplet Loss l√† ƒë·∫£m b·∫£o r·∫±ng kho·∫£ng c√°ch gi·ªØa vector ƒë·∫∑c tr∆∞ng c·ªßa m·ªôt khu√¥n m·∫∑t (g·ªçi l√† Anchor) v√† m·ªôt khu√¥n m·∫∑t kh√°c c·ªßa c√πng m·ªôt ng∆∞·ªùi (g·ªçi l√† Positive) ph·∫£i nh·ªè h∆°n kho·∫£ng c√°ch gi·ªØa vector ƒë·∫∑c tr∆∞ng c·ªßa khu√¥n m·∫∑t ƒë√≥ v√† khu√¥n m·∫∑t c·ªßa m·ªôt ng∆∞·ªùi kh√°c (g·ªçi l√† Negative).
		
		ƒê·ªãnh nghƒ©a:
			\mathcal{L} = \sum_{i=1}^{N} \left[ \|f(x_i^A) ‚Äì f(x_i^P)\|_2^2 ‚Äì \|f(x_i^A) ‚Äì f(x_i^N)\|_2^2 + \alpha \right]_+
		
		Trong ƒë√≥:
			
			x_i^A: H√¨nh ·∫£nh Anchor (m·ªè neo)
			x_i^P: H√¨nh ·∫£nh Positive (t√≠ch c·ª±c, c√πng m·ªôt ng∆∞·ªùi v·ªõi Anchor)		
			x_i^N: H√¨nh ·∫£nh Negative (ti√™u c·ª±c, ng∆∞·ªùi kh√°c v·ªõi Anchor) 
			f(x): H√†m √°nh x·∫° h√¨nh ·∫£nh x th√†nh vector ƒë·∫∑c tr∆∞ng (embedding) 
			\alpha: M·ªôt si√™u tham s·ªë g·ªçi l√† margin, gi√∫p ki·ªÉm so√°t kho·∫£ng c√°ch t·ªëi thi·ªÉu gi·ªØa Positive v√† Negative


		H√†m m·∫•t m√°t n√†y y√™u c·∫ßu r·∫±ng kho·∫£ng c√°ch gi·ªØa Anchor v√† Positive nh·ªè h∆°n kho·∫£ng c√°ch gi·ªØa Anchor v√† Negative √≠t nh·∫•t l√† m·ªôt l∆∞·ª£ng b·∫±ng a. ƒêi·ªÅu n√†y gi√∫p m√¥ h√¨nh h·ªçc c√°ch ph√¢n bi·ªát r√µ r√†ng gi·ªØa c√°c khu√¥n m·∫∑t kh√°c nhau.




	###  Ho·∫°t ƒë·ªông:
https://aicandy.vn/tim-hieu-mo-hinh-facenet-cho-bai-toan-nhan-dien-khuon-mat/













</pre><a id='backBottom' href='../AI-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>