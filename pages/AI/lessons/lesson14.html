<html><head><title>Lesson 16 ==  ==  == Recurrent Neural Network (RNN)	: á»¨ng dá»¥ng vÃ  cÃ¡ch hoáº¡t Ä‘á»™ng. ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../AI-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 16 --  --  -- Recurrent Neural Network (RNN)	: á»¨ng dá»¥ng vÃ  cÃ¡ch hoáº¡t Ä‘á»™ng. -//</h1><pre>

# KhÃ¡i niá»‡m 
	Recurrent Neural Networks(RNN) lÃ  má»™t loáº¡i máº¡ng nÆ¡-ron Ä‘áº·c biá»‡t Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ xá»­ lÃ½ dá»¯ liá»‡u tuáº§n tá»±. KhÃ¡c vá»›i cÃ¡c máº¡ng nÆ¡-ron thÃ´ng thÆ°á»ng, RNN cÃ³ kháº£ nÄƒng ghi nhá»› thÃ´ng tin tá»« cÃ¡c bÆ°á»›c trÆ°á»›c Ä‘Ã³ nhá» cÆ¡ cháº¿ pháº£n há»“i (recurrent), cho phÃ©p mÃ´ hÃ¬nh cÃ³ thá»ƒ táº­n dá»¥ng ngá»¯ cáº£nh cá»§a dá»¯ liá»‡u trÆ°á»›c Ä‘á»ƒ dá»± Ä‘oÃ¡n hoáº·c suy luáº­n dá»¯ liá»‡u hiá»‡n táº¡i. Äiá»u nÃ y lÃ m cho RNN Ä‘áº·c biá»‡t hiá»‡u quáº£ trong viá»‡c phÃ¢n tÃ­ch dá»¯ liá»‡u chuá»—i thá»i gian, xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn, dá»‹ch mÃ¡y, vÃ  nháº­n diá»‡n giá»ng nÃ³i, nÆ¡i mÃ  thÃ´ng tin tá»« quÃ¡ khá»© lÃ  ráº¥t quan trá»ng Ä‘á»ƒ hiá»ƒu chÃ­nh xÃ¡c hiá»‡n táº¡i. 
	

# CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a Recurrent Neural Network(RNN)	
	
https://aicandy.vn/wp-content/uploads/2024/09/aicandy_RNN.png

	
	## Hidden State 
		Äiá»ƒm khÃ¡c biá»‡t lá»›n nháº¥t cá»§a RNN so vá»›i cÃ¡c máº¡ng nÆ¡-ron truyá»n thá»‘ng lÃ  kháº£ nÄƒng lÆ°u trá»¯ vÃ  cáº­p nháº­t thÃ´ng tin qua cÃ¡c bÆ°á»›c cá»§a chuá»—i thá»i gian. Táº¡i má»—i bÆ°á»›c thá»i gian(timestep), RNN duy trÃ¬ má»™t biáº¿n gá»i lÃ  tráº¡ng thÃ¡i áº©n (h_t), biá»ƒu diá»…n bá»™ nhá»› cá»§a mÃ´ hÃ¬nh vá» cÃ¡c thÃ´ng tin Ä‘Ã£ nháº­n Ä‘Æ°á»£c tá»« nhá»¯ng bÆ°á»›c trÆ°á»›c Ä‘Ã³. Tráº¡ng thÃ¡i áº©n nÃ y Ä‘Æ°á»£c cáº­p nháº­t táº¡i má»—i bÆ°á»›c thá»i gian dá»±a trÃªn Ä‘áº§u vÃ o vÃ  hiá»‡n táº¡i vÃ  tráº¡ng thÃ¡i áº©n tá»« bÆ°á»›c trÆ°á»›c Ä‘Ã³. 
		CÃ´ng thá»©c tÃ­nh toÃ¡n tráº¡ng thÃ¡i áº©n táº¡i má»—i bÆ°á»›c thá»i gian cÃ³ thá»ƒ Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° sau 
			h_t = f(W_{xh}x_t + W_{hh}h_{t-1} + b_h)
			
			
		Trong Ä‘Ã³ : 
			h_t : Tráº¡ng thÃ¡i áº©n táº¡i thá»i Ä‘iá»ƒm t 
			x_t : Äáº§u vÃ o táº¡i thá»i Ä‘iá»ƒm t 
			W_{xh} : Ma tráº­n trá»ng sá»‘ káº¿t ná»‘i Ä‘áº§u vÃ o vá»›i tráº¡ng thÃ¡i áº©n. 
			W_{hh} : Ma tráº­n trá»ng sá»‘ káº¿t ná»‘i tráº¡ng thÃ¡i áº©n trÆ°á»›c Ä‘Ã³ vá»›i tráº¡ng thÃ¡i áº©n hiá»‡n táº¡i 
			b_h	   : tham sá»‘ bias cho tráº¡ng thÃ¡i áº©n 
			f 	: HÃ m kÃ­ch hoáº¡t (thÆ°á»ng lÃ  hÃ m tanh hoáº·c ReLU 
			
			)
			
	## Output  
		RNN cÃ³ thá»ƒ táº¡o Ä‘áº§u ra táº¡i má»—i bÆ°á»›c thá»i gian, thÆ°á»ng Ä‘Æ°á»£c tÃ­nh toÃ¡n dá»±a trÃªn tráº¡ng thÃ¡i áº©n táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³. Äáº§u ra y_t táº¡i thá»i Ä‘iá»ƒm t Ä‘Æ°á»£c tÃ­nh báº±ng cÃ´ng thá»©c : 
				y_t = W_{hy}h_t + b_y
				

		Trong Ä‘Ã³ : 
			y_t : Äáº§u ra táº¡i thá»i Ä‘iá»ƒm t 
			W_{hy}	: Ma tráº­n trá»ng sá»‘ káº¿t ná»‘i tráº¡ng thÃ¡i áº©n vá»›i Ä‘áº§u ra 
			b_y		: Tham sá»‘ bias cho Ä‘áº§u ra 
			
	## Backpropagation 
		Backpropagation lÃ  thuáº­t toÃ¡n lan truyá»n ngÆ°á»£c trong cÃ¡c máº¡ng nÆ¡-ron thÃ´ng thÆ°á»ng. á» má»—i lá»›p cá»§a máº¡ng nÆ¡-ron, giÃ¡ trá»‹ Ä‘áº§u ra Ä‘Æ°á»£c tÃ­nh toÃ¡n dá»±a trÃªn Ä‘áº§u vÃ o cÃ¡c trá»ng sá»‘ tÆ°Æ¡ng á»©ng. Sau Ä‘Ã³ , Ä‘á»ƒ tá»‘i Æ°u hÃ³a mÃ´ hÃ¬nh, ta cáº§n tÃ­nh toÃ¡n gradient cá»§a hÃ m máº¥t mÃ¡t \mathcal{L} theo cÃ¡c trá»ng sá»‘ nÃ y , giÃºp ta Ä‘iá»u chá»‰nh cÃ¡c trá»ng sá»‘ sao cho mÃ´ hÃ¬nh cÃ³ thá»ƒ Ä‘Æ°a ra dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c hÆ¡n 
		
		CÃ´ng thá»©c tá»•ng quÃ¡t cá»§a lan truyá»n ngÆ°á»£c lÃ  : 
			\frac{\partial \mathcal{L}}{\partial W} = \frac{\partial \mathcal{L}}{\partial y} \cdot \frac{\partial y}{\partial W}
			
		Trong Ä‘Ã³ : 
			\frac{\partial \mathcal{L}}{\partial W}		: lÃ  gradient cá»§a hÃ m máº¥t mÃ¡t theo trá»ng sá»‘ W 
			\frac{\partial \mathcal{L}}{\partial y}		: lÃ  gradient cá»§a hÃ m máº¥t mÃ¡t theo Ä‘áº§u ra y 
			\frac{\partial y}{\partial W}				: lÃ  gradient cá»§a Ä‘áº§u ra theo trá»ng sá»‘ W 
			
			QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c Ã¡p dá»¥ng cho táº¥t cáº£ cÃ¡c trá»ng sá»‘ trong máº¡ng vÃ  Ä‘Æ°á»£c thá»±c hiá»‡n tá»« Ä‘áº§u ra trá»Ÿ ngÆ°á»£c láº¡i Ä‘áº§u vÃ o, tá»«ng lá»›p má»™t. Khi Ä‘Ã£ tÃ­nh Ä‘Æ°á»£c gradient cÃ¡c trá»ng sá»‘ sáº½ Ä‘Æ°á»£c cáº­p nháº­t báº±ng cÃ¡ch sá»­ dá»¥ng má»™t phÆ°Æ¡ng phÃ¡p tá»‘i Æ°u hÃ³a nhÆ° gradient descent 
			



	##	Backpropagation Through Time (BPTT) 
			
		Trong cÃ¡c máº¡ng RNN, dá»¯ liá»‡u Ä‘Æ°á»£c xá»­ lÃ½ tuáº§n tá»± qua nhiá»u bÆ°á»›c thá»i gian. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  tráº¡ng thÃ¡i áº©n táº¡i thá»i Ä‘iá»ƒm t phá»¥ thuá»™c vÃ o cáº£ Ä‘áº§u vÃ o táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³ vÃ  tráº¡ng thÃ¡i áº©n tá»« bÆ°á»›c tÆ°á»›c Ä‘Ã³. Do Ä‘Ã³, khi tÃ­nh toÃ¡n gradient, ta khÃ´ng chá»‰ lan truyá»n ngÆ°á»£c qua cÃ¡c lá»›p nhÆ° trong máº¡ng nÆ¡-ron truyá»n thá»‘ng mÃ  cÃ²n pháº£i lan truyá»n qua cÃ¡c bÆ°á»›c thá»i gian trÆ°á»›c Ä‘Ã³. ÄÃ¢y lÃ  lÃ½ do thuáº­t toÃ¡n BPTT Ä‘Æ°á»£c ra Ä‘á»i. 
			https://aicandy.vn/wp-content/uploads/2024/09/aicandy_RNN_backpropagation.jpg
		
		Trong BPTT, máº¡ng RNN Ä‘Æ°á»£c má»Ÿ rá»™ng qua thá»i gian, má»—i bÆ°á»›c thá»i gian cá»§a RNN Ä‘Æ°á»£c coi nhÆ° má»™t lá»›p riÃªng biá»‡t. Khi lan truyá»n ngÆ°á»£c, gradient khÃ´ng chá»‰ Ä‘Æ°á»£c lan truyá»n qua cÃ¡c trá»ng sá»‘ cá»§a cÃ¡c lá»›p trong máº¡ng, mÃ  cÃ²n pháº£i lan truyá»n ngÆ°á»£c qua cÃ¡c bÆ°á»›c thá»i gian Ä‘á»ƒ tÃ­nh toÃ¡n áº£nh hÆ°á»Ÿng cá»§a cÃ¡c tráº¡ng thÃ¡i áº©n trÆ°á»›c Ä‘Ã³ Ä‘áº¿n lá»—i hiá»‡n táº¡i 
		
		### CÃ´ng thá»©c tá»•ng quÃ¡t cá»§a BPTT lÃ  : 
		
			\frac{\partial \mathcal{L}}{\partial W} = \sum_{t=1}^{T} \frac{\partial \mathcal{L}_t}{\partial y_t} \cdot \frac{\partial y_t}{\partial h_t} \cdot \frac{\partial h_t}{\partial h_{t-1}} \cdot \frac{\partial h_{t-1}}{\partial W}


		Trong Ä‘Ã³ : 
			\frac{\partial \mathcal{L}_t}{\partial y_t} : lÃ  gradient cá»§a hÃ m máº¥t mÃ¡t táº¡i bÆ°á»›c thá»i gian t theo Ä‘áº§u ra yt 
			\frac{\partial y_t}{\partial h_t}	: lÃ  gradient cá»§a Ä‘áº§u ra táº¡i thá»i Ä‘iá»ƒm t theo tráº¡ng thÃ¡i áº©n ht 
			\frac{\partial h_t}{\partial h_{t-1}}	: lÃ  gradient cá»§a tráº¡ng thÃ¡i áº©n hiá»‡n táº¡i theo tráº¡ng thÃ¡i áº©n trÆ°á»›c Ä‘Ã³ 
			\frac{\partial h_{t-1}}{\partial W}		: lÃ  gradient cá»§a tráº¡ng thÃ¡i áº©n trÆ°á»›c theo trá»ng sá»‘ W 
			
			
	## Triá»ƒn khai RNN báº±ng PyTorch 
			DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch triá»ƒn khai má»™t máº¡ng RNN Ä‘Æ¡n giáº£n báº±ng PyTorch. Máº¡ng sáº½ dá»± Ä‘oÃ¡n sá»‘ tiáº¿p theo cá»§a chuá»—i [1, 2, 3, 4].
			RNNByPytorch.py


		Giáº£i thÃ­ch:	

	https://aicandy.vn/recurrent-neural-network-rnn-ung-dung-va-cach-hoat-dong/




				
				
				
				
				
		
</pre><a id='backBottom' href='../AI-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>