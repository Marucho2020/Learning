<html><head><title>Lesson 48 == Serializable ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 48 -- Serializable -//</h1><pre>
#  Kh√°i ni·ªám 
	Serializable l√† m·ªôt interface trong Java d√πng ƒë·ªÉ ƒë√°nh d·∫•u r·∫±ng m·ªôt class c√≥ th·ªÉ ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi th√†nh byte stream ƒë·ªÉ l∆∞u tr·ªØ ho·∫∑c truy·ªÅn qua m·∫°ng, v√† sau ƒë√≥ c√≥ th·ªÉ ƒë∆∞·ª£c kh√¥i ph·ª•c th√†nh ƒë·ªëi t∆∞·ª£ng. 
	
	
	## M·ª•c ƒë√≠ch 
		Cho ph√©p ƒë·ªëi t∆∞·ª£ng c·ªßa m·ªôt class ƒë∆∞·ª£c ghi v√†o file, truy·ªÅn qua m·∫°ng, l∆∞u v√†o DB d∆∞·ªõi d·∫°ng byte stream 
		
	## C∆° ch·∫ø ho·∫°t ƒë·ªông 
		Java cung c·∫•p c∆° ch·∫ø ho·∫°t ƒë·ªông th√¥ng qua ObjectOutputStream v√† ObjectInputStream ƒë·ªÉ serialize v√† deserialize m·ªôt object  
		
	## T√≠nh ch·∫•t  
		Interface Serializble thu·ªôc package java.io v√† kh√¥ng c√≥ ph∆∞∆°ng th·ª©c n√†o marker interface 
		
		
# C√°ch s·ª≠ d·ª•ng  
		
		
	## Khai b√°o m·ªôt Serializable 
		-> ch·ªâ c·∫ßn implements Serializable  
		
		import java.io.Serializable;
		class Person implements Serializable {
			private String name;
			private int age;
		
			public Person(String name, int age) {
				this.name = name;
				this.age = age;
			}
		
			@Override
			public String toString() {
				return "Person{name='" + name + "', age=" + age + "}";
			}
		}

	·ªû ƒë√¢y, class Person c√≥ th·ªÉ ƒë∆∞·ª£c serialize v√† deserialize.



	## Serialize ƒë·ªëi t∆∞·ª£ng 
		S·ª≠ d·ª•ng ObjectOutputStream ƒë·ªÉ ghi object v√†o file  
		
		import java.io.FileOutputStream;
		import java.io.IOException;
		import java.io.ObjectOutputStream;
		
		public class SerializeExample {
			public static void main(String[] args) {
				Person person = new Person("John Doe", 30);
		
				try (FileOutputStream fileOut = new FileOutputStream("person.ser");
					ObjectOutputStream out = new ObjectOutputStream(fileOut)) {
					out.writeObject(person);
					System.out.println("Object has been serialized.");
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}


	## Deserialize ƒë·ªëi t∆∞·ª£ng 
		import java.io.FileInputStream;
		import java.io.IOException;
		import java.io.ObjectInputStream;
		
		public class DeserializeExample {
			public static void main(String[] args) {
				try (FileInputStream fileIn = new FileInputStream("person.ser");
					ObjectInputStream in = new ObjectInputStream(fileIn)) {
		
					Person person = (Person) in.readObject();
					System.out.println("Object has been deserialized: " + person);
		
				} catch (IOException | ClassNotFoundException e) {
					e.printStackTrace();
				}
			}
		}
				FileInputStream ƒë·ªÉ ƒë·ªçc t·ª´ file
				ObjectInputStream ƒë·ªÉ chuy·ªÉn ƒë·ªïi byte stream v·ªÅ object b·∫±ng readObject()
				Downcasting: V√¨ readObject() tr·∫£ v·ªÅ Object, c·∫ßn √©p ki·ªÉu v·ªÅ Person.




# Transient - b·ªè qua m·ªôt field khi serialize 
	
		M·ªôt s·ªë d·ªØ li·ªáu kh√¥ng n√™n ƒë∆∞·ª£c l∆∞u khi serialize, v√≠ d·ª• nh∆∞ m·∫≠t kh·∫©u -> s·ª≠ d·ª•ng "trainsient" ƒë·ªÉ b·ªè qua file ƒë√≥ 
		
		
		
				class User implements Serializable {
					private String username;
					private transient String password; // Kh√¥ng ƒë∆∞·ª£c l∆∞u
				
					public User(String username, String password) {
						this.username = username;
						this.password = password;
					}
				
					@Override
					public String toString() {
						return "User{username='" + username + "', password='" + password + "'}";
					}
				}
				
				// N·∫øu serialize v√† deserialize, password s·∫Ω tr·ªü th√†nh null: 
				
				User user = new User("admin", "123456");
				System.out.println(user);  // User{username='admin', password='123456'}
				
				serialize(user);
				User deserializedUser = deserialize();
				System.out.println(deserializedUser); // User{username='admin', password='null'}
		




#	serialVersionUID - Tr√°nh l·ªói khi deserialize 
	
	## M·ªói class Serializable c√≥ m·ªôt serialVersionUID. N·∫øu kh√¥ng khai b√°o, JVM s·∫Ω t·ª± sinh ra d·ª±a tr√™n class structure 
	
			private static final long serialVersionUID = 1L;

	## V·∫•n ƒë·ªÅ khi kh√¥ng c√≥ serialVersionUID 
		N·∫øu class thay ƒë·ªïi(th√™m field m·ªõi ), Java s·∫Ω n√©m l·ªói khi deserialize :
			java.io.InvalidClassException: User; local class incompatible
			ƒê·ªÉ tr√°nh l·ªói n√†y, lu√¥n khai b√°o serialVersionUID th·ªß c√¥ng.
			


# Serializable v·ªõi Object Composition 
	
	## n·∫øu m·ªôt class c√≥ field l√† m·ªôt object kh√°c, class ƒë√≥ c≈©ng ph·∫£i Serializable 


				class Address implements Serializable {
				private String city;
					
					public Address(String city) {
						this.city = city;
					}
				}
				
				class Employee implements Serializable {
					private String name;
					private Address address; // Address c≈©ng ph·∫£i Serializable
				
					public Employee(String name, Address address) {
						this.name = name;
						this.address = address;
					}
				}

		N·∫øu Address kh√¥ng implements Serializable, s·∫Ω g·∫∑p l·ªói khi serialize Employee.


# Externalizable - Ki·ªÉm so√°t chi ti·∫øt qu√° tr√¨nh serialize 

	Interface Externalizable (extends Serializable) gi√∫p t√πy ch·ªânh qu√° tr√¨nh serialize.
	
				import java.io.*;
				
				class CustomPerson implements Externalizable {
					private String name;
					private int age;
				
					public CustomPerson() { } // B·∫Øt bu·ªôc c√≥ constructor kh√¥ng tham s·ªë
				
					public CustomPerson(String name, int age) {
						this.name = name;
						this.age = age;
					}
				
					@Override
					public void writeExternal(ObjectOutput out) throws IOException {
						out.writeUTF(name);
						out.writeInt(age);
					}
				
					@Override
					public void readExternal(ObjectInput in) throws IOException {
						name = in.readUTF();
						age = in.readInt();
					}
				
					@Override
					public String toString() {
						return "CustomPerson{name='" + name + "', age=" + age + "}";
					}
				}



		## L·ª£i √≠ch c·ªßa Externalizable:
			Ki·ªÉm so√°t c√°ch ghi v√† ƒë·ªçc d·ªØ li·ªáu (v√≠ d·ª•: m√£ h√≥a, n√©n d·ªØ li·ªáu).
			Ti·∫øt ki·ªám dung l∆∞·ª£ng so v·ªõi Serializable.


# Nh·ªØng ƒëi·ªÉm l∆∞u √Ω quan tr·ªçng  

C√¢u h·ªèi																					C√¢u tr·∫£ l·ªùi
Serializable c√≥ method n√†o kh√¥ng?														Kh√¥ng, ch·ªâ l√† marker interface.
						
N·∫øu m·ªôt field l√† transient, n√≥ c√≥ ƒë∆∞·ª£c serialize kh√¥ng?									Kh√¥ng, khi deserialize n√≥ s·∫Ω l√† null (v·ªõi object) ho·∫∑c gi√° tr·ªã m·∫∑c ƒë·ªãnh (0, false).
						
N·∫øu class con k·∫ø th·ª´a class kh√¥ng Serializable, c√≥ l·ªói kh√¥ng?							C√≥, tr·ª´ khi class cha c√≥ constructor kh√¥ng tham s·ªë.
			
N·∫øu serialVersionUID kh√°c nhau gi·ªØa hai phi√™n b·∫£n class, chuy·ªán g√¨ x·∫£y ra?				InvalidClassException.

Externalizable kh√°c Serializable th·∫ø n√†o?					Externalizable y√™u c·∫ßu tri·ªÉn khai writeExternal() v√† readExternal(), gi√∫p ki·ªÉm so√°t chi ti·∫øt vi·ªác serialize.


</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>