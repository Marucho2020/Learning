<html><head><title>Lesson 79 == Code Quality ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 79 -- Code Quality -//</h1><pre>
# Kh√°i ni·ªám 
	Code quality kh√¥ng ch·ªâ ƒë·ªÉ cho ƒë·∫πp m√† ƒë·ªÉ ph√°t hi·ªán l·ªói s·ªõm, tr√°nh bug production, v√† gi·∫£m technical debt . M·ªôt CI pipeline Kh√¥ng c√≥ quality gate th√¨ ch·ªâ l√† "build script "
	
	
	
# Th√†nh ph·∫ßn Code Quality c·∫ßn c√≥ trong CI 
	

Th√†nh ph·∫ßn									C√¥ng c·ª• ph·ªï bi·∫øn								M·ª•c ti√™u
Static code analysis				SonarQube, PMD, Checkstyle					Ph√¢n t√≠ch l·ªói logic, bad practices, security smell
Linter								ESLint (JS/TS), Checkstyle (Java)			Format, naming convention, style guide
Test coverage						JaCoCo (Java), Istanbul (JS)				Ki·ªÉm tra % code ƒë∆∞·ª£c test
Security scan (SAST)				SonarQube, CodeQL, Semgrep					Ph√°t hi·ªán l·ªó h·ªïng b·∫£o m·∫≠t
Dependency vulnerability scan		OWASP Dependency Check, Snyk				Ki·ªÉm tra th∆∞ vi·ªán c√≥ l·ªó h·ªïng
Secret detection					TruffleHog, GitLeaks						Ki·ªÉm tra m√£ ch·ª©a credentials/ng·∫´u nhi√™n ƒë·ªÉ tr√°nh r√≤ r·ªâ



# V√≠ d·ª• CI : Java Spring + Github Action +  SonarQube 

				name: CI Pipeline
				
				on: [push, pull_request]
				
				jobs:
				build-test-analyze:
					runs-on: ubuntu-latest
				
					steps:
					- name: Checkout source
						uses: actions/checkout@v3
				
					- name: Set up JDK 17
						uses: actions/setup-java@v3
						with:
						java-version: '17'
						distribution: 'temurin'
				
					- name: Cache Maven packages
						uses: actions/cache@v3
						with:
						path: ~/.m2
						key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
						restore-keys: |
							${{ runner.os }}-maven-
				
					- name: Run unit tests with coverage
						run: mvn clean verify
				
					- name: SonarQube scan
						env:
						SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
						run: mvn sonar:sonar -Dsonar.projectKey=myproject \
											-Dsonar.host.url=https://sonarcloud.io \
											-Dsonar.login=$SONAR_TOKEN
				




# ƒê·∫∑t Code Quality Gate ƒë·ªÉ ch·∫∑n Merge 

B·∫°n c·∫ßn enfoce quy t·∫Øc  
	PR kh√¥ng ƒë·∫°t coverage t·ªëi thi·ªÉu(v√≠ d·ª• < 90%) -> kh√¥ng cho merge 
	PR c√≥ blocker issues t·ª´ SonarQube -> reject 
	
	GitHub Actions c√≥ th·ªÉ t√≠ch h·ª£p v·ªõi SonarCloud, GitHub PR s·∫Ω hi·ªán ƒë·ªè n·∫øu kh√¥ng qua. 



# Code quality kh√¥ng c√≥ √Ω nghƒ©a n·∫øu : 
	- Kh√¥ng g·∫Øn v√†o Pull Request 
	- Kh√¥ng bu·ªôc pass tr∆∞·ªõc khi merge 
	- Kh√¥ng ai ƒë·ªçc ho·∫∑c h√†nh ƒë·ªông theo report 
	N√™n x√¢y c·∫£ dashboard code quality cho team ho·∫∑c g·ª≠i report h√†ng tu·∫ßn qua Slack/Email.
	

# B·∫£o m·∫≠t & Qu√©t th∆∞ vi·ªán  


Lo·∫°i ki·ªÉm tra		C√¥ng c·ª•										Ghi ch√∫
Dependency check	OWASP Dependency Check					C√≥ plugin Maven
Secret detection	GitLeaks, TruffleHog					D√πng GitHub hook ƒë·ªÉ ch·∫∑n commit ch·ª©a API Key
Container scan		Trivy, Clair							Qu√©t image Docker



# V√≠ d·ª• CI pipeline ho√†n ch·ªânh Java Spring Boot d√πng GitHub Actions, bao g·ªìm: 

		- Build & test
		- SonarQube static analysis
		- Test coverage
		- Secret scan
		- Dependency vulnerability scan


	## Y√™u c·∫ßu 
		### 1. SonarQube (Self-host ho·∫∑c SonarCloud) 
			N·∫øu self-host SonarQube: c·∫ßn ƒë·ªãa ch·ªâ http://your-sonarqube-host + SONAR_TOKEN trong GitHub Secrets.
			N·∫øu d√πng SonarCloud (public project, mi·ªÖn ph√≠): t·∫°o t√†i kho·∫£n t·∫°i sonarcloud.io 
			
		### 2. GitHub Secrets 
			T·∫°o c√°c secrets trong GitHub repo:
		
			T√™n secret					√ù nghƒ©a
			SONAR_TOKEN				Token t·ª´ SonarQube ho·∫∑c SonarCloud
			GITHUB_TOKEN			T·ª± ƒë·ªông c√≥ s·∫µn, kh√¥ng c·∫ßn t·∫°o


	## ‚úÖ PIPELINE FULL CI ‚Äì ci.yml 
		
				name: Full CI Pipeline
				
				on: [push, pull_request]
				
				jobs:
				ci:
					name: Build & Test & Quality
					runs-on: ubuntu-latest
				
					steps:
					- name: Checkout code
						uses: actions/checkout@v3
				
					- name: Set up JDK 17
						uses: actions/setup-java@v3
						with:
						java-version: '17'
						distribution: 'temurin'
				
					- name: Cache Maven packages
						uses: actions/cache@v3
						with:
						path: ~/.m2
						key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
						restore-keys: |
							${{ runner.os }}-maven-
				
					- name: Run tests & coverage
						run: mvn clean verify
				
					- name: Run SonarQube analysis
						env:
						SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
						run: |
						mvn sonar:sonar \
							-Dsonar.projectKey=my_project \
							-Dsonar.host.url=https://sonarcloud.io \
							-Dsonar.login=${{ secrets.SONAR_TOKEN }}
				
					- name: Secret scanning (GitLeaks)
						uses: gitleaks/gitleaks-action@v2
						with:
						config-path: .gitleaks.toml
				
					- name: Dependency check (OWASP)
						uses: dependency-check/Dependency-Check_Action@main
						with:
						project: 'spring-boot-app'
						path: '.'
						format: 'HTML'
						output-directory: 'reports'
				
					- name: Upload dependency report
						uses: actions/upload-artifact@v3
						with:
						name: dependency-report
						path: reports

	## Ghi ch√∫ 
			B·∫°n b·∫Øt bu·ªôc ph·∫£i d√πng coverage plugin nh∆∞ JaCoCo n·∫øu mu·ªën SonarQube report coverage.
			C·∫ßn file sonar-project.properties n·∫øu kh√¥ng d√πng Maven plugin.
			ƒê·∫∑t quality gate trong SonarCloud/SonarQube ƒë·ªÉ ch·∫∑n merge n·∫øu c√≥ l·ªói.
			
			
	## 	TH√äM B·∫¢O M·∫¨T 
	
		Qu√©t image Docker d√πng Aqua Security Trivy.
		Check dependency b·∫£n quy·ªÅn v·ªõi FOSSA, n·∫øu l√†m s·∫£n ph·∫©m th∆∞∆°ng m·∫°i.
			
			
		‚è≠Ô∏è B∆Ø·ªöC TI·∫æP THEO
		B·∫°n c√≥ mu·ªën t√¥i vi·∫øt lu√¥n pom.xml ƒë·ªÉ t√≠ch h·ª£p v·ªõi SonarQube + JaCoCo + OWASP Dependency Plugin kh√¥ng? Ho·∫∑c t·∫°o c·∫£ pipeline deploy staging/prod sau CI?	
			
			
			
</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>