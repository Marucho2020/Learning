<html><head><title>Lesson 114 == Concurrent RB-Tree ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 114 -- Concurrent RB-Tree -//</h1><pre># KhÃ¡i niá»‡m 
	Concurrent RB-Tree lÃ  má»™t phiÃªn báº£n cá»§a Red-Black Tree (RB-Tree) â€“ má»™t loáº¡i cÃ¢y tÃ¬m kiáº¿m nhá»‹ phÃ¢n tá»± cÃ¢n báº±ng â€“ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ há»— trá»£ truy cáº­p Ä‘á»“ng thá»i tá»« nhiá»u luá»“ng (threads) trong mÃ´i trÆ°á»ng Ä‘a luá»“ng. RB-Tree thÃ´ng thÆ°á»ng Ä‘Ã£ Ä‘áº£m báº£o hiá»‡u suáº¥t tá»‘i Æ°u vá»›i Ä‘á»™ phá»©c táº¡p thá»i gian O(log n) cho cÃ¡c thao tÃ¡c nhÆ° tÃ¬m kiáº¿m, chÃ¨n vÃ  xÃ³a nhá» cÃ¡c quy táº¯c cÃ¢n báº±ng nghiÃªm ngáº·t (sá»­ dá»¥ng mÃ u Ä‘á»-Ä‘en vÃ  cÃ¡c phÃ©p quay). Concurrent RB-Tree má»Ÿ rá»™ng kháº£ nÄƒng nÃ y báº±ng cÃ¡ch bá»• sung cÃ¡c cÆ¡ cháº¿ Ä‘á»“ng bá»™ hÃ³a, cho phÃ©p nhiá»u luá»“ng Ä‘á»c vÃ  ghi vÃ o cÃ¢y má»™t cÃ¡ch an toÃ n vÃ  hiá»‡u quáº£ mÃ  khÃ´ng lÃ m há»ng cáº¥u trÃºc hoáº·c dá»¯ liá»‡u.
	
	
# 2. Táº¡i sao cáº§n Concurrent RB-Tree?

	Trong cÃ¡c á»©ng dá»¥ng Ä‘a luá»“ng, náº¿u khÃ´ng cÃ³ cÆ¡ cháº¿ Ä‘á»“ng bá»™ hÃ³a, viá»‡c nhiá»u luá»“ng cÃ¹ng truy cáº­p má»™t RB-Tree cÃ³ thá»ƒ dáº«n Ä‘áº¿n:
	
		- Race conditions: CÃ¡c luá»“ng can thiá»‡p láº«n nhau, gÃ¢y ra káº¿t quáº£ khÃ´ng chÃ­nh xÃ¡c.
		- Deadlocks: CÃ¡c luá»“ng chá» Ä‘á»£i nhau vÃ´ thá»i háº¡n.
		- Inconsistencies: Cáº¥u trÃºc cÃ¢y bá»‹ phÃ¡ vá»¡ do cÃ¡c thao tÃ¡c Ä‘á»“ng thá»i xung Ä‘á»™t.
		
	Concurrent RB-Tree giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t Ä‘á»“ng bá»™ hÃ³a nhÆ° khÃ³a (locking) hoáº·c cÃ¡c phÆ°Æ¡ng phÃ¡p khÃ´ng khÃ³a (lock-free), Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n vÃ  toÃ n váº¹n dá»¯ liá»‡u trong khi váº«n duy trÃ¬ hiá»‡u suáº¥t cao.
	
	
# 	3. CÃ¡c phÆ°Æ¡ng phÃ¡p triá»ƒn khai Concurrent RB-Tree
	CÃ³ má»™t sá»‘ cÃ¡ch tiáº¿p cáº­n Ä‘á»ƒ triá»ƒn khai tÃ­nh Ä‘á»“ng thá»i cho RB-Tree, má»—i cÃ¡ch cÃ³ Æ°u vÃ  nhÆ°á»£c Ä‘iá»ƒm riÃªng:
	
	
	## a. KhÃ³a toÃ n bá»™ cÃ¢y (Locking the entire tree)
	
		- CÃ¡ch hoáº¡t Ä‘á»™ng: Khi má»™t luá»“ng thá»±c hiá»‡n thao tÃ¡c (Ä‘á»c hoáº·c ghi), nÃ³ khÃ³a toÃ n bá»™ cÃ¢y, hoÃ n thÃ nh thao tÃ¡c, rá»“i má»Ÿ khÃ³a.
		- Æ¯u Ä‘iá»ƒm: ÄÆ¡n giáº£n, dá»… triá»ƒn khai, Ä‘áº£m báº£o an toÃ n.
		- NhÆ°á»£c Ä‘iá»ƒm: Hiá»‡u suáº¥t kÃ©m vÃ¬ má»i thao tÃ¡c bá»‹ tuáº§n tá»± hÃ³a, ngay cáº£ khi chÃºng tÃ¡c Ä‘á»™ng Ä‘áº¿n cÃ¡c pháº§n khÃ¡c nhau cá»§a cÃ¢y.

	
	## b. KhÃ³a tinh vi (Fine-grained locking)
	
		-CÃ¡ch hoáº¡t Ä‘á»™ng: Chá»‰ khÃ³a cÃ¡c nÃºt hoáº·c cÃ¡c pháº§n nhá» cá»§a cÃ¢y cáº§n thiáº¿t cho thao tÃ¡c, thay vÃ¬ khÃ³a toÃ n bá»™ cÃ¢y.
		-Æ¯u Ä‘iá»ƒm: Cho phÃ©p nhiá»u luá»“ng hoáº¡t Ä‘á»™ng Ä‘á»“ng thá»i trÃªn cÃ¡c vÃ¹ng khÃ¡c nhau cá»§a cÃ¢y, cáº£i thiá»‡n hiá»‡u suáº¥t.
		-NhÆ°á»£c Ä‘iá»ƒm: Phá»©c táº¡p hÆ¡n, Ä‘Ã²i há»i quáº£n lÃ½ khÃ³a cáº©n tháº­n Ä‘á»ƒ trÃ¡nh deadlock.
	
	
	## c. Thuáº­t toÃ¡n khÃ´ng khÃ³a (Lock-free hoáº·c wait-free)
	
		- CÃ¡ch hoáº¡t Ä‘á»™ng: Sá»­ dá»¥ng cÃ¡c phÃ©p toÃ¡n nguyÃªn tá»­ (atomic operations) Ä‘á»ƒ cáº­p nháº­t cÃ¢y mÃ  khÃ´ng cáº§n khÃ³a, Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘á»“ng thá»i.
		- Æ¯u Ä‘iá»ƒm: Hiá»‡u suáº¥t cao, khÃ´ng bá»‹ táº¯c ngháº½n bá»Ÿi khÃ³a.
		- NhÆ°á»£c Ä‘iá»ƒm: Ráº¥t phá»©c táº¡p Ä‘á»ƒ triá»ƒn khai vÃ  khÃ³ Ä‘áº£m báº£o tÃ­nh Ä‘Ãºng Ä‘áº¯n.
	
	Trong thá»±c táº¿, fine-grained locking lÃ  phÆ°Æ¡ng phÃ¡p phá»• biáº¿n cho Concurrent RB-Tree vÃ¬ nÃ³ cÃ¢n báº±ng giá»¯a hiá»‡u suáº¥t vÃ  Ä‘á»™ phá»©c táº¡p.
	
	
# 	4. Triá»ƒn khai Fine-Grained Locking trong Concurrent RB-Tree

	DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡ch triá»ƒn khai Concurrent RB-Tree sá»­ dá»¥ng fine-grained locking vá»›i reader-writer locks (khÃ³a Ä‘á»c-ghi), má»™t ká»¹ thuáº­t cho phÃ©p nhiá»u luá»“ng Ä‘á»c Ä‘á»“ng thá»i nhÆ°ng chá»‰ má»™t luá»“ng ghi táº¡i má»™t thá»i Ä‘iá»ƒm.
	
	## a. Thao tÃ¡c tÃ¬m kiáº¿m (Search)
		Má»¥c tiÃªu: Äá»c dá»¯ liá»‡u tá»« cÃ¢y mÃ  khÃ´ng thay Ä‘á»•i cáº¥u trÃºc.
		
		CÃ¡ch thá»±c hiá»‡n 
			Má»—i nÃºt trong cÃ¢y Ä‘Æ°á»£c gáº¯n má»™t khÃ³a Ä‘á»c-ghi.
			
			Khi duyá»‡t cÃ¢y, luá»“ng sá»­ dá»¥ng khÃ³a chia sáº» (shared lock) trÃªn tá»«ng nÃºt:
				- KhÃ³a nÃºt hiá»‡n táº¡i á»Ÿ cháº¿ Ä‘á»™ chia sáº».
				- XÃ¡c Ä‘á»‹nh nÃºt con tiáº¿p theo cáº§n truy cáº­p.
				- KhÃ³a nÃºt con á»Ÿ cháº¿ Ä‘á»™ chia sáº».
				- Má»Ÿ khÃ³a nÃºt hiá»‡n táº¡i vÃ  chuyá»ƒn sang nÃºt con.
			QuÃ¡ trÃ¬nh nÃ y Ä‘Æ°á»£c gá»i lÃ  hand-over-hand locking (khÃ³a tay qua tay).
			
		Lá»£i Ã­ch: Nhiá»u luá»“ng cÃ³ thá»ƒ tÃ¬m kiáº¿m Ä‘á»“ng thá»i trÃªn cÃ¡c nhÃ¡nh khÃ¡c nhau, miá»…n lÃ  khÃ´ng cÃ³ thao tÃ¡c ghi can thiá»‡p.



	## b. Thao tÃ¡c chÃ¨n (Insertion)	
		Má»¥c tiÃªu: ChÃ¨n má»™t nÃºt má»›i vÃ  cÃ¢n báº±ng láº¡i cÃ¢y náº¿u cáº§n.
		CÃ¡ch thá»±c hiá»‡n:
		
		- TÃ¬m vá»‹ trÃ­ chÃ¨n: Duyá»‡t cÃ¢y báº±ng khÃ³a chia sáº» Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vá»‹ trÃ­ chÃ¨n.
		- ChÃ¨n nÃºt: Khi Ä‘áº¿n vá»‹ trÃ­, chuyá»ƒn sang khÃ³a Ä‘á»™c quyá»n (exclusive lock) trÃªn nÃºt cha vÃ  cÃ¡c nÃºt liÃªn quan Ä‘á»ƒ chÃ¨n nÃºt má»›i (thÆ°á»ng lÃ  má»™t nÃºt lÃ¡ Ä‘á»).
		- CÃ¢n báº±ng cÃ¢y: Náº¿u cáº§n thá»±c hiá»‡n phÃ©p quay hoáº·c Ä‘á»•i mÃ u Ä‘á»ƒ duy trÃ¬ tÃ­nh cháº¥t RB-Tree:
		- KhÃ³a Ä‘á»™c quyá»n cÃ¡c nÃºt liÃªn quan (thÆ°á»ng lÃ  3 nÃºt trong má»™t phÃ©p quay: nÃºt pivot, cha vÃ  con).
		- Thá»±c hiá»‡n phÃ©p quay hoáº·c Ä‘á»•i mÃ u.
		- Má»Ÿ khÃ³a sau khi hoÃ n táº¥t.
		- LÆ°u Ã½: CÃ¡c phÃ©p quay vÃ  Ä‘á»•i mÃ u trong RB-Tree lÃ  cá»¥c bá»™, nÃªn chá»‰ cáº§n khÃ³a má»™t sá»‘ lÆ°á»£ng nhá» nÃºt.
	
	
	
	## c. Thao tÃ¡c xÃ³a (Deletion)
	
		Má»¥c tiÃªu: XÃ³a má»™t nÃºt vÃ  cÃ¢n báº±ng láº¡i cÃ¢y.
		CÃ¡ch thá»±c hiá»‡n: TÆ°Æ¡ng tá»± nhÆ° chÃ¨n, nhÆ°ng liÃªn quan Ä‘áº¿n viá»‡c:
		
			KhÃ³a Ä‘á»™c quyá»n cÃ¡c nÃºt trÃªn Ä‘Æ°á»ng Ä‘i Ä‘áº¿n nÃºt cáº§n xÃ³a.
			XÃ³a nÃºt vÃ  thá»±c hiá»‡n cÃ¡c bÆ°á»›c cÃ¢n báº±ng (phÃ©p quay, Ä‘á»•i mÃ u) vá»›i khÃ³a Ä‘á»™c quyá»n trÃªn cÃ¡c nÃºt liÃªn quan.


# 	5. Xá»­ lÃ½ cÃ¡c váº¥n Ä‘á» Ä‘á»“ng thá»i
	
	## a. Deadlock
		Váº¥n Ä‘á»: Náº¿u hai luá»“ng khÃ³a cÃ¡c nÃºt theo thá»© tá»± khÃ¡c nhau, chÃºng cÃ³ thá»ƒ rÆ¡i vÃ o tráº¡ng thÃ¡i chá» Ä‘á»£i láº«n nhau (deadlock).
		Giáº£i phÃ¡p: LuÃ´n khÃ³a cÃ¡c nÃºt theo thá»© tá»± tá»« trÃªn xuá»‘ng (tá»« gá»‘c Ä‘áº¿n lÃ¡), Ä‘áº£m báº£o táº¥t cáº£ luá»“ng tuÃ¢n theo cÃ¹ng má»™t quy táº¯c.
	
	## b. Contention (Xung Ä‘á»™t khÃ³a) 
		VÃ¬ RB-Tree cÃ³ chiá»u cao logarithmic (O(log n)), sá»‘ lÆ°á»£ng nÃºt cáº§n khÃ³a trong má»—i thao tÃ¡c lÃ  nhá», giáº£m thiá»ƒu xung Ä‘á»™t giá»¯a cÃ¡c luá»“ng.
		CÃ¡c thao tÃ¡c trÃªn cÃ¡c nhÃ¡nh khÃ¡c nhau hiáº¿m khi chá»“ng láº¥p, Ä‘áº·c biá»‡t trong cÃ¢y lá»›n.
	
	
	## c. CÃ¢n báº±ng Ä‘á»“ng thá»i 
	
		CÃ¡c thao tÃ¡c cÃ¢n báº±ng trong RB-Tree (phÃ©p quay, Ä‘á»•i mÃ u) chá»‰ áº£nh hÆ°á»Ÿng Ä‘áº¿n má»™t sá»‘ lÆ°á»£ng nhá» nÃºt cá»¥c bá»™.
		
		Báº±ng cÃ¡ch khÃ³a cÃ¡c nÃºt liÃªn quan trong quÃ¡ trÃ¬nh cÃ¢n báº±ng, cÃ¢y váº«n duy trÃ¬ Ä‘Æ°á»£c tÃ­nh cháº¥t Ä‘á»-Ä‘en ngay cáº£ khi cÃ³ nhiá»u luá»“ng hoáº¡t Ä‘á»™ng. 
		
		
	
	
# 	6. Æ¯u Ä‘iá»ƒm cá»§a Concurrent RB-Tree 
	- Hiá»‡u suáº¥t cao: Cho phÃ©p nhiá»u luá»“ng truy cáº­p Ä‘á»“ng thá»i trÃªn cÃ¡c pháº§n khÃ¡c nhau cá»§a cÃ¢y, tá»‘i Æ°u cho táº£i Ä‘á»c náº·ng (read-heavy workloads).
	- CÃ¢n báº±ng: Duy trÃ¬ Ä‘á»™ phá»©c táº¡p O(log n) nhá» tÃ­nh cháº¥t tá»± cÃ¢n báº±ng cá»§a RB-Tree.
	- An toÃ n: Äáº£m báº£o toÃ n váº¹n dá»¯ liá»‡u vÃ  tÃ­nh nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘a luá»“ng.
	- Kháº£ nÄƒng má»Ÿ rá»™ng: PhÃ¹ há»£p vá»›i cÃ¡c á»©ng dá»¥ng lá»›n nhá» giáº£m thiá»ƒu vÃ¹ng bá»‹ khÃ³a.
	
	
# 	7. CÃ¡c triá»ƒn khai nÃ¢ng cao (TÃ¹y chá»n) 
	
	Lock-free RB-Tree: Sá»­ dá»¥ng cÃ¡c phÃ©p toÃ¡n nguyÃªn tá»­ Ä‘á»ƒ loáº¡i bá» khÃ³a, cáº£i thiá»‡n hiá»‡u suáº¥t nhÆ°ng phá»©c táº¡p hÆ¡n nhiá»u.
	
	Transactional Memory: Dá»±a vÃ o pháº§n cá»©ng hoáº·c pháº§n má»m há»— trá»£ giao dá»‹ch Ä‘á»ƒ quáº£n lÃ½ Ä‘á»“ng thá»i, giáº£m gÃ¡nh náº·ng láº­p trÃ¬nh nhÆ°ng Ã­t phá»• biáº¿n hÆ¡n.
	
	
	

# Káº¿t luáº­n 
	
Concurrent RB-Tree lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u máº¡nh máº½, káº¿t há»£p tÃ­nh tá»± cÃ¢n báº±ng cá»§a Red-Black Tree vá»›i cÃ¡c cÆ¡ cháº¿ Ä‘á»“ng bá»™ hÃ³a tinh vi Ä‘á»ƒ há»— trá»£ truy cáº­p Ä‘á»“ng thá»i an toÃ n vÃ  hiá»‡u quáº£ trong cÃ¡c á»©ng dá»¥ng Ä‘a luá»“ng. PhÆ°Æ¡ng phÃ¡p fine-grained locking vá»›i reader-writer locks lÃ  cÃ¡ch tiáº¿p cáº­n phá»• biáº¿n, cho phÃ©p nhiá»u luá»“ng Ä‘á»c Ä‘á»“ng thá»i vÃ  thá»±c hiá»‡n cÃ¡c thao tÃ¡c ghi má»™t cÃ¡ch an toÃ n thÃ´ng qua viá»‡c khÃ³a cá»¥c bá»™ cÃ¡c nÃºt liÃªn quan. Vá»›i chiá»u cao logarithmic vÃ  kháº£ nÄƒng giáº£m thiá»ƒu xung Ä‘á»™t, Concurrent RB-Tree lÃ  lá»±a chá»n lÃ½ tÆ°á»Ÿng cho cÃ¡c há»‡ thá»‘ng yÃªu cáº§u lÆ°u trá»¯ dá»¯ liá»‡u cÃ³ thá»© tá»±, hiá»‡u suáº¥t cao vÃ  kháº£ nÄƒng má»Ÿ rá»™ng trong mÃ´i trÆ°á»ng Ä‘a luá»“ng.
	
	
	
</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>