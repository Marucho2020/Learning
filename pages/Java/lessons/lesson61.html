<html><head><title>Lesson 61 == Protocol Buffer ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 61 -- Protocol Buffer -//</h1><pre>	Protocol Buffer (Protobuf) lÃ  má»™t ngÃ´n ngá»¯ Ä‘á»‹nh dáº¡ng dá»¯ liá»‡u do Google phÃ¡t triá»ƒn, Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ serialize dá»¯ liá»‡u nhanh, nháº¹ vÃ  hiá»‡u quáº£ hÆ¡n so vá»›i JSON hoáº·c XML . NÃ³ lÃ  lá»±a chá»n máº·c Ä‘á»‹nh cho gRPC vÃ  ráº¥t phá»• biáº¿n trong cÃ¡c há»‡ thá»‘ng phÃ¢n tÃ¡n. 
	


CÃº phÃ¡p						Vai trÃ²
int32					Kiá»ƒu sá»‘ nguyÃªn 32-bit
string					Kiá»ƒu chuá»—i UTF-8
bool					Kiá»ƒu boolean
message					Kiá»ƒu dá»¯ liá»‡u tá»± Ä‘á»‹nh nghÄ©a (custom type)



	
# Khai bÃ¡o phiÃªn báº£n (syntax)	
	
	syntax = "proto3"	; 	// Chá»n phiÃªn báº£n proto3 
	
	
		proto2 (cÅ© , há»— trá»£ required , toptinal , default values)
		proto3 (má»›i , Ä‘Æ¡n giáº£n hÃ³a, tá»± Ä‘á»™ng cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh)
		
		
		
# Package vÃ  Import 

	package mypackage ; 		// GiÃºp phÃ¢n loáº¡i code , trÃ¡nh trÃ¹ng láº·p 
	
	import "google/protobuf/timestamp.proto";	//Import thÆ° viá»‡n ngoÃ i 
	
		package  : giÃºp trÃ¡nh trÃ¹ng tÃªn giá»¯a cÃ¡c file .proto 
		import   : giÃºp sá»­ dá»¥ng cÃ¡c message Ä‘á»‹nh nghÄ©a sáºµn 
		
		
# Message (Äá»‹nh nghÄ©a cáº¥u trÃºc dá»¯ liá»‡u ) 
	
	message Person{
		string name = 1;
		int32 age = 2;
		bool isStudent = 3;
	}
		
		## LÆ°u Ã½ : 
			Má»—i field cÃ³ má»™t sá»‘ thá»© tá»± duy nháº¥t (1,2,3 ...)
			SÃ´ thá»© tá»± khÃ´ng Ä‘Æ°á»£c thay Ä‘á»•i sau khi deploy (trÃ¡nh lá»—i khi deserialize)
			
			
	
# Kiá»ƒu dá»¯ liá»‡u trong protobuf 

		Kiá»ƒu dá»¯ liá»‡u				KÃ­ch thÆ°á»›c					MiÃªu táº£
		double						8 byte				Sá»‘ thá»±c
		float						4 byte				Sá»‘ thá»±c
		int32						4 byte				Sá»‘ nguyÃªn
		int64						8 byte				Sá»‘ nguyÃªn
		uint32						4 byte				Sá»‘ nguyÃªn khÃ´ng dáº¥u
		uint64						8 byte				Sá»‘ nguyÃªn khÃ´ng dáº¥u
		sint32						4 byte				Sá»‘ nguyÃªn cÃ³ dáº¥u (tá»‘i Æ°u)
		sint64						8 byte				Sá»‘ nguyÃªn cÃ³ dáº¥u (tá»‘i Æ°u)
		fixed32						4 byte				Sá»‘ nguyÃªn cá»‘ Ä‘á»‹nh
		fixed64						8 byte				Sá»‘ nguyÃªn cá»‘ Ä‘á»‹nh
		sfixed32					4 byte				Sá»‘ nguyÃªn cÃ³ dáº¥u cá»‘ Ä‘á»‹nh
		sfixed64					8 byte				Sá»‘ nguyÃªn cÃ³ dáº¥u cá»‘ Ä‘á»‹nh
		bool						1 bit				True/False
		string						Variable			Chuá»—i UTF-8
		bytes						Variable			Chuá»—i nhá»‹ phÃ¢n	


# Enum 
	
	enum Status {
		
		UNKNOWN = 0 ;
		ACTIVE = 1;
		INACTIVE = 2;
	}
	
	message User {
		string name = 1;
		Status status = 2;
	}


	ğŸ’¡ LÆ°u Ã½: 
		Enum pháº£i cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh lÃ  0
		GiÃ¡ trá»‹ trong enum pháº£i lÃ  sá»‘ nguyÃªn  
		


# Nested Message (Message lá»“ng nhau)
	
	message Address {
		string street = 1;
		string city = 2;
	}

	message Person {
		string name = 1;
		Address address = 2; 	// Message bÃªn trong message
	
	}



# Repeated Fields (Danh sÃ¡ch )
	
	message Classroom{
		repeated string students = 1 	// danh sÃ¡ch há»c sinh 
	}

	ğŸ’¡ LÆ°u Ã½: 
		KhÃ´ng cÃ³ List hay Array, chá»‰ cÃ³ repeated 


#	 Map  
	
	message PhoneBook {
		map<string,string> contacts = 1;
	}

	ğŸ’¡ LÆ°u Ã½: 
		KeyType chá»‰ cÃ³ thá»ƒ lÃ  string, int32 , int64 , bool 
		ValueType cÃ³ thá»ƒ lÃ  báº¥t ká»³ kiá»ƒu nÃ o 
		
		
		
# Optional Fields (trÆ°á»ng khÃ´ng bÃ¡t buá»™c )	

	message Product {
		string name = 1;
		optional double price = 2;
	}
		
		ğŸ’¡ LÆ°u Ã½: 
			Tá»« Protobuf 3.15+ optional cho phÃ©p kiá»ƒm tra má»™t field cÃ³ tá»“n táº¡i hay khÃ´ng 


# Oneof (Union Field - Chá»‰ má»™t field tá»“n táº¡i táº¡i má»™t thá»i Ä‘iá»ƒm)
	
	message Response {
		oneof result {
			string successMessage = 1;
			string errorMessage = 2;
		}
	}
	
		ğŸ’¡ Chá»‰ cÃ³ thá»ƒ set má»™t field trong oneof, náº¿u set field khÃ¡c thÃ¬ field cÅ© sáº½ bá»‹ ghi Ä‘Ã¨ . 
		
		
# Bytes (LÆ°u dá»¯ liá»‡u nhá»‹ phÃ¢n)	
	
	message File{
		string name = 1;
		bytes = content 2;
	}


# Dá»‹ch vá»¥ gRPC  (Service )

	service Greeter {
		rpc SayHello (Hello Request) returns (HelloResponse);
	}
	
	message HelloRequest {
		string name = 1;
	}
	
	message HelloResponse{
		string message = 1;
	}
	
		ğŸ’¡ LÆ°u Ã½: 
			rpc khai bÃ¡o má»™t phÆ°Æ¡ng thá»©c tá»« xa 
			SayHello nháº­n HelloRequest vÃ  tráº£ vá» HelloResponse



# Reserved (dá»± trá»¯ sá»‘ ID hoáº·c tÃªn field)
	message User {
		reserved 2,3;						// khÃ´ng cho phÃ©p dÃ¹ng sá»‘ thá»© tá»± 2, 3 
		reserved "old_name";				// khÃ´ng cho phÃ©p dÃ¹ng tÃªn cÅ© 
	}


# Extensions (Má»Ÿ rá»™ng message - chá»‰ cÃ³ trong proto2 )	
	extend User {
		optional string email = 100;
	}
	
	ğŸ’¡ Chá»‰ cÃ³ trong proto2, bá»‹ loáº¡i bá» trong proto3.



# ThÆ° viá»‡n Google Well-Known Types 
	import "google/protobuf/timestamp.proto";
	import "google/protobuf/duration.proto";
	
	message Event {
	string name = 1;
	google.protobuf.Timestamp start_time = 2;
	google.protobuf.Duration duration = 3;
	}



# Sinh code Java tá»« file Protobuf 

	protoc --java_out=. your_file.proto
 
	// náº¿u dÃ¹ng vá»›i gRPC 
	\protoc --java_out=. --grpc-java_out=. your_file.proto

ğŸ¯ Káº¿t Luáº­n
âœ” ÄÃ¢y lÃ  toÃ n bá»™ cÃ¡ch viáº¿t cá»§a ngÃ´n ngá»¯ Protocol Buffers.
âœ” NÃ³ tá»‘i Æ°u hÃ³a viá»‡c serialize dá»¯ liá»‡u so vá»›i JSON/XML.
âœ” TÃ­ch há»£p máº¡nh vá»›i gRPC Ä‘á»ƒ giao tiáº¿p giá»¯a cÃ¡c microservices.
âœ” Há»— trá»£ nhiá»u kiá»ƒu dá»¯ liá»‡u nÃ¢ng cao nhÆ° oneof, map, optional.

</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>