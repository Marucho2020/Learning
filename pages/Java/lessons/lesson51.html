<html><head><title>Lesson 51 == == Externalizable ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 51 -- -- Externalizable -//</h1><pre># Kh√°i ni·ªám 
	Externalizable l√† m·ªôt interface n√¢ng cao c·ªßa Serializable, cho ph√©p b·∫°n t·ª± ki·ªÉm so√°t ho√†n to√†n qu√° tr√¨nh serialize(chuy·ªÉn obj th√†nh byte stream) v√† deserialize(chuy·ªÉn byte stream th√†nh object) . ƒêi·ªÅu n√†y gi√∫p ti·∫øt ki·ªám dung l∆∞·ª£ng, c·∫£i thi·ªán hi·ªáu su·∫•t v√† cho ph√©p t√πy ch·ªânh d·ªØ li·ªáu khi l∆∞u tr·ªØ. 
	
	+> Externalizable l√† m·ªôt interface thu·ªôc package java.io 
	+> N√≥ m·ªü r·ªông (extends) Serializable, nh∆∞ng kh√¥ng ph·∫£i l√† marker interface (Kh√°c v·ªõi Serializable )
	+> Y√™u c·∫ßu class override v√† t·ª± ƒë·ªãnh nghƒ©a c√°ch stream d·ªØ li·ªáu b·∫±ng 2 ph∆∞∆°ng th·ª©c  
					-   writeExternal(ObjectOutput out)				: X√°c ƒë·ªãnh c√°ch object ƒë∆∞·ª£c ghi ra file/stream	 
					-	readExternal(ObjectInput in)				: X√°c ƒë·ªãnh c√°ch object  ƒë∆∞·ª£c ƒë·ªçc t·ª´ file/stream
					
					
# C√°ch s·ª≠ d·ª•ng Externalizable 
	
	## Khai b√°o class v√† implements Externalizable  
	
		import java.io.*;
		class Person implements Externalizable {
			private String name;
			private int age;
		
			// B·∫Øt bu·ªôc c√≥ constructor kh√¥ng tham s·ªë
			public Person() {}
		
			public Person(String name, int age) {
				this.name = name;
				this.age = age;
			}
		
			// Ghi d·ªØ li·ªáu theo c√°ch t√πy ch·ªânh
			@Override
			public void writeExternal(ObjectOutput out) throws IOException {
				out.writeUTF(name);
				out.writeInt(age);
			}
		
			// ƒê·ªçc d·ªØ li·ªáu theo c√°ch t√πy ch·ªânh
			@Override
			public void readExternal(ObjectInput in) throws IOException {
				name = in.readUTF();
				age = in.readInt();
			}
		
			@Override
			public String toString() {
				return "Person{name='" + name + "', age=" + age + "}";
			}
		}


	## Serialize ƒë·ªëi t∆∞·ª£ng v·ªõi Externalizable 
	
		public class ExternalizableWriteExample {
		public static void main(String[] args) {
			try (ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream("person.ext"))) {
				Person person = new Person("Alice", 25);
				out.writeObject(person);
				System.out.println("Object has been serialized.");
			} catch (IOException e) {
				e.printStackTrace();
			}
		}
	}

	## Deserialize ƒë·ªëi t∆∞·ª£ng v·ªõi Externalizable
		public class ExternalizableReadExample {
		public static void main(String[] args) {
			try (ObjectInputStream in = new ObjectInputStream(new FileInputStream("person.ext"))) {
				Person person = (Person) in.readObject();
				System.out.println("Object has been deserialized: " + person);
			} catch (IOException | ClassNotFoundException e) {
				e.printStackTrace();
			}
		}
	}

# Kh√°c bi·ªát gi·ªØa Serializable v√† Externalizable

	ƒê·∫∑c ƒëi·ªÉm										Serializable									Externalizable
	C√≥ ph·∫£i l√† marker interface kh√¥ng?				‚úÖ C√≥											‚ùå Kh√¥ng
	C·∫ßn khai b√°o ph∆∞∆°ng th·ª©c g√¨?					‚ùå Kh√¥ng c·∫ßn (JVM t·ª± x·ª≠ l√Ω)						‚úÖ writeExternal() v√† readExternal()
	C√≥ ki·ªÉm so√°t ƒë∆∞·ª£c d·ªØ li·ªáu khi serialize kh√¥ng?	‚ùå Kh√¥ng, JVM t·ª± ƒë·ªông serialize					‚úÖ C√≥, ta ph·∫£i t·ª± vi·∫øt code ƒë·ªÉ serialize
	C√≥ c·∫ßn constructor kh√¥ng tham s·ªë kh√¥ng?			‚ùå Kh√¥ng c·∫ßn									‚úÖ B·∫Øt bu·ªôc
	Hi·ªáu su·∫•t										Ch·∫≠m h∆°n do serialize t·∫•t c·∫£ d·ªØ li·ªáu			Nhanh h∆°n v√¨ ch·ªâ serialize d·ªØ li·ªáu c·∫ßn thi·∫øt
	Dung l∆∞·ª£ng file khi serialize					L·ªõn h∆°n v√¨ l∆∞u c·∫£ metadata						Nh·ªè h∆°n n·∫øu t·ªëi ∆∞u
	C√≥ c·∫ßn serialVersionUID kh√¥ng?					‚úÖ N√™n c√≥ ƒë·ªÉ tr√°nh l·ªói							‚ùå Kh√¥ng c·∫ßn v√¨ t·ª± ki·ªÉm so√°t serialization



Khi n√†o n√™n d√πng Externalizable?


- Khi mu·ªën gi·∫£m dung l∆∞·ª£ng file b·∫±ng c√°ch ch·ªâ serialize nh·ªØng field c·∫ßn thi·∫øt.
- Khi mu·ªën tƒÉng t·ªëc ƒë·ªô serialize b·∫±ng c√°ch b·ªè qua metadata kh√¥ng c·∫ßn thi·∫øt.
- Khi d·ªØ li·ªáu c·∫ßn m√£ h√≥a ho·∫∑c x·ª≠ l√Ω ƒë·∫∑c bi·ªát tr∆∞·ªõc khi l∆∞u.




# V√≠ d·ª• n√¢ng cao v·ªÅ Externalizable


			class Employee implements Externalizable {
			private String name;
			private int age;
			private transient double salary; // S·∫Ω kh√¥ng ƒë∆∞·ª£c serialize
		
			public Employee() {}
		
			public Employee(String name, int age, double salary) {
				this.name = name;
				this.age = age;
				this.salary = salary;
			}
		
			@Override
			public void writeExternal(ObjectOutput out) throws IOException {
				out.writeUTF(name);
				out.writeInt(age);
				// Kh√¥ng ghi salary v√†o stream
			}
		
			@Override
			public void readExternal(ObjectInput in) throws IOException {
				name = in.readUTF();
				age = in.readInt();
				// Kh√¥ng ƒë·ªçc salary => salary m·∫∑c ƒë·ªãnh l√† 0.0
			}
		
			@Override
			public String toString() {
				return "Employee{name='" + name + "', age=" + age + ", salary=" + salary + "}";
			}
		}




		Employee emp = new Employee("John", 30, 5000.0);
		serialize(emp);
		Employee deserializedEmp = deserialize();
		System.out.println(deserializedEmp); // Employee{name='John', age=30, salary=0.0}



# M√£ h√≥a d·ªØ li·ªáu khi serialize 
					class SecurePerson implements Externalizable {
						private String name;
						private int age;
					
						public SecurePerson() {}
					
						public SecurePerson(String name, int age) {
							this.name = name;
							this.age = age;
						}
					
						@Override
						public void writeExternal(ObjectOutput out) throws IOException {
							out.writeUTF(encrypt(name)); // M√£ h√≥a t√™n
							out.writeInt(age);
						}
					
						@Override
						public void readExternal(ObjectInput in) throws IOException {
							name = decrypt(in.readUTF()); // Gi·∫£i m√£ t√™n
							age = in.readInt();
						}
					
						private String encrypt(String data) {
							return new StringBuilder(data).reverse().toString(); // ƒê·∫£o ng∆∞·ª£c chu·ªói
						}
					
						private String decrypt(String data) {
							return new StringBuilder(data).reverse().toString(); // ƒê·∫£o ng∆∞·ª£c l·∫°i
						}
					
						@Override
						public String toString() {
							return "SecurePerson{name='" + name + "', age=" + age + "}";
						}
					}


# K·∫øt lu·∫≠n 
						C√¢u h·ªèi																		C√¢u tr·∫£ l·ªùi
		
		Externalizable c√≥ c·∫ßn constructor kh√¥ng tham s·ªë kh√¥ng?						‚úÖ C√≥, n·∫øu kh√¥ng s·∫Ω g·∫∑p java.io.InvalidClassException.
		
		N·∫øu kh√¥ng tri·ªÉn khai writeExternal() v√† readExternal(), ƒëi·ªÅu g√¨ x·∫£y ra?		üõë NotSerializableException.
		
		Khi n√†o n√™n d√πng Externalizable thay v√¨ Serializable?						Khi mu·ªën t·ªëi ∆∞u h√≥a serialize, gi·∫£m dung l∆∞·ª£ng file ho·∫∑c c·∫ßn m√£ h√≥a d·ªØ li·ªáu.
		
		transient c√≥ t√°c d·ª•ng trong Externalizable kh√¥ng?							‚ùå Kh√¥ng, v√¨ ta ph·∫£i t·ª± quy·∫øt ƒë·ªãnh serialize field n√†o.
		
		N·∫øu ch·ªâ ghi m·ªôt ph·∫ßn d·ªØ li·ªáu v√†o writeExternal(), 							‚ùå Kh√¥ng b·ªã l·ªói, nh∆∞ng
		khi deserialize c√≥ b·ªã l·ªói kh√¥ng?
		
		
		==> T√≥m l·∫°i : 
		- Externalizable gi√∫p tƒÉng t·ªëc ƒë·ªô v√† t·ªëi ∆∞u h√≥a serialize.
		
		- Kh√¥ng c√≥ serialVersionUID, n√™n kh√¥ng g·∫∑p l·ªói InvalidClassException n·∫øu class thay ƒë·ªïi.
		
		- Ph√π h·ª£p khi c·∫ßn m√£ h√≥a, ki·ªÉm so√°t d·ªØ li·ªáu ho·∫∑c gi·∫£m k√≠ch th∆∞·ªõc file.
		
		- C·∫ßn c√≥ constructor kh√¥ng tham s·ªë, n·∫øu kh√¥ng s·∫Ω l·ªói khi deserialize.
		
		- N·∫øu c√¢u h·ªèi trong Java Gold c√≥ li√™n quan ƒë·∫øn t·ªëi ∆∞u h√≥a ho·∫∑c ki·ªÉm so√°t serialization, c√¢u tr·∫£ l·ªùi th∆∞·ªùng l√† Externalizable!		


</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>