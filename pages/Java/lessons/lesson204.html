<html><head><title>Lesson 204 == Higher-Order Function ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 204 -- Higher-Order Function -//</h1><pre>
# üîπ 1. T∆∞ duy n·ªÅn t·∫£ng ‚Äî Higher-Order Function l√† g√¨?

	Higher-Order Function (HOF) l√† h√†m nh·∫≠n function kh√°c l√†m tham s·ªë ho·∫∑c tr·∫£ v·ªÅ m·ªôt function m·ªõi.

		Trong OOP, ta ti√™m logic b·∫±ng class/interface.
		Trong Functional, ta ti√™m logic b·∫±ng h√†m.


Function<Integer, Integer> doubleFn = x -> x * 2;
Function<Integer, Integer> squareFn = x -> x * x;

// HOF: h√†m nh·∫≠n function kh√°c v√† b·ªçc th√™m logic
Function<Function<Integer, Integer>, Function<Integer, Integer>> withLogging =
    fn -> x -> {
        System.out.println("Input: " + x);
        Integer result = fn.apply(x);
        System.out.println("Output: " + result);
        return result;
    };

Function<Integer, Integer> loggedDouble = withLogging.apply(doubleFn);
loggedDouble.apply(5); // log input/output

	‚Üí Gi·ªëng h·ªát Decorator pattern, nh∆∞ng functional, ng·∫Øn g·ªçn, kh√¥ng c·∫ßn class.



# üî∏ 2. T·∫°i sao functional c√≥ th·ªÉ ‚Äúthay th·∫ø‚Äù c√°c OOP pattern?

	## 2.1 Strategy Pattern (OOP)

interface PaymentStrategy {
    void pay(Order order);
}
class PaypalPayment implements PaymentStrategy { ... }
class CreditCardPayment implements PaymentStrategy { ... }
	
	‚Üí Qu√° nhi·ªÅu class ch·ªâ ƒë·ªÉ thay ƒë·ªïi logic.



	-> Functional style: 

Consumer<Order> paypal = o -> processPaypal(o);
Consumer<Order> creditCard = o -> processCard(o);

void checkout(Order order, Consumer<Order> strategy) {
    strategy.accept(order);
}

	Ch·ªâ c·∫ßn truy·ªÅn h√†m ‚Äî kh√¥ng c·∫ßn Strategy interface.
	
	
	
	
	
	## 	2.2 Decorator Pattern (OOP)
	
class LoggingService implements Service {
    private final Service delegate;
    public void execute() {
        System.out.println("Start");
        delegate.execute();
        System.out.println("End");
    }
}
	
		-> Functional style:
	
Function<Runnable, Runnable> withLogging =
    fn -> () -> {
        System.out.println("Start");
        fn.run();
        System.out.println("End");
    };

Runnable secured = withLogging.apply(() -> performBusinessLogic());
secured.run();
	
		‚Üí Gi·ªëng h·ªát Decorator nh∆∞ng thu·∫ßn h√†m, kh√¥ng c·∫ßn subclass.
	
	
	
	
	
	
	## 2.3 Template Method Pattern (OOP)
	OOP version:
	
abstract class DataImporter {
    void importData() {
        readSource();
        transform();
        writeTarget();
    }
    abstract void transform();
}
	
	
	Functional version:
	
Runnable importData = () -> {
    readSource();
    transform.apply(data);
    writeTarget();
};
	
	‚Üí Ch·ªâ c·∫ßn ti√™m transform function ‚Äî kh√¥ng c·∫ßn abstract class.
	
	
	


# üîπ 3. Policy Injection = Functional Dependency Injection

	Trong enterprise Java (Spring, Micronaut...), dependency injection d√πng container (IoC) ƒë·ªÉ ti√™m ph·ª• thu·ªôc runtime.

	Nh∆∞ng trong functional, ta ti√™m logic b·∫±ng h√†m ‚Äî compile-time safe, thread-safe, kh√¥ng c·∫ßn container.

	V√≠ d·ª•:

Function<Data, Data> baseLogic = d -> process(d);

Function<Function<Data, Data>, Function<Data, Data>> withTransaction =
    fn -> d -> {
        startTx();
        Data result = fn.apply(d);
        commitTx();
        return result;
    };

Function<Function<Data, Data>, Function<Data, Data>> withLogging =
    fn -> d -> {
        System.out.println("Executing...");
        return fn.apply(d);
    };

Function<Data, Data> secured = withLogging.apply(withTransaction.apply(baseLogic));
secured.apply(new Data());



‚Üí withLogging v√† withTransaction l√† policy injectors.
‚Üí Ta c√≥ th·ªÉ th√™m ho·∫∑c b·ªè policy nh∆∞ lego ‚Äî kh√¥ng c·∫ßn AOP, kh√¥ng c·∫ßn Spring Proxy.



# ‚öôÔ∏è 4. Enterprise Use Cases

| Use Case                    | Functional Policy Injection                                        | OOP Equivalent         |
| --------------------------- | ------------------------------------------------------------------ | ---------------------- |
| **Logging / Auditing**      | `fn -> data -> { log(); return fn(data); }`                        | AOP Aspect             |
| **Transaction Management**  | `fn -> data -> { beginTx(); var r=fn(data); commit(); return r; }` | Spring @Transactional  |
| **Security Context**        | `fn -> user -> checkPermission(user); return fn(user);`            | Interceptor            |
| **Caching Layer**           | `fn -> input -> cache.computeIfAbsent(input, fn)`                  | Proxy Decorator        |
| **Retry / Circuit Breaker** | `fn -> input -> retry(fn, input)`                                  | Resilience4j / Hystrix |

	‚Üí M·ªói policy ch·ªâ l√† m·ªôt function wrapper. Kh√¥ng reflection, kh√¥ng annotation, kh√¥ng runtime proxy.






# üß© 5. K·∫øt h·ª£p HOF v·ªõi Stream & Pipeline
	Ta c√≥ th·ªÉ inject policy tr·ª±c ti·∫øp v√†o functional pipeline:


Function<Employee, Employee> validate = withAudit(withRetry(transform));
employees.stream()
    .filter(isActive)
    .map(validate)
    .forEach(send);


‚Üí To√†n b·ªô policy (audit, retry, transform) ƒë∆∞·ª£c compose th√†nh pipeline.
Kh√¥ng class, kh√¥ng annotation, kh√¥ng magic.


# üß† 6. ∆Øu ƒëi·ªÉm v∆∞·ª£t tr·ªôi c·ªßa Functional HOF Design

| Ti√™u ch√≠             | OOP DI / AOP                 | Functional Policy Injection |
| -------------------- | ---------------------------- | --------------------------- |
| **T√≠nh r√µ r√†ng**     | ·∫®n logic (annotation, proxy) | Minh b·∫°ch, nh√¨n th·∫•y chain  |
| **Testability**      | C·∫ßn mock container           | Test thu·∫ßn h√†m, d·ªÖ stub     |
| **Thread-safety**    | C√≥ th·ªÉ stateful              | Pure function, thread-safe  |
| **Runtime overhead** | Reflection, proxy            | Zero-cost lambda chain      |
| **Reusability**      | Ph·ª• thu·ªôc interface          | Compose nh∆∞ lego            |


# üí° 7. ·ª®ng d·ª•ng th·ª±c t·∫ø

	Spring Cloud Gateway Filter ‚Üí c√≥ th·ªÉ vi·∫øt l·∫°i ho√†n to√†n theo HOF style.
	
	Middleware pipeline trong WebFlux, Micronaut ‚Üí m·ªói filter l√† m·ªôt HOF.
	
	Reactive Policy Injection ‚Üí d√πng Mono.defer(() -> policy.apply(fn)) ƒë·ªÉ inject runtime policy.
	
	Java Security ‚Üí policy-driven authentication/authorization chain (pure functional).


#‚úÖ K·∫øt lu·∫≠n 


| Kh√≠a c·∫°nh                            | HOF ƒëem l·∫°i                   |
| ------------------------------------ | ----------------------------- |
| **Thay th·∫ø class-level abstraction** | B·∫±ng function composition     |
| **Thay th·∫ø DI container**            | B·∫±ng function injection       |
| **Thay th·∫ø AOP proxy**               | B·∫±ng function wrapper         |
| **TƒÉng testability, predictability** | V√¨ pure v√† transparent        |
| **ƒê∆°n gi·∫£n h√≥a enterprise logic**    | Gi·∫£m boilerplate, v·∫´n modular |



</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>