<html><head><title>Lesson 205 == Reactive Stream & Backpressure Pattern ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 205 -- Reactive Stream & Backpressure Pattern -//</h1><pre>
# ğŸ”¹ 1. Reactive Stream lÃ  gÃ¬?
	Reactive Stream lÃ  Functional Pipeline cÃ³ thá»i gian (time dimension) â€” thay vÃ¬ xá»­ lÃ½ má»™t láº§n vá»›i dá»¯ liá»‡u tÄ©nh, ta xá»­ lÃ½ liÃªn tá»¥c vá»›i dá»¯ liá»‡u Ä‘á»™ng.


	NÃ³i ngáº¯n gá»n:
		Stream API trong Java: xá»­ lÃ½ list Ä‘Ã£ cÃ³ sáºµn.
		
		Reactive Stream: xá»­ lÃ½ dÃ²ng dá»¯ liá»‡u sinh ra theo thá»i gian (event, message, sensor data, log...).

	Cá»‘t lÃµi lÃ  4 interface trong java.util.concurrent.Flow (Java 9+):
Publisher<T>
Subscriber<T>
Subscription
Processor<T, R>



# ğŸ”¸ 2. Vai trÃ² tá»«ng thÃ nh pháº§n

| ThÃ nh pháº§n       | Vai trÃ²                       | TÆ°Æ¡ng tá»± OOP / Stream |
| ---------------- | ----------------------------- | --------------------- |
| **Publisher**    | Nguá»“n dá»¯ liá»‡u (emit item)     | Stream source         |
| **Subscriber**   | Nháº­n dá»¯ liá»‡u (consume)        | forEach / Consumer    |
| **Subscription** | KÃªnh káº¿t ná»‘i + Ä‘iá»u tiáº¿t      | Iterator + control    |
| **Processor**    | Vá»«a nháº­n vá»«a phÃ¡t (transform) | map/filter            |


	## VÃ­ dá»¥ Ä‘Æ¡n giáº£n: 
		
SubmissionPublisher<String> publisher = new SubmissionPublisher<>();

publisher.subscribe(new Subscriber<>() {
    public void onSubscribe(Subscription s) {
        s.request(1); // yÃªu cáº§u gá»­i 1 item
    }
    public void onNext(String item) {
        System.out.println("Received: " + item);
    }
    public void onError(Throwable t) { t.printStackTrace(); }
    public void onComplete() { System.out.println("Done"); }
});

publisher.submit("Hello");
publisher.close();

	ÄÃ¢y lÃ  reactive pipeline push-based: Publisher Ä‘áº©y dá»¯ liá»‡u sang Subscriber.



# ğŸ”¹ 3. So sÃ¡nh vá»›i Java Stream

| Äáº·c Ä‘iá»ƒm         | Java Stream                  | Reactive Stream                         |
| ---------------- | ---------------------------- | --------------------------------------- |
| **Kiá»ƒu xá»­ lÃ½**   | Pull (bá»™ xá»­ lÃ½ láº¥y data)     | Push (nguá»“n Ä‘áº©y data)                   |
| **Dá»¯ liá»‡u**      | Finite (cÃ³ giá»›i háº¡n)         | Infinite (cÃ³ thá»ƒ vÃ´ háº¡n)                |
| **Thá»i gian**    | KhÃ´ng cÃ³ khÃ¡i niá»‡m thá»i gian | CÃ³ khÃ¡i niá»‡m â€œevent theo thá»i gianâ€     |
| **Thread model** | Äá»“ng bá»™                      | Báº¥t Ä‘á»“ng bá»™ (asynchronous)              |
| **Backpressure** | KhÃ´ng cÃ³                     | CÃ³, Ä‘iá»u tiáº¿t tá»‘c Ä‘á»™ dá»¯ liá»‡u            |
| **á»¨ng dá»¥ng**     | Xá»­ lÃ½ batch                  | Real-time stream, message-driven system |


# ğŸ”¸ 4. Backpressure â€” â€œvan Ä‘iá»u Ã¡pâ€ cá»§a há»‡ thá»‘ng dá»¯ liá»‡u

	Trong há»‡ thá»‘ng reactive, Producer (Publisher) cÃ³ thá»ƒ phÃ¡t ra dá»¯ liá»‡u nhanh hÆ¡n Subscriber tiÃªu thá»¥ Ä‘Æ°á»£c.

	â†’ Náº¿u khÃ´ng kiá»ƒm soÃ¡t, ta sáº½ bá»‹ OOM, timeout hoáº·c máº¥t dá»¯ liá»‡u.

	Giáº£i phÃ¡p:
		DÃ¹ng cÆ¡ cháº¿ Backpressure:

		Subscriber chá»§ Ä‘á»™ng yÃªu cáº§u Publisher gá»­i dá»¯ liá»‡u theo tá»‘c Ä‘á»™ mÃ  nÃ³ chá»‹u Ä‘Æ°á»£c.

onSubscribe(Subscription s) {
    this.subscription = s;
    s.request(1); // yÃªu cáº§u 1 item
}

onNext(T item) {
    process(item);
    subscription.request(1); // sau khi xá»­ lÃ½ xong, yÃªu cáº§u tiáº¿p
}


	CÆ¡ cháº¿ nÃ y chÃ­nh lÃ  Reactive Pull â€” ngÆ°á»£c vá»›i Stream API (Pull tá»« Ä‘áº§u), á»Ÿ Ä‘Ã¢y Subscriber Ä‘iá»u tiáº¿t luá»“ng push.




# ğŸ”¹ 5. á»¨ng dá»¥ng trong Enterprise

	## 5.1 Streaming API / Event-driven Microservice 
	
	CÃ¡c há»‡ thá»‘ng Kafka, RabbitMQ, Pulsarâ€¦ Ä‘á»u tuÃ¢n theo mÃ´ hÃ¬nh Reactive Publisher â†’ Subscriber.
	
	OrderService (Publisher) phÃ¡t event â€œOrderCreatedâ€.
	
	BillingService (Subscriber) nháº­n event vÃ  xá»­ lÃ½ thanh toÃ¡n.
	
	Backpressure báº£o Ä‘áº£m: náº¿u BillingService cháº­m, OrderService khÃ´ng flood há»‡ thá»‘ng.



	## 5.2 Data Ingestion Pipelines

	Trong há»‡ thá»‘ng Big Data / ETL:

		Publisher: luá»“ng log / sensor data / IoT stream.
		Processor: parse â†’ enrich â†’ transform.
		Subscriber: lÆ°u vÃ o DB / data lake.

	Náº¿u pipeline downstream (DB) quÃ¡ táº£i, Backpressure cho phÃ©p â€œnÃ©n tá»‘c Ä‘á»™ upstreamâ€.
	
	â†’ ÄÃ¢y chÃ­nh lÃ  hÃ¬nh thá»©c flow control tá»± nhiÃªn, khÃ´ng cáº§n thread pool tuning thá»§ cÃ´ng.




	## 5.3 Reactive Database Access
		Spring WebFlux, R2DBC, Reactor, Mutinyâ€¦ Ä‘á»u dá»±a trÃªn reactive stream.
		VÃ­ dá»¥ trong Reactor:

Flux<Employee> flux = employeeRepo.findAll();
flux.filter(e -> e.isActive())
    .map(Employee::getEmail)
    .subscribe(System.out::println);



	Flux = Publisher nhiá»u pháº§n tá»­.
	.subscribe() = Subscriber.
	Reactor sáº½ tá»± Ä‘á»™ng quáº£n lÃ½ Backpressure, khÃ´ng bao giá» báº¯n dá»¯ liá»‡u nhanh hÆ¡n kháº£ nÄƒng xá»­ lÃ½.
	


# ğŸ”¸ 6. Reactive trong Security & API Gateway

	Functional Reactive Pattern cá»±c máº¡nh trong Java Security, Ä‘áº·c biá»‡t:

		Reactive Authentication Pipeline: má»—i bÆ°á»›c lÃ  1 function (User) -> Mono<User> (validate â†’ authorize â†’ audit).
		
		Rate Limiting / Throttling: thá»±c thi dá»±a trÃªn backpressure hoáº·c token bucket.
		
		API Gateway Filters (Spring Cloud Gateway) lÃ  reactive chain (ServerRequest â†’ Mono<ServerResponse>).

	VÃ­ dá»¥:
		Function<ServerRequest, Mono<ServerResponse>> secured =
			withRateLimit(withAudit(withAuth(baseHandler)));

		â†’ ÄÃ¢y lÃ  functional pipeline + reactive backpressure = cá»±c ká»³ máº¡nh cho há»‡ thá»‘ng phÃ¢n tÃ¡n.




# ğŸ”¹ 7. Reactor vs Flow API

| TiÃªu chÃ­                | Java Flow API        | Project Reactor                                     |
| ----------------------- | -------------------- | --------------------------------------------------- |
| **Má»©c Ä‘á»™ trá»«u tÆ°á»£ng**   | ThÃ´ (manual control) | Cao (Flux/Mono)                                     |
| **Async Scheduler**     | KhÃ´ng cÃ³             | CÃ³ (`publishOn`, `subscribeOn`)                     |
| **Operator**            | KhÃ´ng cÃ³             | HÃ ng trÄƒm operator nhÆ° map, flatMap, zip, buffer... |
| **Backpressure há»— trá»£** | CÃ³ (manual)          | CÃ³ (tá»± Ä‘á»™ng, tá»‘i Æ°u)                                |
| **Use case**            | Low-level system     | Enterprise reactive apps                            |

	â†’ Trong enterprise, ta thÆ°á»ng dÃ¹ng Reactor (Spring WebFlux) thay vÃ¬ Flow API gá»‘c vÃ¬ Reactor xá»­ lÃ½ toÃ n bá»™ vÃ²ng Ä‘á»i luá»“ng dá»¯ liá»‡u, scheduler, backpressure, error flow.



# ğŸ”¸ 8. Tá»•ng káº¿t cho senior

| Kiáº¿n thá»©c                  | Ã nghÄ©a trong thiáº¿t káº¿                                         |
| -------------------------- | -------------------------------------------------------------- |
| **Reactive Stream**        | Má»Ÿ rá»™ng Functional Stream thÃ nh dáº¡ng liÃªn tá»¥c (push-based)     |
| **Backpressure**           | Báº£o vá»‡ há»‡ thá»‘ng khá»i overload â€” cÆ¡ cháº¿ Ä‘iá»u tiáº¿t luá»“ng dá»¯ liá»‡u |
| **Publisherâ€“Subscriber**   | Thay tháº¿ cho Layered Architecture, hÆ°á»›ng event-driven          |
| **Functional Composition** | XÃ¢y dá»±ng pipeline transform dá»¯ liá»‡u Ä‘á»™ng                       |
| **Enterprise Value**       | TÄƒng throughput, giáº£m coupling, dá»… scale theo load             |


# ğŸ’¡ TÆ° duy cuá»‘i:

	Functional pipeline giÃºp báº¡n xá»­ lÃ½ batch dá»¯ liá»‡u.
Reactive stream giÃºp báº¡n xá»­ lÃ½ dÃ²ng dá»¯ liá»‡u sá»‘ng, cÃ³ nhá»‹p Ä‘iá»‡u, cÃ³ tá»‘c Ä‘á»™, vÃ  cÃ³ kháº£ nÄƒng chá»‹u táº£i.
</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>