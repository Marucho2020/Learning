<html><head><title>Lesson 219 == thi·∫øt k·∫ø API d√πng generic functional interfaces (Ê±éÁî®Èñ¢Êï∞„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ ) ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 219 -- thi·∫øt k·∫ø API d√πng generic functional interfaces (Ê±éÁî®Èñ¢Êï∞„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ ) -//</h1><pre>
# üî• M·ª•c ti√™u c·∫•p senior

Khi b·∫°n thi·∫øt k·∫ø API, b·∫°n kh√¥ng bao gi·ªù hardcode behavior.
B·∫°n xu·∫•t hi·ªán d∆∞·ªõi d·∫°ng pipeline v√† ƒë·ªÉ user truy·ªÅn v√†o Function/Predicate/Supplier/Consumer ƒë·ªÉ t·ª± c·∫•u h√¨nh h√†nh vi.

ƒê√≥ l√† c√°ch c√°c th∆∞ vi·ªán l·ªõn nh∆∞ Reactor, Spring WebFlux, Guava, Java Stream ƒë∆∞·ª£c thi·∫øt k·∫ø.




# 1. V·∫§N ƒê·ªÄ TH·ª∞C S·ª∞ (m√† junior kh√¥ng th·∫•y)

	## Junior th∆∞·ªùng vi·∫øt API ki·ªÉu n√†y: 

public List<User> filterActiveUsers(List<User> users) {
    List<User> result = new ArrayList<>();
    for (User u : users) {
        if (u.isActive()) result.add(u);
    }
    return result;
}

‚Üí Hardcode filter logic
‚Üí Kh√¥ng t√°i d√πng
‚Üí M·ªói thay ƒë·ªïi = s·ª≠a m√£ ngu·ªìn

	Senior th·∫•y ngay:
	C·∫ßn expose predicate, kh√¥ng c·∫ßn function ƒë·∫∑c th√π.





# 2. GI·∫¢I PH√ÅP CHU·∫®N SENIOR

	API ch·ªâ n√™n l√†m ‚Äúframework‚Äù, c√≤n logic l√† th·ª© user t·ª± ƒë∆∞a v√†o.


public <T> List<T> filter(List<T> list, Predicate<T> predicate) {
    return list.stream().filter(predicate).toList();
}

	Gi·ªù behavior l√† plugin v√†o, kh√¥ng d√≠nh v√†o core logic.
	
	## User t·ª± inject:

var activeUsers = filter(users, User::isActive);
var vipUsers    = filter(users, u -> u.getRank() >= 5);


	API thu·∫ßn s·∫°ch ‚Äî logic n·∫±m ngo√†i.





# 3. M·ªû R·ªòNG: PIPELINE D·∫†NG FUNCTION

C·∫•p ƒë·ªô cao h∆°n:
	Expose API theo ki·ªÉu pipeline, gi·ªëng Reactor ho·∫∑c Resilience4j.


public <T> Function<T, T> withLogging(Function<T, T> fn) {
    return (t) -> {
        log.info("Input: {}", t);
        var r = fn.apply(t);
        log.info("Output: {}", r);
        return r;
    };
}



	## User inject v√†o: 

var pipeline =
        withLogging(
                withTracing(
                        withValidation(x -> x > 10,    // predicate
                                      x -> x * 2)      // function
                )
        );

API kh√¥ng ch·ª©a logic nghi·ªáp v·ª•.
API ch·ªâ ch·ª©a khung (framework).




# 4. DESIGN PATTERN CHU·∫®N: Higher-Order Function API

	ƒê√¢y l√† b·∫£n ch·∫•t Functional:
	
	Function nh·∫≠n function ‚Üí tr·∫£ ra function.


	## ∆Øu ƒëi·ªÉm l·ªõn:

		D·ªÖ test (test function ƒë·ªôc l·∫≠p)
		Kh√¥ng c·∫ßn subclass
		Kh√¥ng c·∫ßn override
		Kh√¥ng c·∫ßn AOP ƒë·ªÉ ch√®n behavior
		C√≥ th·ªÉ compose linh ho·∫°t



# 5. GI·∫¢I PH√ÅP ENTERPRISE ‚Äî ‚ÄúBehavior Injection DSL‚Äù

	Senior t·∫°o DSL cho behavior.

	## V√≠ d·ª•: DSL cho x·ª≠ l√Ω thanh to√°n


public class PaymentFlow {

    private Predicate<Payment> fraudCheck = p -> true;
    private Function<Payment, Payment> discountFn = p -> p;
    private Consumer<Payment> audit = p -> {};

    public PaymentFlow fraud(Predicate<Payment> pred) {
        this.fraudCheck = pred;
        return this;
    }

    public PaymentFlow discount(Function<Payment, Payment> fn) {
        this.discountFn = fn;
        return this;
    }

    public PaymentFlow audit(Consumer<Payment> consumer) {
        this.audit = consumer;
        return this;
    }

    public Function<Payment, Payment> build() {
        return (p) -> {
            if (!fraudCheck.test(p))
                throw new RuntimeException("Fraud detected");
            var discounted = discountFn.apply(p);
            audit.accept(discounted);
            return discounted;
        };
    }
}




	## User d√πng:
var pipeline =
    new PaymentFlow()
        .fraud(p -> p.amount() < 10000)
        .discount(p -> p.withAmount(p.amount() * 0.9))
        .audit(p -> logger.info("AUDIT {}", p))
        .build();


Thay behavior = change lambda.
Kh√¥ng c·∫ßn s·ª≠a l√µi.
ƒê√∫ng chu·∫©n configurability c·ªßa microservice enterprise.



# 6. T·∫†I SAO DESIGN N√ÄY L√Ä ƒêI·ªÇM C·ªòNG L·ªöN TRONG SYSTEM DESIGN INTERVIEW?

	Decoupling ho√†n to√†n
	Behavior injection kh√¥ng c·∫ßn framework
	Kh√¥ng hardcode logic trong API
	D·ªÖ t·∫°o DSL (Domain-Specific Language)
	D·ªÖ th·ª±c hi·ªán GitOps + runtime configuration
	Th√≠ch h·ª£p cho:	
	
		- Resilience
		- Validation
		- Routing
		- Observability
		- Policy-driven pipeline
		
	B·∫£n ch·∫•t microservice hi·ªán ƒë·∫°i l√† ch·∫°y theo policy (config), kh√¥ng ch·∫°y theo code c·ª©ng.



# 7. T·∫¶M NH√åN XA ‚Äî L√ù DO FUNCTION/PREDICATE L√Ä CHU·∫®N KI·∫æN TR√öC S∆Ø

	‚ÄúAPI tinh g·ªçn = behavior b√™n ngo√†i, khung b√™n trong.‚Äù
	N·∫øu b·∫°n mu·ªën h·ªá th·ªëng ti·∫øn h√≥a m√† kh√¥ng ph·∫£i s·ª≠a code,
		th√¨ function interface l√† c·∫ßu n·ªëi:

		- Behavior t·ª´ config
		- Behavior t·ª´ GitOps
		- Behavior t·ª´ DSL
		- Behavior dynamic runtime

	T·ª´ retry policy ƒë·∫øn logging, tracing, rate limiting‚Ä¶
		t·∫•t c·∫£ ƒë·ªÅu l√† Function decorator.



# 8. T√ìM G·ªåN (th·∫≥ng v√†o c·ªët l√µi)

Expose function, kh√¥ng expose logic.
API c·ªßa b·∫°n ch·ªâ l√† pipeline.
User t·ª± inject behavior b·∫±ng Function/Predicate.
Kh√¥ng subclass, kh√¥ng override, kh√¥ng AOP.

	ƒê√≥ l√† c√°ch vi·∫øt API mang t·∫ßm senior ‚Äì s·∫°ch, r√µ, m·ªü r·ªông kh√¥ng c·∫ßn ƒë·∫≠p code.










</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>