<html><head><title>Lesson 116 == B-Tree & B+Tree ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 116 -- B-Tree & B+Tree -//</h1><pre>
# KhÃ¡i niá»‡m 
	B-Tree vÃ  B+ Tree lÃ  hai cáº¥u trÃºc dá»¯ liá»‡u cáº¥p cao, Ä‘Æ°á»£c thiáº¿t káº¿ tá»‘i Æ°u cho há»‡ thá»‘ng I/O-intensive nhÆ° cÆ¡ sá»Ÿ dá»¯ liá»‡u, filesystem, hoáº·c storage engine. Náº¿u báº¡n Ä‘ang thiáº¿t káº¿ há»‡ thá»‘ng táº§m cá»¡ enterprise (database engine, distributed storage, search engineâ€¦), thÃ¬ hiá»ƒu rÃµ 2 cáº¥u trÃºc nÃ y lÃ  báº¯t buá»™c á»Ÿ trÃ¬nh Ä‘á»™ senior system architect.

# Má»¥c Ä‘Ã­ch ra Ä‘á»i  
	CÃ¡c cÃ¢y nhá»‹ phÃ¢n tÃ¬m kiáº¿m nhÆ° BST, AVL, hay Red-Black Tree hoáº¡t Ä‘á»™ng tá»‘t trong bá»™ nhá»› (RAM) nhÆ°ng khÃ´ng hiá»‡u quáº£ vá»›i disk I/O vÃ¬: 
		- ChÃºng cÃ³ chiá»u cao lá»›n â†’ má»—i truy váº¥n tá»‘n nhiá»u láº§n Ä‘á»c Ä‘Ä©a.
		- TrÃªn Ä‘Ä©a, má»—i I/O cá»±c ká»³ Ä‘áº¯t â†’ cáº§n giáº£m sá»‘ láº§n truy cáº­p disk 

	â¡ï¸ B-Tree vÃ  B+ Tree giáº£i quyáº¿t báº±ng cÃ¡ch: 
	
		- Má»—i node chá»©a nhiá»u keys (thay vÃ¬ 1)
		- Chiá»u cao tháº¥p hÆ¡n ráº¥t nhiá»u 
		- Tá»‘i Æ°u sá»‘ láº§n I/O

# ğŸ“˜ B-TREE (Basic Concept) 

	B-Tree lÃ  má»™t cÃ¢y cÃ¢n báº±ng Ä‘a phÃ¢n nhÃ¡nh (multi-way balanced tree). Má»—i node cÃ³ thá»ƒ chá»©a nhiá»u key vÃ  nhiá»u con. 
	
	## âœ… Thuá»™c tÃ­nh chÃ­nh cá»§a B-Tree 
		Tá»‘i Ä‘a m nhÃ¡nh (báº­c m) cho má»—i node.
		Má»—i node chá»©a tá»« âŒˆm/2âŒ‰ - 1 Ä‘áº¿n m - 1 khÃ³a (trá»« root).
		CÃ¡c khÃ³a trong 1 node Ä‘Æ°á»£c sáº¯p xáº¿p tÄƒng dáº§n. 
		Má»—i con náº±m giá»¯a hai khÃ³a phÃ¢n vÃ¹ng giÃ¡ trá»‹.
		Táº¥t cáº£ lÃ¡ á»Ÿ cÃ¹ng má»™t má»©c â†’ Ä‘áº£m báº£o cÃ¢n báº±ng.
	

	## ğŸŒ² Cáº¥u trÃºc: 
	    [17, 35]
		/   |    \
	[3,10] [20,30] [40,60,80]
	â†’ Má»™t truy váº¥n tÃ¬m 20 chá»‰ cáº§n duyá»‡t 2 node, thay vÃ¬ Ä‘i 4â€“5 má»©c nhÆ° BST.

# ğŸ“— B+ TREE â€“ BIáº¾N THá»‚ Tá»I Æ¯U CHO DATABASE
	B+ Tree lÃ  biáº¿n thá»ƒ tÄƒng hiá»‡u suáº¥t quÃ©t vÃ  truy cáº­p theo dÃ£y (range). KhÃ¡c vá»›i B-Tree:
	
|                        | B-Tree            | B+ Tree                                 |
| ---------------------- | ----------------- | --------------------------------------- |
| **Key trong Internal** | CÃ³ thá»ƒ chá»©a value | Chá»‰ dÃ¹ng Ä‘á»ƒ Ä‘á»‹nh tuyáº¿n (routing)        |
| **Key trong Leaf**     | Má»™t pháº§n keys     | Táº¥t cáº£ dá»¯ liá»‡u Ä‘á»u náº±m á»Ÿ **lÃ¡**         |
| **Truy váº¥n tuáº§n tá»±**   | KhÃ³ quÃ©t range    | Dá»… â†’ leaf nodes **liÃªn káº¿t nhau**       |
| **Chiá»u cao**          | Tháº¥p              | TÆ°Æ¡ng Ä‘Æ°Æ¡ng B-Tree                      |
| **á»¨ng dá»¥ng**           | Filesystem        | Database indexing (MySQL, MongoDB, etc) |

	
ğŸ“Š Minh hoáº¡: 
Internal:     [20, 50]
             /    |     \
Leaves: [10,15][25,35][55,75]
              â†”     â†”     â†”
â†’ QuÃ©t range tá»« 25 â†’ 75 = duyá»‡t liÃªn tá»¥c cÃ¡c lÃ¡ báº±ng pointer â†’ cá»±c nhanh vÃ  khÃ´ng cáº§n quay láº¡i internal node.


# ğŸ§  Táº I SAO B+ TREE ÄÆ¯á»¢C Æ¯U TIÃŠN TRONG DATABASE? 

	- Truy xuáº¥t theo key: nhanh vÃ¬ chiá»u cao cÃ¢y tháº¥p
	- Range scan: ráº¥t nhanh nhá» pointer giá»¯a leaf nodes
	- KhÃ´ng cáº§n truy cáº­p node trung gian Ä‘á»ƒ láº¥y data
	- Tá»‘i Æ°u hÃ³a block I/O: má»—i node trÃ¹ng khá»›p vá»›i 1 disk block

ğŸ’¡ MySQL (InnoDB) dÃ¹ng B+ Tree cho index.


# ğŸš€ á»¨NG Dá»¤NG THá»°C Táº¾
| Há»‡ thá»‘ng              | DÃ¹ng gÃ¬                          | Má»¥c Ä‘Ã­ch                       |
| --------------------- | -------------------------------- | ------------------------------ |
| **MySQL / InnoDB**    | B+ Tree                          | Index data, support range scan |
| **MongoDB**           | B+ Tree                          | B-Tree Indexing                |
| **LevelDB / RocksDB** | LSM Tree + B-Tree (trÃªn SSTable) | Tá»‘i Æ°u write-heavy             |
| **Linux EXT4/NTFS**   | B-Tree                           | Directory structure            |
| **Git internals**     | B-Tree                           | Object storage indexing        |



# ğŸ”¨ Cáº¤U TRÃšC Lá»šP NODE TRONG JAVA (Gá»¢I Ã)

class BTreeNode {
    int[] keys;
    Object[] values; // optional
    BTreeNode[] children;
    int degree;
    boolean isLeaf;

    // methods: insert, splitChild, search...
}
	

# ğŸ¯ KIáº¾N THá»¨C Cáº¦N Há»ŒC Äá»‚ MASTER

| Chá»§ Ä‘á»                    | Ghi chÃº                                     |
| ------------------------- | ------------------------------------------- |
| Cáº¥u trÃºc B-Tree, B+ Tree  | Äá»‹nh nghÄ©a, cÃ¡c case insert/split/merge     |
| Block size & Disk I/O     | VÃ¬ sao block-aligned node size quan trá»ng   |
| Paging (Buffer Pool)      | CÃ¡ch database load tree vÃ o memory          |
| Write-ahead logging (WAL) | Äáº£m báº£o an toÃ n khi ghi B+ Tree             |
| Concurrency (Latch)       | Nhiá»u thread cáº­p nháº­t cÃ¢y cÃ¹ng lÃºc          |
| LSM Tree                  | So sÃ¡nh B+ Tree vs LSM (LevelDB, Cassandra) |
| Cache-aware layout        | Khi muá»‘n tá»‘i Æ°u CPU cache hit               |


# âœ… TÃ“M Táº®T 
| Loáº¡i cÃ¢y | Æ¯u Ä‘iá»ƒm                                   | DÃ¹ng khi nÃ o                         |
| -------- | ----------------------------------------- | ------------------------------------ |
| B-Tree   | Äá»c theo key hiá»‡u quáº£, Ä‘a nÄƒng            | Filesystem, khi khÃ´ng cáº§n range scan |
| B+ Tree  | Truy váº¥n range siÃªu nhanh, chiá»u cao tháº¥p | Database indexing, OLAP/OLTP         |




</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>