<html><head><title>Lesson 38 == ArrayBlockingQueue ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 38 -- ArrayBlockingQueue -//</h1><pre># 1. KhÃ¡i niá»‡m 
	LinkedBlockingQueue lÃ  má»™t blocking Queue Ä‘Æ°á»£c triá»ƒn khai dá»±a trÃªn danh sÃ¡ch liÃªn káº¿t(linked list)
	ÄÃ¢y lÃ  má»™t pháº§n cá»§a gÃ³i java.util.concurrent, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ sá»­ dá»¥ng trong mÃ´i trÆ°á»ng Ä‘a luá»“ng, nÆ¡i cÃ¡c luá»“ng cÃ³ thá»ƒ thÃªm(enqueue) vÃ  láº¥y(dequeue) pháº§n tá»­ má»™t cÃ¡ch an toÃ n mÃ  khÃ´ng cáº§n khÃ³a thá»§ cÃ´ng 

# 2. CÃ¡c Ä‘áº·c Ä‘iá»ƒm chÃ­nh cá»§a LinkedBlockingQueue
	
	## 1. Há»— trá»£ giá»›i háº¡n kÃ­ch thÆ°á»›c 
		Báº¡n cÃ³ thá»ƒ táº¡o má»™t LinkedBlockingQueue vá»›i má»™t kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh hoáº·c khÃ´ng giá»›i háº¡n(máº·c Ä‘á»‹nh lÃ  khÃ´ng giá»›i háº¡n)
		
		Khi Ä‘áº¡t Ä‘áº¿n tráº¡ng thÃ¡i kÃ­ch thÆ°á»›c tá»‘i Ä‘a, cÃ¡c luá»“ng sáº½ bá»‹ cháº·n(blocked) khi cá»‘ gáº¯ng thÃªm pháº§n tá»­ má»›i cho Ä‘áº¿n khi cÃ³ khÃ´ng gian trá»‘ng 
		
	## An toÃ n trong mÃ´i trÆ°á»ng Ä‘a luá»“ng 
		Viá»‡c thÃªm (put) vÃ  láº¥y(take) pháº§n tá»­ Ä‘Æ°á»£c Ä‘á»“ng bá»™ hÃ³a, Ä‘áº£m báº£o ráº±ng khÃ´ng cÃ³ luá»“ng nÃ o cÃ³ thá»ƒ lÃ m sai lá»‡ch dá»¯ liá»‡u 
		
	## Hai khÃ³a tÃ¡ch biá»‡t 
		LinkedBlockingQueue sá»­ dá»¥ng hai khÃ³a tÃ¡ch biá»‡t(lock splitting) Ä‘á»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t: 
			- má»™t khÃ³a cho hÃ nh Ä‘á»™ng thÃªm(enqueue)
			- Má»™t khÃ³a cho hÃ nh Ä‘á»™ng láº¥y(dequeue)
			
		Äiá»u nÃ y cho phÃ©p cÃ¡c luá»“ng thÃªm vÃ  láº¥y pháº§n tá»­ Ä‘á»“ng thá»i mÃ  khÃ´ng gÃ¢y cáº£n trá»Ÿ láº«n nhau. 
		
	## Há»— trá»£ cÃ¡c thao tÃ¡c blocking 
		CÃ¡c phÆ°Æ¡ng thá»©c nhÆ° put()  vÃ  take() sáº½ cháº·n(block) luá»“ng gá»i náº¿u queue Ä‘áº§y hoáº·c rá»—ng, giÃºp quáº£n lÃ½ luá»“ng dá»… dÃ ng hÆ¡n 
		
	## Dá»±a trÃªn danh sÃ¡ch liÃªn káº¿t 
		Ná»™i bá»™ LinkedBlockingQueue Ä‘Æ°á»£c triá»ƒn khai trÃªn má»™t danh sÃ¡ch liÃªn káº¿t, khÃ´ng giá»‘ng nhÆ° ArrayBlockingQueue vá»‘n dá»±a trÃªn máº£ng. 
		
# CÃ¡ch sá»­ dá»¥ng LinkedBlockingQueue 
		
	## Khá»Ÿi táº¡o LinkedBlockingQueue 
					// Queue khÃ´ng giá»›i háº¡n kÃ­ch thÆ°á»›c
					LinkedBlockingQueue<Integer> unboundedQueue = new LinkedBlockingQueue<>();
					
					// Queue vá»›i kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh
					LinkedBlockingQueue<Integer> boundedQueue = new LinkedBlockingQueue<>(5);
			
					// ThÃªm pháº§n tá»­ vÃ o queue
					boundedQueue.put(1); // Cháº·n náº¿u Ä‘áº§y
					boundedQueue.offer(2); // KhÃ´ng cháº·n, tráº£ vá» false náº¿u Ä‘áº§y
		
		
# CÃ¡c phÆ°Æ¡ng thá»©c quan trá»ng 
			
	## ThÃªm pháº§n tá»­ 
		.add(E e)                             : ThÃªm pháº§n tá»­, nÃ©m ngoáº¡i lá»‡ náº¿u queue Ä‘áº§y 
		.offer(E e)                           : ThÃªm pháº§n tá»­, tráº£ vá» false náº¿u queue Ä‘áº§y 
		.offer(E e, timeout, TimeUnit unit)   : Thá»­ thÃªm pháº§n tá»­ trong khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh, cháº·n náº¿u Ä‘áº§y 
		.put(E e)                             : ThÃªm pháº§n tá»­ vÃ o cuá»‘i queue,  Cháº·n luá»“ng cho Ä‘áº¿n khi cÃ³ khÃ´ng gian trá»‘ng trong queue Ä‘á»ƒ thÃªm pháº§n tá»­ 
		
	## XÃ³a pháº§n tá»­ 
		.poll()                          : Láº¥y vÃ  xÃ³a pháº§n tá»­ Ä‘áº§u tiÃªn, tráº£ vá» null náº¿u queue rá»—ng 
		.poll(timeout, TimeUnit unit )   : Láº¥y vÃ  xÃ³a pháº§n tá»­ Ä‘áº§u tiÃªn, chá» trong khoáº£ng thá»i gian nháº¥t Ä‘á»‹nh náº¿u queue rá»—ng 
		.take()                          : Cháº·n luá»“ng cho Ä‘áº¿n khi cÃ³ pháº§n tá»­ Ä‘á»ƒ láº¥y 
		.peek()                          : Xem pháº§n tá»­ Ä‘áº§u tiÃªn nhÆ°ng khÃ´ng xÃ³a, tráº£ vá» null náº¿u queue rá»—ng 
		
	## CÃ¡c phÆ°Æ¡ng thá»©c khÃ¡c 
		.size()                : Tráº£ vá» sá»‘ lÆ°á»£ng pháº§n tá»­ hiá»‡n táº¡i trong queue
		.remainingCapacity()   : Tráº£ vá» khÃ´ng gian trá»‘ng cÃ²n láº¡i trong queue
		.clear()               : XÃ³a táº¥t cáº£ pháº§n tá»­ trong queue
		.contains(Object o)    : Kiá»ƒm tra xem queue cÃ³ chá»©a pháº§n tá»­ o hay khÃ´ng 
		
		
		
		
# VÃ­ dá»¥ thá»±c táº¿: Sá»­ dá»¥ng LinkedBlockingQueue Ä‘á»ƒ quáº£n lÃ½ tÃ¡c vá»¥ 	vÃ  bÃ i toÃ¡n ngÆ°á»i tiÃªu dÃ¹ng nhÃ  sáº£n xuáº¥t 	
		
					import java.util.concurrent.LinkedBlockingQueue;
					
					class Producer implements Runnable {
						private LinkedBlockingQueue<Integer> queue;
					
						public Producer(LinkedBlockingQueue<Integer> queue) {
							this.queue = queue;
						}
					
						@Override
						public void run() {
							try {
								for (int i = 1; i <= 5; i++) {
									System.out.println("Produced: " + i);
									queue.put(i); // Cháº·n náº¿u queue Ä‘áº§y
									Thread.sleep(100); // Giáº£ láº­p thá»i gian sáº£n xuáº¥t
								}
							} catch (InterruptedException e) {
								Thread.currentThread().interrupt();
							}
						}
					}
					
					class Consumer implements Runnable {
						private LinkedBlockingQueue<Integer> queue;
					
						public Consumer(LinkedBlockingQueue<Integer> queue) {
							this.queue = queue;
						}
					
						@Override
						public void run() {
							try {
								while (true) {
									Integer item = queue.take(); // Cháº·n náº¿u queue rá»—ng
									System.out.println("Consumed: " + item);
									Thread.sleep(200); // Giáº£ láº­p thá»i gian tiÃªu thá»¥
								}
							} catch (InterruptedException e) {
								Thread.currentThread().interrupt();
							}
						}
					}
					
					public class LinkedBlockingQueueExample {
						public static void main(String[] args) {
							LinkedBlockingQueue<Integer> queue = new LinkedBlockingQueue<>(3);
					
							Thread producer = new Thread(new Producer(queue));
							Thread consumer = new Thread(new Consumer(queue));
					
							producer.start();
							consumer.start();
						}
					}
		
		
# So sÃ¡nh LinkedBlockingQueue vÃ  ArrayBlockingQueue

Äáº·c Ä‘iá»ƒm						LinkedBlockingQueue							ArrayBlockingQueue

Cáº¥u trÃºc ná»™i bá»™					Danh sÃ¡ch liÃªn káº¿t							Máº£ng
KÃ­ch thÆ°á»›c						TÃ¹y chá»n: cÃ³ thá»ƒ giá»›i háº¡n hoáº·c khÃ´ng		Pháº£i cÃ³ kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh
Hiá»‡u suáº¥t						Tá»‘t hÆ¡n khi thÃªm vÃ  láº¥y Ä‘á»“ng thá»i			Cháº­m hÆ¡n do sá»­ dá»¥ng má»™t khÃ³a chung
Sá»­ dá»¥ng tÃ i nguyÃªn				TiÃªu tá»‘n nhiá»u bá»™ nhá»› hÆ¡n (do node)			Sá»­ dá»¥ng Ã­t bá»™ nhá»› hÆ¡n			
		
		
		
</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>