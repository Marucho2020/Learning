<html><head><title>Lesson 136 == DAG (Directed Acyclic Graph) ‚Üí ·ª©ng d·ª•ng v√†o Task Pipeline ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 136 -- DAG (Directed Acyclic Graph) ‚Üí ·ª©ng d·ª•ng v√†o Task Pipeline -//</h1><pre>
# üî∑ I. DAG l√† g√¨? 
	## üß† ƒê·ªãnh nghƒ©a: 
		DAG (Directed Acyclic Graph) 
		DAG l√† ƒë·ªì th·ªã c√≥ h∆∞·ªõng v√† kh√¥ng c√≥ chu tr√¨nh 
		M·ªôt t·∫≠p c√°c n√∫t (node) v√† c·∫°nh (edge) trong ƒë√≥ m·ªçi c·∫°nh ƒë·ªÅu h∆∞·ªõng m·ªôt chi·ªÅu v√† kh√¥ng th·ªÉ quay v·ªÅ g·ªëc


A ‚Üí B ‚Üí C
‚Üì         ‚Üë
D ‚Üí E ‚Üí F

	B·∫°n kh√¥ng th·ªÉ b·∫Øt ƒë·∫ßu t·ª´ A v√† quay l·∫°i A ‚Üí kh√¥ng c√≥ v√≤ng l·∫∑p (acyclic)
	M·ªói node ƒë·∫°i di·ªán cho m·ªôt task, edge l√† dependency



# üîß II. V√¨ sao DAG l·∫°i quan tr·ªçng trong Task Pipeline?

	## üéØ √ù t∆∞·ªüng c·ªët l√µi: 
		M·ªôt pipeline ph·ª©c t·∫°p lu√¥n c√≥ c√°c b∆∞·ªõc ph·ª• thu·ªôc nhau, v√† c√≥ th·ªÉ th·ª±c thi song song n·∫øu kh√¥ng ph·ª• thu·ªôc.
		
		
	## DAG ‚Üí Bi·ªÉu di·ªÖn: 
		
		- Th·ª© t·ª± th·ª±c hi·ªán task
		- C√°c task n√†o c√≥ th·ªÉ ch·∫°y song song
		- Ph√°t hi·ªán deadlock / v√≤ng l·∫∑p (cycle)
		- T·ªëi ∆∞u h√≥a to√†n c·ª•c pipeline

# üîÑ III. DAG th·ª±c t·∫ø trong Task Pipeline

| H·ªá th·ªëng                                    | M√¥ t·∫£                                                   |
| ------------------------------------------- | ------------------------------------------------------- |
| **Apache Airflow**                          | M·ªói pipeline l√† m·ªôt DAG ‚Äì m·ªói node l√† `Operator` (task) |
| **Spark DAG Scheduler**                     | Bi·ªÉu di·ªÖn c√°c stage t√≠nh to√°n (RDD transformation)      |
| **TensorFlow Computation Graph**            | To√°n t·ª≠ tensor (op) n·ªëi v·ªõi nhau qua DAG                |
| **CI/CD Pipeline (GitHub Actions, GitLab)** | Job ph·ª• thu·ªôc v√†o job kh√°c                              |
| **n8n, Prefect, Dagster**                   | Workflow automation d·∫°ng DAG                            |



# üß† IV. C√°c t√≠nh ch·∫•t & k·ªπ thu·∫≠t c·∫ßn n·∫Øm c·∫•p ƒë·ªô senior

	##  1. Topological Sort 
	
		- S·∫Øp x·∫øp c√°c task theo th·ª© t·ª± c√≥ th·ªÉ ch·∫°y
		- ƒê·∫£m b·∫£o kh√¥ng c√≥ task n√†o ch·∫°y tr∆∞·ªõc khi ph·ª• thu·ªôc c·ªßa n√≥ xong

	List<Task> topoSorted = topologicalSort(tasks);
	N·∫øu ph√°t hi·ªán v√≤ng l·∫∑p ‚Üí throw CycleDependencyException.

# 2. Critical Path Optimization

	ƒê∆∞·ªùng d√†i nh·∫•t trong DAG ‚Üí gi·ªõi h·∫°n th·ªùi gian th·ª±c thi to√†n pipeline
	N·∫øu b·∫°n mu·ªën t·ªëi ∆∞u th·ªùi gian, t·ªëi ∆∞u critical path ƒë·∫ßu ti√™n


# 3. Parallelism & Concurrency (Song song v√† ƒë·ªìng th·ªùi )

		- N·∫øu A ‚Üí B, nh∆∞ng C ƒë·ªôc l·∫≠p ‚Üí c√≥ th·ªÉ ch·∫°y A v√† C song song
		- DAG gi√∫p h·ªá th·ªëng scheduler ph√¢n chia task v√†o nhi·ªÅu thread/node
	

# 4. Incremental Execution

	- DAG cho ph√©p cache node ƒë√£ ho√†n th√†nh (memoization)
	- V√≠ d·ª•: Spark DAG + lineage = ch·ªâ recompute ph·∫ßn n√†o thay ƒë·ªïi


# üì¶ V. DAG Task Scheduler ‚Äì th√†nh ph·∫ßn thi·∫øt k·∫ø

| Th√†nh ph·∫ßn             | Vai tr√≤                                       |
| ---------------------- | --------------------------------------------- |
| **DAG Builder**        | Nh·∫≠n input, x√¢y DAG                           |
| **Cycle Detector**     | Ki·ªÉm tra logic sai                            |
| **Topological Sorter** | ƒê·∫£m b·∫£o th·ª© t·ª±                                |
| **Task Executor**      | G·ª≠i task sang thread/worker                   |
| **Event Bus**          | L·∫Øng nghe khi task xong, trigger task k·∫ø ti·∫øp |




# ‚öôÔ∏è VI. Code m·∫´u simplified (pseudo Java)

class Task {
    String id;
    List<Task> dependsOn;
    Runnable logic;
}

void executeDAG(List<Task> tasks) {
    Map<Task, Integer> inDegree = calcInDegree(tasks);
    Queue<Task> ready = new LinkedList<>();

    // B·∫Øt ƒë·∫ßu v·ªõi task kh√¥ng ph·ª• thu·ªôc
    for (Task t : tasks)
        if (inDegree.get(t) == 0) ready.add(t);

    while (!ready.isEmpty()) {
        Task t = ready.poll();
        runAsync(t.logic, () -> {
            for (Task next : findDependents(t, tasks)) {
                inDegree.put(next, inDegree.get(next) - 1);
                if (inDegree.get(next) == 0) ready.add(next);
            }
        });
    }
}



# üî• VII. Pitfall trong thi·∫øt k·∫ø Task DAG

| V·∫•n ƒë·ªÅ                          | H·ªá qu·∫£                                                      |
| ------------------------------- | ----------------------------------------------------------- |
| Cycle                           | Deadlock, l·∫∑p v√¥ t·∫≠n                                        |
| Kh√¥ng theo d√µi tr·∫°ng th√°i task  | Task ch·∫°y l·∫°i nhi·ªÅu l·∫ßn ho·∫∑c b·ªã skip                        |
| Granularity qu√° nh·ªè             | Overhead l·ªõn h∆°n l·ª£i √≠ch (task scheduling > task execution) |
| Kh√¥ng ph√¢n bi·ªát I/O vs CPU task | Kh√¥ng t·∫≠n d·ª•ng ƒë∆∞·ª£c executor ƒë√∫ng                           |
| Kh√¥ng t√≠nh Critical Path        | Kh√¥ng optimize ƒë√∫ng ch·ªó                                     |


# üß† VIII. C√°c t·ªëi ∆∞u c·∫•p ƒë·ªô senior


	1. Memoization node output
		‚Üí N·∫øu node B ch·∫°y r·ªìi v·ªõi input gi·ªëng h·ªát ‚Üí kh√¥ng c·∫ßn ch·∫°y l·∫°i
	
	2. Parallelism-aware task batching
		‚Üí Gom task kh√¥ng ph·ª• thu·ªôc v√†o nhau ƒë·ªÉ ch·∫°y trong 1 batch ‚Üí gi·∫£m context switching
	
	3. Pre-scheduling / Early materialization
		‚Üí ∆Ø·ªõc l∆∞·ª£ng DAG tr∆∞·ªõc ƒë·ªÉ ph√¢n b·ªï resource tr∆∞·ªõc khi ch·∫°y
	
	4. Dynamic DAG (Recursive DAG / Conditional DAG)
		‚Üí DAG thay ƒë·ªïi runtime d·ª±a v√†o k·∫øt qu·∫£ task tr∆∞·ªõc
		(V√≠ d·ª•: A ‚Üí B, n·∫øu B th·∫•t b·∫°i ‚Üí chuy·ªÉn sang B‚Äô)

# ‚úÖ T·ªïng k·∫øt

| Kh√°i ni·ªám     | √ù nghƒ©a senior level                         |
| ------------- | -------------------------------------------- |
| DAG           | Bi·ªÉu di·ªÖn pipeline kh√¥ng v√≤ng l·∫∑p            |
| Topo Sort     | ƒê·∫£m b·∫£o dependency                           |
| Critical Path | N√∫t th·∫Øt c·ªï chai, c·∫ßn t·ªëi ∆∞u                 |
| DAG Scheduler | H·ªá th·ªëng ch·∫°y task tu·∫ßn t·ª±/song song         |
| DAG Runtime   | C√≥ th·ªÉ tracking tr·∫°ng th√°i, rollback, resume |




</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>