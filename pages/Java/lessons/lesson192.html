<html><head><title>Lesson 192 == Lazy Evaluation & Short-circuiting ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>🔙 Quay lại danh sách</a><br><h1>Lesson 192 -- Lazy Evaluation & Short-circuiting -//</h1><pre>
# 1. Lazy evaluation là gì?

	Intermediate operations (map, filter, flatMap, peek, …) không thực thi ngay.
	
	Chúng chỉ tạo pipeline (biểu đồ các bước xử lý).
	
	Stream chỉ chạy thật khi gặp terminal operation (forEach, collect, reduce, anyMatch,…).

		👉 Giống như viết SQL: SELECT … FROM … WHERE … → query chỉ chạy khi bạn execute nó.
		👉 Đây là “lazy” (遅延評価): khai báo trước, tính sau.



# 2. Short-circuiting terminal operations

	Một số terminal operations có thể kết thúc pipeline sớm khi đã đủ điều kiện:

		- findFirst() → trả phần tử đầu tiên, dừng ngay, không duyệt hết.
		- anyMatch(Predicate) → chỉ cần gặp 1 phần tử match → dừng.
		- allMatch(Predicate) → gặp 1 phần tử fail → dừng.
		- noneMatch(Predicate) → gặp 1 phần tử match → dừng.
		- limit(n) → chỉ cần n phần tử đầu tiên → bỏ qua phần còn lại.

	⚡ Đây là short-circuit (短絡評価), cực quan trọng để tối ưu performance.



# 3. Ví dụ dễ hiểu

boolean hasViolation = employees.stream()
    .peek(e -> System.out.println("Checking " + e.getName()))
    .anyMatch(e -> e.getSalary() < 0);


		- Nếu employee đầu tiên có salary < 0 → pipeline dừng ngay, không duyệt thêm.
		- peek in ra giúp bạn thấy lazy + short-circuit: không phải tất cả phần tử đều được duyệt.




# 4. Enterprise insight

	## Validation engine:

boolean violated = employees.stream()
    .anyMatch(e -> violatesBusinessRule(e));
if (violated) notifyCompliance();

	→ Dừng ngay khi thấy vi phạm đầu tiên, thay vì duyệt cả 1 triệu nhân viên.

	Optimization:
		Tránh tính toán tốn kém không cần thiết (ví dụ validate tất cả field khi chỉ cần biết 1 field fail).
		
		Trong big data / log processing, short-circuit giúp tiết kiệm CPU + IO.



# 5. Điểm senior cần nhớ

	- Lazy = Intermediate operations chỉ “ghi lại recipe” chứ không chạy ngay.
	- Short-circuit = terminal operation thông minh → có thể kết thúc sớm.
	- Pipeline fusion: Java tối ưu để kết hợp nhiều intermediate thành 1 loop duy nhất.

list.stream().filter(x -> x > 10).map(x -> x * 2).findFirst();


	## Enterprise angle:

		- Dùng short-circuit cho rule-check, monitoring, search-first-match.
		- Tránh .forEach() nếu chỉ cần anyMatch hoặc findFirst → vì .forEach() buộc duyệt hết (tốn tài nguyên).
		- Khi code review, thấy ai viết .filter(...).findFirst().isPresent() thì nhắc đổi sang .anyMatch(...) cho đúng semantic và tối ưu hơn.


# 👉 Tóm gọn kiểu senior:

	Lazy = stream không chạy cho tới khi bạn “ép” nó bằng terminal op.
	Short-circuit = khả năng “cắt pipeline giữa chừng” để tiết kiệm tài nguyên.
	Đây chính là lý do Stream API scale được cho data set lớn mà không lãng phí.


</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>🔙 Quay lại danh sách</a><br><button onclick='toggleTheme()'>🌙 Chuyển giao diện</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>