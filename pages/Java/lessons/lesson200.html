<html><head><title>Lesson 200 == Function Lifting & Error Handling ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>üîô Quay l·∫°i danh s√°ch</a><br><h1>Lesson 200 -- Function Lifting & Error Handling -//</h1><pre>
# üéØ M·ª•c ti√™u
	Trong l·∫≠p tr√¨nh h∆∞·ªõng h√†m (Functional Programming ‚Äì FP), ta kh√¥ng n√©m exception.
V√¨ exception l√† side effect ‚Äî n√≥ ph√° v·ª° purity (h√†m kh√¥ng c√≤n deterministic n·ªØa).

	‚Üí Thay v√†o ƒë√≥, ta ‚Äúb·ªçc‚Äù k·∫øt qu·∫£ c√≥ th·ªÉ l·ªói trong m·ªôt container an to√†n nh∆∞:


		Optional<T> ‚Üí khi k·∫øt qu·∫£ c√≥ th·ªÉ null
		
		Try<T> ‚Üí khi k·∫øt qu·∫£ c√≥ th·ªÉ throw exception
		
		Either<L, R> ‚Üí khi c√≥ k·∫øt qu·∫£ ho·∫∑c l·ªói t√πy √Ω ki·ªÉu
		
	V√† khi function nh·∫≠n/tr·∫£ container n√†y, ta g·ªçi l√† Function Lifting.



# üß† 1. Function Lifting l√† g√¨

	## Gi·∫£ s·ª≠ b·∫°n c√≥ h√†m thu·∫ßn:

String parseToUpper(String s) {
    return s.toUpperCase();
}

	N·∫øu s c√≥ th·ªÉ null, ta kh√¥ng mu·ªën throw NullPointerException.
	‚Üí Ta ‚Äúlift‚Äù n√≥ th√†nh m·ªôt function nh·∫≠n Optional v√† tr·∫£ Optional.

Function<Optional<String>, Optional<String>> lifted =
    opt -> opt.map(String::toUpperCase);



lifted.apply(Optional.of("bao")); // => Optional["BAO"]
lifted.apply(Optional.empty());   // => Optional.empty


	üìå Lifting = bi·∫øn function T‚ÜíR th√†nh Optional<T>‚ÜíOptional<R>.



# ‚öôÔ∏è 2. Handling Error an to√†n

	## Truy·ªÅn th·ªëng (imperative):

try {
    String s = riskyOperation();
    return s.toUpperCase();
} catch (Exception e) {
    return "ERROR";
}

	## Functional (v·ªõi Try monad ‚Äì Vavr):
		‚Üí Kh√¥ng c√≥ try/catch, kh√¥ng c√≥ state, m·ªçi th·ª© ch·ªâ l√† transform data through safe containers.



# üß© 3. D√πng Either cho validation

	Trong nghi·ªáp v·ª• enterprise, ta th∆∞·ªùng c·∫ßn ph√¢n bi·ªát gi·ªØa:


		Th√†nh c√¥ng (Right)
		L·ªói ho·∫∑c th√¥ng b√°o c·ª• th·ªÉ (Left)
		
Either<String, User> validate(User u) {
    return u.email().contains("@")
        ? Either.right(u)
        : Either.left("Invalid email");
}

	Gh√©p pipeline:	
		N·∫øu validate tr·∫£ l·ªói ‚Üí to√†n pipeline d·ª´ng, kh√¥ng c·∫ßn if/else.




# üßÆ 4. Enterprise Use Cases


| Use case                         | ·ª®ng d·ª•ng lifting/error handling                                    |
| -------------------------------- | ------------------------------------------------------------------ |
| **Validation Pipeline**          | M·ªói b∆∞·ªõc validate tr·∫£ `Either<Error, Data>`                        |
| **IO-safe transformation**       | ƒê·ªçc file, parse JSON, g·ªçi API ‚Äî t·∫•t c·∫£ d√πng `Try`                  |
| **Message Processing**           | B·ªçc t·ª´ng b∆∞·ªõc trong `Try`, log l·ªói nh∆∞ng kh√¥ng crash to√†n pipeline |
| **Stream pipeline v·ªõi Optional** | Tr√°nh null trong d·ªØ li·ªáu, ch·ªâ process c√°i n√†o c√≥ gi√° tr·ªã           |



# üîß 5. V√≠ d·ª• th·ª±c t·∫ø: Validation Pipeline


Function<User, Either<String, User>> validateEmail =
    u -> u.email().contains("@")
        ? Either.right(u)
        : Either.left("Invalid email");

Function<User, Either<String, User>> validateAge =
    u -> u.age() > 18
        ? Either.right(u)
        : Either.left("Underage");

Function<User, Either<String, UserDTO>> toDTO =
    u -> Either.right(new UserDTO(u.name(), u.email()));

Either<String, UserDTO> result =
    validateEmail.apply(user)
                 .flatMap(validateAge)
                 .flatMap(toDTO);

result.peek(dto -> System.out.println("OK: " + dto))
      .peekLeft(err -> System.err.println("Error: " + err));



	## üß© ƒêi·ªÉm hay:
		flatMap t·ª± skip b∆∞·ªõc sau n·∫øu g·∫∑p l·ªói.
		Kh√¥ng if, kh√¥ng try/catch, kh√¥ng null.



# üß† 6. Khi kh√¥ng c√≥ Vavr
	Ta c√≥ th·ªÉ t·ª± vi·∫øt Try ƒë∆°n gi·∫£n:

class Try<T> {
    private final T value;
    private final Exception exception;

    private Try(T value, Exception exception) {
        this.value = value;
        this.exception = exception;
    }

    static <T> Try<T> of(Callable<T> f) {
        try { return new Try<>(f.call(), null); }
        catch (Exception e) { return new Try<>(null, e); }
    }

    <R> Try<R> map(Function<T, R> f) {
        if (exception != null) return new Try<>(null, exception);
        try { return new Try<>(f.apply(value), null); }
        catch (Exception e) { return new Try<>(null, e); }
    }

    T getOrElse(T fallback) {
        return exception == null ? value : fallback;
    }
}


	## D√πng:

Try.of(() -> riskyOperation())
   .map(String::toUpperCase)
   .getOrElse("DEFAULT");


# üß≠ 7. T∆∞ duy then ch·ªët


	- Kh√¥ng n√©m exception, m√† chuy·ªÉn l·ªói th√†nh d·ªØ li·ªáu.
	- ‚Üí ‚ÄúErrors are just another kind of data.‚Äù
	- D√≤ng x·ª≠ l√Ω l√† pipeline, kh√¥ng b·ªã ng·∫Øt b·ªüi throw.
	- M·ªói function ƒë·ªÅu pure, d·ªÖ test v√† d·ªÖ compose.
	- Khi t·∫•t c·∫£ function ƒë√£ ‚Äúlifted‚Äù, b·∫°n c√≥ th·ªÉ gh√©p pipeline ph·ª©c t·∫°p m√† v·∫´n an to√†n tuy·ªát ƒë·ªëi.


# üîç 8. T·ªïng k·∫øt nhanh

| Kh√°i ni·ªám            | M√¥ t·∫£                                             |
| -------------------- | ------------------------------------------------- |
| **Lifting**          | Bi·∫øn `T‚ÜíR` th√†nh `Optional<T>‚ÜíOptional<R>`        |
| **Optional**         | Cho gi√° tr·ªã c√≥ th·ªÉ tr·ªëng                          |
| **Try**              | Cho k·∫øt qu·∫£ c√≥ th·ªÉ exception                      |
| **Either**           | Cho k·∫øt qu·∫£ c√≥ th·ªÉ ‚ÄúRight (ok)‚Äù ho·∫∑c ‚ÄúLeft (l·ªói)‚Äù |
| **·ª®ng d·ª•ng th·ª±c t·∫ø** | Validation, I/O, API, ETL, pipeline an to√†n       |













</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>üîô Quay l·∫°i danh s√°ch</a><br><button onclick='toggleTheme()'>üåô Chuy·ªÉn giao di·ªán</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>