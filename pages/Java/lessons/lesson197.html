<html><head><title>Lesson 197 == Pure Function, Immutability & Referential Transparency ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../java-learning-list.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 197 -- Pure Function, Immutability & Referential Transparency -//</h1><pre>
# Äá»‹nh nghÄ©a:

	## Má»™t pure function lÃ  hÃ m mÃ :

		KhÃ´ng cÃ³ side-effect (khÃ´ng thay Ä‘á»•i tráº¡ng thÃ¡i bÃªn ngoÃ i, khÃ´ng I/O, khÃ´ng log, khÃ´ng ghi DB).
		
		Káº¿t quáº£ chá»‰ phá»¥ thuá»™c vÃ o input.
		â†’ NghÄ©a lÃ : cÃ¹ng input â†’ luÃ´n output y nhÆ° nhau.


int add(int a, int b) {
    return a + b;
}

	Pure vÃ¬ khÃ´ng ghi log, khÃ´ng Ä‘á»•i biáº¿n toÃ n cá»¥c.
	
	
	## CÃ²n hÃ m nÃ y lÃ  impure:

int addAndLog(int a, int b) {
    System.out.println(a + b);
    return a + b;
}



# ğŸ’¡ á»¨ng dá»¥ng thá»±c táº¿:


Trong enterprise, pure function = predictability.(kháº£ nÄƒng dá»± Ä‘oáº¡n)
NÃ³ giÃºp báº¡n:

	- Dá»… cache (memoization).
	- Dá»… test (khÃ´ng cáº§n mock).
	- Dá»… song song hÃ³a (parallel) â€” vÃ¬ khÃ´ng sá»£ conflict state.
	- Dá»… compose â€” vÃ¬ chá»‰ quan tÃ¢m input/output, khÃ´ng context.

ğŸ§  Má»™t pipeline validation, transform, scoring trong finance/banking chá»‰ an toÃ n khi má»—i bÆ°á»›c lÃ  pure â€” vÃ¬ báº¡n cÃ³ thá»ƒ cháº¡y láº¡i hoáº·c song song mÃ  khÃ´ng phÃ¡ dá»¯ liá»‡u.



# ğŸ§Š 2. Immutability â€” â€œKhÃ´ng bao giá» thay Ä‘á»•i váº­t cháº¥t gá»‘câ€

	## Äá»‹nh nghÄ©a: 
		Dá»¯ liá»‡u sau khi táº¡o ra khÃ´ng bá»‹ thay Ä‘á»•i, mÃ  khi cáº§n cáº­p nháº­t, báº¡n táº¡o báº£n sao má»›i.


List<String> original = List.of("A", "B");
List<String> modified = Stream.concat(original.stream(), Stream.of("C"))
                              .collect(Collectors.toList());


		original khÃ´ng Ä‘á»•i. modified lÃ  list má»›i.


	## 	Trong OOP cÅ©:
		Báº¡n hay viáº¿t:
		
		employee.setSalary(2000);
		â†’ state bá»‹ thay Ä‘á»•i â†’ khÃ³ debug khi multi-thread.

	Functional design:
		Employee updated = employee.withSalary(2000);
		â†’ Táº¡o báº£n má»›i, dá»… reasoning, dá»… rollback, dá»… audit.





# ğŸ’¡ Enterprise á»©ng dá»¥ng:

	Trong há»‡ thá»‘ng tÃ i chÃ­nh, báº£o hiá»ƒm, banking:

		Transaction log, audit log â†’ chá»‰ append (khÃ´ng mutate).
		Versioning â†’ chá»‰ thÃªm báº£n má»›i (event sourcing).
		Dá»… kiá»ƒm soÃ¡t concurrency, trÃ¡nh dirty read.

Rule: Immutability + pure function = safe parallelism + deterministic behavior.



# ğŸ” 3. Referential Transparency â€” â€œThay hÃ m báº±ng giÃ¡ trá»‹ khÃ´ng Ä‘á»•i logicâ€

	## Äá»‹nh nghÄ©a:

		Má»™t biá»ƒu thá»©c cÃ³ referential transparency náº¿u ta cÃ³ thá»ƒ thay lá»i gá»i hÃ m báº±ng giÃ¡ trá»‹ tráº£ vá» mÃ  khÃ´ng Ä‘á»•i káº¿t quáº£ cá»§a chÆ°Æ¡ng trÃ¬nh.

		int x = add(2, 3) + add(2, 3);

			Náº¿u add(2,3) lÃ  pure â†’ ta cÃ³ thá»ƒ thay báº±ng 5 + 5.
			Náº¿u add(2,3) ghi log hoáº·c dÃ¹ng random â†’ káº¿t quáº£ khÃ¡c nhau, khÃ´ng thá»ƒ thay.


		
	## ğŸ’¡ Enterprise Ã½ nghÄ©a:
		Referential transparency cho phÃ©p:

			- Caching (memoization): vÃ¬ hÃ m nÃ o cÅ©ng deterministic.
			- Lazy evaluation: vÃ¬ káº¿t quáº£ khÃ´ng phá»¥ thuá»™c thá»i Ä‘iá»ƒm cháº¡y.
			- Optimization engine: nhÆ° Spark hoáº·c Stream fusion trong Java cÃ³ thá»ƒ reorder, merge step an toÃ n.



# âš™ï¸ 4. VÃ­ dá»¥ trong Java Stream


List<String> activeEmails =
    employees.stream()
             .filter(Employee::isActive)
             .map(Employee::getEmail)
             .collect(Collectors.toList());
			 
			 
		Má»—i bÆ°á»›c (filter, map) lÃ  pure function:

			KhÃ´ng ghi DB.
			KhÃ´ng log.
			KhÃ´ng Ä‘á»•i dá»¯ liá»‡u gá»‘c.
			â†’ employees ban Ä‘áº§u váº«n nguyÃªn.



# ğŸ’¼ Enterprise Example: Validation & Rule Engine

	## TÆ° duy cÅ© (OOP):

		EmployeeValidator validator = new EmployeeValidator();
		validator.validateAge(emp);
		validator.validateEmail(emp);
		validator.validateStatus(emp);

	## Functional style: 

Predicate<Employee> isValid =
    isValidAge.and(isValidEmail).and(isValidStatus);

boolean result = isValid.test(emp);


â†’ Táº¥t cáº£ cÃ¡c rule lÃ  pure predicate, cÃ³ thá»ƒ:

	Compose (and, or, negate),
	Cache,
	Cháº¡y song song,
	KhÃ´ng lÃ m thay Ä‘á»•i emp.
	



# ğŸ”© 5. Káº¿t ná»‘i triáº¿t lÃ½: Functional = Mathematical Thinking

| Thuá»™c tÃ­nh                   | Lá»£i Ã­ch ká»¹ thuáº­t      | TÃ¡c Ä‘á»™ng kiáº¿n trÃºc                    |
| ---------------------------- | --------------------- | ------------------------------------- |
| **Pure Function**            | Dá»… test, dá»… debug     | TÃ¡ch biá»‡t business logic khá»i háº¡ táº§ng |
| **Immutability**             | Thread-safe           | Dá»… scale, khÃ´ng lock                  |
| **Referential Transparency** | Caching, optimization | Há»— trá»£ reactive, lazy, parallel       |

</pre><a id='backBottom' href='../java-learning-list.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>