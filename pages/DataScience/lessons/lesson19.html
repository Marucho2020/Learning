<html><head><title>Lesson 19 == Linear Regression ==========//</title><style>body { font-family: Arial, sans-serif; transition: background 0.3s, color 0.3s; }.dark-mode { background-color: #121212; color: #e0e0e0; }.light-mode { background-color: #ffffff; color: #333333; }h1 { text-align: center; color: #73d9f5; }pre { padding: 15px; border-radius: 5px;       white-space: pre-wrap; word-wrap: break-word;       overflow-x: auto; max-width: 100%;       transition: background 0.3s, color 0.3s; }.dark-mode pre { background: #1e1e1e; color: #e0e0e0; }.light-mode pre { background: #f5f5f5; color: #333333; }#backTop, #backBottom {    font-size: 2em; padding: 20px 40px;    background: #bb86fc; color: white; text-decoration: none;    border-radius: 10px; display: inline-block; text-align: center; }#backTop:hover, #backBottom:hover { background: #9b67e2; }button { font-size: 1.5em; padding: 15px 30px;    background: #03dac6; color: #121212; border: none;    cursor: pointer; border-radius: 5px; display: block; margin: 10px auto; }button:hover { background: #02b8a3; }.dark-mode a { color: #03dac6; } .light-mode a { color: #007bff; }</style></head><body onload='applyTheme(); checkPageHeight()'><div class='container'><a id='backTop' href='../DataScience-learning.html'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><h1>Lesson 19 -- Linear Regression -//</h1><pre>
# 1. KhÃ¡i niá»‡m Há»“i quy Tuyáº¿n tÃ­nh

	Äá»‹nh nghÄ©a: Há»“i quy tuyáº¿n tÃ­nh tÃ¬m má»‘i quan há»‡ tuyáº¿n tÃ­nh giá»¯a má»™t hoáº·c nhiá»u biáº¿n Ä‘á»™c láº­p (explanatory variables) vÃ  má»™t biáº¿n phá»¥ thuá»™c (response variable). Má»¥c tiÃªu lÃ  xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh Ä‘á»ƒ dá»± Ä‘oÃ¡n giÃ¡ trá»‹ cá»§a biáº¿n phá»¥ thuá»™c dá»±a trÃªn cÃ¡c biáº¿n Ä‘á»™c láº­p.

		CÃ´ng thá»©c: y = slope.x + intercept  (cho há»“i quy tuyáº¿n tÃ­nh Ä‘Æ¡n giáº£n vá»›i má»™t biáº¿n Ä‘á»™c láº­p).

	Trong Ä‘Ã³:

			y : Biáº¿n phá»¥ thuá»™c (vÃ­ dá»¥: Calorie_Burnage).
			x : Biáº¿n Ä‘á»™c láº­p (vÃ­ dá»¥: Average_Pulse).
			Slope (Ä‘á»™ dá»‘c): Cho biáº¿t y thay Ä‘á»•i bao nhiÃªu khi x tÄƒng 1 Ä‘Æ¡n vá»‹.
			Intercept (há»‡ sá»‘ cháº·n): GiÃ¡ trá»‹ cá»§a y khi x = 0 .



	PhÆ°Æ¡ng phÃ¡p bÃ¬nh phÆ°Æ¡ng tá»‘i thiá»ƒu (Least Square Method):

		- Má»¥c tiÃªu: Váº½ má»™t Ä‘Æ°á»ng tháº³ng sao cho tá»•ng bÃ¬nh phÆ°Æ¡ng khoáº£ng cÃ¡ch (residuals) tá»« cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘áº¿n Ä‘Æ°á»ng tháº³ng lÃ  nhá» nháº¥t.
		- Residuals: Khoáº£ng cÃ¡ch dá»c tá»« má»—i Ä‘iá»ƒm dá»¯ liá»‡u Ä‘áº¿n Ä‘Æ°á»ng há»“i quy, cÃ²n gá»i lÃ  "lá»—i" (errors).


	Ã nghÄ©a: Há»“i quy tuyáº¿n tÃ­nh Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ:

		- Hiá»ƒu má»‘i quan há»‡ giá»¯a cÃ¡c biáº¿n (vÃ­ dá»¥: Average_Pulse vÃ  Calorie_Burnage cÃ³ liÃªn quan khÃ´ng?).
		- Dá»± Ä‘oÃ¡n giÃ¡ trá»‹ (vÃ­ dá»¥: dá»± Ä‘oÃ¡n Calorie_Burnage dá»±a trÃªn Average_Pulse vÃ  Duration).






# 2. Dá»¯ liá»‡u VÃ­ dá»¥

	BÃ i há»c sá»­ dá»¥ng táº­p dá»¯ liá»‡u full_health_data (tá»« file data.csv), nhÆ°ng khÃ´ng cung cáº¥p chi tiáº¿t. Tá»« cÃ¡c bÃ i trÆ°á»›c, chÃºng ta cÃ³ dá»¯ liá»‡u máº«u nhá» (10 quan sÃ¡t) Ä‘á»ƒ minh há»a:

Duration,Average_Pulse,Max_Pulse,Calorie_Burnage,Hours_Work,Hours_Sleep
30,80,120,240,10,7
30,85,120,250,10,7
45,90,130,260,8,7
45,95,130,270,8,7
45,100,140,280,0,7
60,105,140,290,7,8
60,110,145,300,7,8
60,115,145,310,8,8
75,120,150,320,0,8
75,125,150,330,8,8


	LÆ°u Ã½: Trong dá»¯ liá»‡u máº«u nÃ y, cÃ³ tÆ°Æ¡ng quan hoÃ n háº£o ($ r = 1 $) giá»¯a Average_Pulse vÃ  Calorie_Burnage, nhÆ°ng bÃ i há»c cho biáº¿t trong full_health_data, tÆ°Æ¡ng quan ráº¥t tháº¥p ($ r = 0.02 $). Äiá»u nÃ y cho tháº¥y full_health_data cÃ³ nhiá»u quan sÃ¡t hÆ¡n vÃ  phá»©c táº¡p hÆ¡n. TÃ´i sáº½ sá»­ dá»¥ng dá»¯ liá»‡u máº«u Ä‘á»ƒ minh há»a, nhÆ°ng cÅ©ng giáº£i thÃ­ch dá»±a trÃªn ngá»¯ cáº£nh full_health_data.




# 3. Há»“i quy Tuyáº¿n tÃ­nh vá»›i Má»™t Biáº¿n Äá»™c láº­p (Average_Pulse)

	PhÆ°Æ¡ng phÃ¡p BÃ¬nh phÆ°Æ¡ng Tá»‘i thiá»ƒu

		Má»¥c tiÃªu: TÃ¬m Ä‘Æ°á»ng tháº³ng y = slope.x + intercept sao cho tá»•ng bÃ¬nh phÆ°Æ¡ng residuals nhá» nháº¥t.

		Residual: $ \text{Residual}_i = y_i - (\text{slope} \cdot x_i + \text{intercept}) $.
		
		CÃ´ng thá»©c tÃ­nh slope vÃ  intercept:
		
		
			$$\text{slope} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sum (x_i - \bar{x})^2}$$
			$$\text{intercept} = \bar{y} - \text{slope} \cdot \bar{x}$$		
		
		
		TÃ­nh Thá»§ CÃ´ng (Dá»¯ liá»‡u Máº«u)	
			DÃ¹ng dá»¯ liá»‡u máº«u Ä‘á»ƒ tÃ­nh há»“i quy tuyáº¿n tÃ­nh giá»¯a Average_Pulse ($ x $) vÃ  Calorie_Burnage ($ y $).
		
		
		BÆ°á»›c 1: TÃ­nh trung bÃ¬nh:	
			Average_Pulse: = 102.5
			Calorie_Burnage: = 285 
		
		
		BÆ°á»›c 2: TÃ­nh slope:
			$\text{slope} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sum (x_i - \bar{x})^2}$
		
			slope = \frac{4115}{2062.5} = 2
		
			
		
		BÆ°á»›c 3: TÃ­nh intercept:
			intercept = 285 - 2 .  102.5 = 285 - 205 = 80
		
		
		MÃ´ hÃ¬nh:  y = 2x + 80 .	
		
		Há»‡ sá»‘ tÆ°Æ¡ng quan (r): Tá»« bÃ i trÆ°á»›c, $ r = 1 $, cho tháº¥y má»‘i quan há»‡ tuyáº¿n tÃ­nh hoÃ n háº£o trong dá»¯ liá»‡u máº«u.
		
		Dá»± Ä‘oÃ¡n: Vá»›i $ x = 100 $ (Average_Pulse), $ y = 2 \cdot 100 + 80 = 280 $ (Calorie_Burnage), khá»›p vá»›i dá»¯ liá»‡u.
		
		LÆ°u Ã½: Trong full_health_data, $ r = 0.02 $, cho tháº¥y mÃ´ hÃ¬nh há»“i quy vá»›i chá»‰ Average_Pulse sáº½ khÃ´ng chÃ­nh xÃ¡c, vÃ¬ má»‘i quan há»‡ tuyáº¿n tÃ­nh yáº¿u.
		


# 4. Minh Há»a Vá»›i Python (Sá»­ Dá»¥ng Scipy vÃ  Matplotlib)

	BÃ i há»c sá»­ dá»¥ng hÃ m stats.linregress tá»« Scipy Ä‘á»ƒ thá»±c hiá»‡n há»“i quy tuyáº¿n tÃ­nh vÃ  váº½ scatter plot vá»›i Ä‘Æ°á»ng há»“i quy.


import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats

# Dá»¯ liá»‡u máº«u
health_data = pd.DataFrame({
    'Average_Pulse': [80, 85, 90, 95, 100, 105, 110, 115, 120, 125],
    'Calorie_Burnage': [240, 250, 260, 270, 280, 290, 300, 310, 320, 330]
})

x = health_data["Average_Pulse"]
y = health_data["Calorie_Burnage"]

# Há»“i quy tuyáº¿n tÃ­nh
slope, intercept, r, p, std_err = stats.linregress(x, y)

# HÃ m dá»± Ä‘oÃ¡n
def myfunc(x):
    return slope * x + intercept

# Táº¡o giÃ¡ trá»‹ dá»± Ä‘oÃ¡n
mymodel = list(map(myfunc, x))

# Váº½ scatter plot vÃ  Ä‘Æ°á»ng há»“i quy
plt.scatter(x, y)
plt.plot(x, mymodel, color='red')
plt.ylim(ymin=0, ymax=400)
plt.xlim(xmin=0, xmax=150)
plt.xlabel("Average_Pulse")
plt.ylabel("Calorie_Burnage")
plt.title("Linear Regression: Average_Pulse vs. Calorie_Burnage")
plt.show()

print(f"Slope: {slope}, Intercept: {intercept}, R: {r}, P-value: {p}, Std_err: {std_err}")



	Káº¿t quáº£ (cho dá»¯ liá»‡u máº«u):

		Slope: 2.0
		Intercept: 80.0
		R: 1.0 (há»‡ sá»‘ tÆ°Æ¡ng quan, xÃ¡c nháº­n má»‘i quan há»‡ tuyáº¿n tÃ­nh hoÃ n háº£o)
		P-value: Ráº¥t nhá» (cho tháº¥y mÃ´ hÃ¬nh cÃ³ Ã½ nghÄ©a thá»‘ng kÃª)
		Std_err: Sai sá»‘ chuáº©n cá»§a slope, Ä‘o lÆ°á»ng Ä‘á»™ tin cáº­y.



# 6. PhÃ¢n tÃ­ch Káº¿t quáº£ vÃ  á»¨ng dá»¥ng Thá»±c táº¿

	Káº¿t quáº£ tá»« Dá»¯ liá»‡u Máº«u:

		MÃ´ hÃ¬nh: $ y = 2x + 80 $.
		$ r = 1 $: Má»‘i quan há»‡ tuyáº¿n tÃ­nh hoÃ n háº£o, dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c trong dá»¯ liá»‡u máº«u.
		Tuy nhiÃªn, dá»¯ liá»‡u máº«u nhá» vÃ  Ä‘Æ¡n giáº£n hÃ³a, khÃ´ng pháº£n Ã¡nh thá»±c táº¿ cá»§a full_health_data.

	Káº¿t quáº£ tá»« full_health_data (theo bÃ i há»c):
		$ r = 0.02 $: Má»‘i quan há»‡ tuyáº¿n tÃ­nh giá»¯a Average_Pulse vÃ  Calorie_Burnage ráº¥t yáº¿u.

		ÄÆ°á»ng há»“i quy khÃ´ng thá»ƒ dá»± Ä‘oÃ¡n Calorie_Burnage chÃ­nh xÃ¡c, vÃ¬ cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u ráº£i rÃ¡c (scatter plot trong bÃ i há»c cho tháº¥y Ä‘iá»u nÃ y).
		Káº¿t luáº­n: Average_Pulse khÃ´ng Ä‘á»§ Ä‘á»ƒ dá»± Ä‘oÃ¡n Calorie_Burnage. Cáº§n thÃªm biáº¿n khÃ¡c, nhÆ° Duration, Ä‘á»ƒ cáº£i thiá»‡n mÃ´ hÃ¬nh.



	Táº¡i sao cáº§n Duration?	

		- Tá»« bÃ i há»c vá» ma tráº­n tÆ°Æ¡ng quan, Duration cÃ³ tÆ°Æ¡ng quan cao vá»›i Calorie_Burnage ($ r = 0.89 $).
		- Trong thá»±c táº¿, thá»i gian táº­p luyá»‡n (Duration) áº£nh hÆ°á»Ÿng lá»›n Ä‘áº¿n calo Ä‘á»‘t chÃ¡y, vÃ  káº¿t há»£p vá»›i Average_Pulse cÃ³ thá»ƒ táº¡o ra mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n chÃ­nh xÃ¡c hÆ¡n (há»“i quy Ä‘a biáº¿n - multiple linear regression).

	á»¨ng dá»¥ng:

		- Dá»± Ä‘oÃ¡n: Há»“i quy tuyáº¿n tÃ­nh Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ dá»± Ä‘oÃ¡n (vÃ­ dá»¥: calo Ä‘á»‘t chÃ¡y dá»±a trÃªn nhá»‹p tim vÃ  thá»i gian táº­p).
		- Machine Learning: LÃ  mÃ´ hÃ¬nh cÆ¡ báº£n Ä‘á»ƒ hiá»ƒu cÃ¡c mÃ´ hÃ¬nh phá»©c táº¡p hÆ¡n (nhÆ° há»“i quy Ä‘a biáº¿n, há»“i quy phi tuyáº¿n).
		- Khoa há»c: Trong y há»c, há»“i quy tuyáº¿n tÃ­nh giÃºp dá»± Ä‘oÃ¡n chá»‰ sá»‘ sá»©c khá»e dá»±a trÃªn cÃ¡c yáº¿u tá»‘ nhÆ° nhá»‹p tim, thá»i gian táº­p.
		- TÃ i chÃ­nh: Dá»± Ä‘oÃ¡n giÃ¡ cá»• phiáº¿u hoáº·c doanh thu dá»±a trÃªn cÃ¡c yáº¿u tá»‘ kinh táº¿.


	LÆ°u Ã½ chuyÃªn gia:

		Háº¡n cháº¿ cá»§a há»“i quy Ä‘Æ¡n giáº£n: Chá»‰ dÃ¹ng má»™t biáº¿n (Average_Pulse) thÆ°á»ng khÃ´ng Ä‘á»§, Ä‘áº·c biá»‡t khi tÆ°Æ¡ng quan tháº¥p ($ r = 0.02 $).
		Há»“i quy Ä‘a biáº¿n: Káº¿t há»£p nhiá»u biáº¿n (Average_Pulse, Duration) sáº½ cáº£i thiá»‡n Ä‘á»™ chÃ­nh xÃ¡c. CÃ´ng thá»©c: $ y = b_0 + b_1x_1 + b_2x_2 $.



	Kiá»ƒm tra giáº£ Ä‘á»‹nh:

		Má»‘i quan há»‡ pháº£i tuyáº¿n tÃ­nh (kiá»ƒm tra báº±ng scatter plot).
		Residuals pháº£i phÃ¢n phá»‘i ngáº«u nhiÃªn (kiá»ƒm tra báº±ng plot residuals).
		KhÃ´ng cÃ³ Ä‘a cá»™ng tuyáº¿n (multicollinearity) khi dÃ¹ng nhiá»u biáº¿n.



</pre><a id='backBottom' href='../DataScience-learning.html' style='display:none;'>ğŸ”™ Quay láº¡i danh sÃ¡ch</a><br><button onclick='toggleTheme()'>ğŸŒ™ Chuyá»ƒn giao diá»‡n</button></div><script>function toggleTheme() {   let mode = document.body.classList.contains('dark-mode') ? 'light-mode' : 'dark-mode';   document.body.className = mode; localStorage.setItem('theme', mode);   syncTheme();}function applyTheme() {   let savedTheme = localStorage.getItem('theme') || 'dark-mode';   document.body.className = savedTheme;   syncTheme();}function syncTheme() {   let preElement = document.querySelector('pre');   if (document.body.classList.contains('dark-mode')) { preElement.style.background = '#1e1e1e'; preElement.style.color = '#e0e0e0'; }   else { preElement.style.background = '#f5f5f5'; preElement.style.color = '#333333'; }}function checkPageHeight() {   let contentHeight = document.body.scrollHeight;   let windowHeight = window.innerHeight;   if (contentHeight > windowHeight * 1.2) {       document.getElementById('backBottom').style.display = 'block';   } else {       document.getElementById('backBottom').style.display = 'none';   }}</script></body></html>